(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Vh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Yh={exports:{}},Kl={},Gh={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uo=Symbol.for("react.element"),t0=Symbol.for("react.portal"),n0=Symbol.for("react.fragment"),r0=Symbol.for("react.strict_mode"),i0=Symbol.for("react.profiler"),s0=Symbol.for("react.provider"),o0=Symbol.for("react.context"),l0=Symbol.for("react.forward_ref"),a0=Symbol.for("react.suspense"),c0=Symbol.for("react.memo"),u0=Symbol.for("react.lazy"),$d=Symbol.iterator;function d0(e){return e===null||typeof e!="object"?null:(e=$d&&e[$d]||e["@@iterator"],typeof e=="function"?e:null)}var Kh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xh=Object.assign,Qh={};function Ji(e,t,n){this.props=e,this.context=t,this.refs=Qh,this.updater=n||Kh}Ji.prototype.isReactComponent={};Ji.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ji.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Jh(){}Jh.prototype=Ji.prototype;function ku(e,t,n){this.props=e,this.context=t,this.refs=Qh,this.updater=n||Kh}var bu=ku.prototype=new Jh;bu.constructor=ku;Xh(bu,Ji.prototype);bu.isPureReactComponent=!0;var Ld=Array.isArray,Zh=Object.prototype.hasOwnProperty,Cu={current:null},qh={key:!0,ref:!0,__self:!0,__source:!0};function ep(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Zh.call(t,r)&&!qh.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:uo,type:e,key:s,ref:o,props:i,_owner:Cu.current}}function f0(e,t){return{$$typeof:uo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ju(e){return typeof e=="object"&&e!==null&&e.$$typeof===uo}function h0(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Od=/\/+/g;function va(e,t){return typeof e=="object"&&e!==null&&e.key!=null?h0(""+e.key):t.toString(36)}function Qo(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case uo:case t0:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+va(o,0):r,Ld(i)?(n="",e!=null&&(n=e.replace(Od,"$&/")+"/"),Qo(i,t,n,"",function(u){return u})):i!=null&&(ju(i)&&(i=f0(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Od,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",Ld(e))for(var a=0;a<e.length;a++){s=e[a];var c=r+va(s,a);o+=Qo(s,t,n,c,i)}else if(c=d0(e),typeof c=="function")for(e=c.call(e),a=0;!(s=e.next()).done;)s=s.value,c=r+va(s,a++),o+=Qo(s,t,n,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function vo(e,t,n){if(e==null)return e;var r=[],i=0;return Qo(e,r,"","",function(s){return t.call(n,s,i++)}),r}function p0(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Lt={current:null},Jo={transition:null},g0={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:Jo,ReactCurrentOwner:Cu};function tp(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:vo,forEach:function(e,t,n){vo(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return vo(e,function(){t++}),t},toArray:function(e){return vo(e,function(t){return t})||[]},only:function(e){if(!ju(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=Ji;qe.Fragment=n0;qe.Profiler=i0;qe.PureComponent=ku;qe.StrictMode=r0;qe.Suspense=a0;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g0;qe.act=tp;qe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Xh({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Cu.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)Zh.call(t,c)&&!qh.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:uo,type:e.type,key:i,ref:s,props:r,_owner:o}};qe.createContext=function(e){return e={$$typeof:o0,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:s0,_context:e},e.Consumer=e};qe.createElement=ep;qe.createFactory=function(e){var t=ep.bind(null,e);return t.type=e,t};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:l0,render:e}};qe.isValidElement=ju;qe.lazy=function(e){return{$$typeof:u0,_payload:{_status:-1,_result:e},_init:p0}};qe.memo=function(e,t){return{$$typeof:c0,type:e,compare:t===void 0?null:t}};qe.startTransition=function(e){var t=Jo.transition;Jo.transition={};try{e()}finally{Jo.transition=t}};qe.unstable_act=tp;qe.useCallback=function(e,t){return Lt.current.useCallback(e,t)};qe.useContext=function(e){return Lt.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return Lt.current.useDeferredValue(e)};qe.useEffect=function(e,t){return Lt.current.useEffect(e,t)};qe.useId=function(){return Lt.current.useId()};qe.useImperativeHandle=function(e,t,n){return Lt.current.useImperativeHandle(e,t,n)};qe.useInsertionEffect=function(e,t){return Lt.current.useInsertionEffect(e,t)};qe.useLayoutEffect=function(e,t){return Lt.current.useLayoutEffect(e,t)};qe.useMemo=function(e,t){return Lt.current.useMemo(e,t)};qe.useReducer=function(e,t,n){return Lt.current.useReducer(e,t,n)};qe.useRef=function(e){return Lt.current.useRef(e)};qe.useState=function(e){return Lt.current.useState(e)};qe.useSyncExternalStore=function(e,t,n){return Lt.current.useSyncExternalStore(e,t,n)};qe.useTransition=function(){return Lt.current.useTransition()};qe.version="18.3.1";Gh.exports=qe;var k=Gh.exports;const V=Vh(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m0=k,y0=Symbol.for("react.element"),x0=Symbol.for("react.fragment"),v0=Object.prototype.hasOwnProperty,w0=m0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,S0={key:!0,ref:!0,__self:!0,__source:!0};function np(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)v0.call(t,r)&&!S0.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:y0,type:e,key:s,ref:o,props:i,_owner:w0.current}}Kl.Fragment=x0;Kl.jsx=np;Kl.jsxs=np;Yh.exports=Kl;var l=Yh.exports,rp={exports:{}},tn={},ip={exports:{}},sp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(_,b){var M=_.length;_.push(b);e:for(;0<M;){var W=M-1>>>1,H=_[W];if(0<i(H,b))_[W]=b,_[M]=H,M=W;else break e}}function n(_){return _.length===0?null:_[0]}function r(_){if(_.length===0)return null;var b=_[0],M=_.pop();if(M!==b){_[0]=M;e:for(var W=0,H=_.length,re=H>>>1;W<re;){var oe=2*(W+1)-1,ge=_[oe],we=oe+1,z=_[we];if(0>i(ge,M))we<H&&0>i(z,ge)?(_[W]=z,_[we]=M,W=we):(_[W]=ge,_[oe]=M,W=oe);else if(we<H&&0>i(z,M))_[W]=z,_[we]=M,W=we;else break e}}return b}function i(_,b){var M=_.sortIndex-b.sortIndex;return M!==0?M:_.id-b.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var c=[],u=[],f=1,h=null,g=3,m=!1,S=!1,w=!1,N=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(_){for(var b=n(u);b!==null;){if(b.callback===null)r(u);else if(b.startTime<=_)r(u),b.sortIndex=b.expirationTime,t(c,b);else break;b=n(u)}}function y(_){if(w=!1,x(_),!S)if(n(c)!==null)S=!0,E(C);else{var b=n(u);b!==null&&L(y,b.startTime-_)}}function C(_,b){S=!1,w&&(w=!1,d(R),R=-1),m=!0;var M=g;try{for(x(b),h=n(c);h!==null&&(!(h.expirationTime>b)||_&&!G());){var W=h.callback;if(typeof W=="function"){h.callback=null,g=h.priorityLevel;var H=W(h.expirationTime<=b);b=e.unstable_now(),typeof H=="function"?h.callback=H:h===n(c)&&r(c),x(b)}else r(c);h=n(c)}if(h!==null)var re=!0;else{var oe=n(u);oe!==null&&L(y,oe.startTime-b),re=!1}return re}finally{h=null,g=M,m=!1}}var A=!1,D=null,R=-1,P=5,F=-1;function G(){return!(e.unstable_now()-F<P)}function J(){if(D!==null){var _=e.unstable_now();F=_;var b=!0;try{b=D(!0,_)}finally{b?B():(A=!1,D=null)}}else A=!1}var B;if(typeof p=="function")B=function(){p(J)};else if(typeof MessageChannel<"u"){var v=new MessageChannel,j=v.port2;v.port1.onmessage=J,B=function(){j.postMessage(null)}}else B=function(){N(J,0)};function E(_){D=_,A||(A=!0,B())}function L(_,b){R=N(function(){_(e.unstable_now())},b)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(_){_.callback=null},e.unstable_continueExecution=function(){S||m||(S=!0,E(C))},e.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<_?Math.floor(1e3/_):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(_){switch(g){case 1:case 2:case 3:var b=3;break;default:b=g}var M=g;g=b;try{return _()}finally{g=M}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(_,b){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var M=g;g=_;try{return b()}finally{g=M}},e.unstable_scheduleCallback=function(_,b,M){var W=e.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?W+M:W):M=W,_){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=M+H,_={id:f++,callback:b,priorityLevel:_,startTime:M,expirationTime:H,sortIndex:-1},M>W?(_.sortIndex=M,t(u,_),n(c)===null&&_===n(u)&&(w?(d(R),R=-1):w=!0,L(y,M-W))):(_.sortIndex=H,t(c,_),S||m||(S=!0,E(C))),_},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(_){var b=g;return function(){var M=g;g=b;try{return _.apply(this,arguments)}finally{g=M}}}})(sp);ip.exports=sp;var k0=ip.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b0=k,qt=k0;function ne(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var op=new Set,Os={};function ni(e,t){Bi(e,t),Bi(e+"Capture",t)}function Bi(e,t){for(Os[e]=t,e=0;e<t.length;e++)op.add(t[e])}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dc=Object.prototype.hasOwnProperty,C0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bd={},Fd={};function j0(e){return dc.call(Fd,e)?!0:dc.call(Bd,e)?!1:C0.test(e)?Fd[e]=!0:(Bd[e]=!0,!1)}function E0(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function _0(e,t,n,r){if(t===null||typeof t>"u"||E0(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ot(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Dt[e]=new Ot(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Dt[t]=new Ot(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Dt[e]=new Ot(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Dt[e]=new Ot(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Dt[e]=new Ot(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Dt[e]=new Ot(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Dt[e]=new Ot(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Dt[e]=new Ot(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Dt[e]=new Ot(e,5,!1,e.toLowerCase(),null,!1,!1)});var Eu=/[\-:]([a-z])/g;function _u(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Eu,_u);Dt[t]=new Ot(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Eu,_u);Dt[t]=new Ot(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Eu,_u);Dt[t]=new Ot(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Dt[e]=new Ot(e,1,!1,e.toLowerCase(),null,!1,!1)});Dt.xlinkHref=new Ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Dt[e]=new Ot(e,1,!1,e.toLowerCase(),null,!0,!0)});function Nu(e,t,n,r){var i=Dt.hasOwnProperty(t)?Dt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(_0(t,n,i,r)&&(n=null),r||i===null?j0(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ir=b0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wo=Symbol.for("react.element"),mi=Symbol.for("react.portal"),yi=Symbol.for("react.fragment"),Au=Symbol.for("react.strict_mode"),fc=Symbol.for("react.profiler"),lp=Symbol.for("react.provider"),ap=Symbol.for("react.context"),Du=Symbol.for("react.forward_ref"),hc=Symbol.for("react.suspense"),pc=Symbol.for("react.suspense_list"),Mu=Symbol.for("react.memo"),ar=Symbol.for("react.lazy"),cp=Symbol.for("react.offscreen"),Hd=Symbol.iterator;function rs(e){return e===null||typeof e!="object"?null:(e=Hd&&e[Hd]||e["@@iterator"],typeof e=="function"?e:null)}var ht=Object.assign,wa;function xs(e){if(wa===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);wa=t&&t[1]||""}return`
`+wa+e}var Sa=!1;function ka(e,t){if(!e||Sa)return"";Sa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=a);break}}}finally{Sa=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?xs(e):""}function N0(e){switch(e.tag){case 5:return xs(e.type);case 16:return xs("Lazy");case 13:return xs("Suspense");case 19:return xs("SuspenseList");case 0:case 2:case 15:return e=ka(e.type,!1),e;case 11:return e=ka(e.type.render,!1),e;case 1:return e=ka(e.type,!0),e;default:return""}}function gc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yi:return"Fragment";case mi:return"Portal";case fc:return"Profiler";case Au:return"StrictMode";case hc:return"Suspense";case pc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ap:return(e.displayName||"Context")+".Consumer";case lp:return(e._context.displayName||"Context")+".Provider";case Du:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Mu:return t=e.displayName||null,t!==null?t:gc(e.type)||"Memo";case ar:t=e._payload,e=e._init;try{return gc(e(t))}catch{}}return null}function A0(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gc(t);case 8:return t===Au?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function _r(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function up(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function D0(e){var t=up(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function So(e){e._valueTracker||(e._valueTracker=D0(e))}function dp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=up(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function fl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function mc(e,t){var n=t.checked;return ht({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Wd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=_r(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function fp(e,t){t=t.checked,t!=null&&Nu(e,"checked",t,!1)}function yc(e,t){fp(e,t);var n=_r(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?xc(e,t.type,n):t.hasOwnProperty("defaultValue")&&xc(e,t.type,_r(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ud(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function xc(e,t,n){(t!=="number"||fl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var vs=Array.isArray;function Di(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+_r(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function vc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ne(91));return ht({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Vd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ne(92));if(vs(n)){if(1<n.length)throw Error(ne(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:_r(n)}}function hp(e,t){var n=_r(t.value),r=_r(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Yd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function pp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?pp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ko,gp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ko=ko||document.createElement("div"),ko.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ko.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Bs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var _s={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},M0=["Webkit","ms","Moz","O"];Object.keys(_s).forEach(function(e){M0.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_s[t]=_s[e]})});function mp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||_s.hasOwnProperty(e)&&_s[e]?(""+t).trim():t+"px"}function yp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=mp(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var z0=ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sc(e,t){if(t){if(z0[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ne(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ne(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ne(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ne(62))}}function kc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bc=null;function zu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Cc=null,Mi=null,zi=null;function Gd(e){if(e=po(e)){if(typeof Cc!="function")throw Error(ne(280));var t=e.stateNode;t&&(t=ql(t),Cc(e.stateNode,e.type,t))}}function xp(e){Mi?zi?zi.push(e):zi=[e]:Mi=e}function vp(){if(Mi){var e=Mi,t=zi;if(zi=Mi=null,Gd(e),t)for(e=0;e<t.length;e++)Gd(t[e])}}function wp(e,t){return e(t)}function Sp(){}var ba=!1;function kp(e,t,n){if(ba)return e(t,n);ba=!0;try{return wp(e,t,n)}finally{ba=!1,(Mi!==null||zi!==null)&&(Sp(),vp())}}function Fs(e,t){var n=e.stateNode;if(n===null)return null;var r=ql(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ne(231,t,typeof n));return n}var jc=!1;if(Zn)try{var is={};Object.defineProperty(is,"passive",{get:function(){jc=!0}}),window.addEventListener("test",is,is),window.removeEventListener("test",is,is)}catch{jc=!1}function R0(e,t,n,r,i,s,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(f){this.onError(f)}}var Ns=!1,hl=null,pl=!1,Ec=null,P0={onError:function(e){Ns=!0,hl=e}};function T0(e,t,n,r,i,s,o,a,c){Ns=!1,hl=null,R0.apply(P0,arguments)}function I0(e,t,n,r,i,s,o,a,c){if(T0.apply(this,arguments),Ns){if(Ns){var u=hl;Ns=!1,hl=null}else throw Error(ne(198));pl||(pl=!0,Ec=u)}}function ri(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function bp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Kd(e){if(ri(e)!==e)throw Error(ne(188))}function $0(e){var t=e.alternate;if(!t){if(t=ri(e),t===null)throw Error(ne(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Kd(i),e;if(s===r)return Kd(i),t;s=s.sibling}throw Error(ne(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?e:t}function Cp(e){return e=$0(e),e!==null?jp(e):null}function jp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=jp(e);if(t!==null)return t;e=e.sibling}return null}var Ep=qt.unstable_scheduleCallback,Xd=qt.unstable_cancelCallback,L0=qt.unstable_shouldYield,O0=qt.unstable_requestPaint,mt=qt.unstable_now,B0=qt.unstable_getCurrentPriorityLevel,Ru=qt.unstable_ImmediatePriority,_p=qt.unstable_UserBlockingPriority,gl=qt.unstable_NormalPriority,F0=qt.unstable_LowPriority,Np=qt.unstable_IdlePriority,Xl=null,On=null;function H0(e){if(On&&typeof On.onCommitFiberRoot=="function")try{On.onCommitFiberRoot(Xl,e,void 0,(e.current.flags&128)===128)}catch{}}var kn=Math.clz32?Math.clz32:V0,W0=Math.log,U0=Math.LN2;function V0(e){return e>>>=0,e===0?32:31-(W0(e)/U0|0)|0}var bo=64,Co=4194304;function ws(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ml(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=ws(a):(s&=o,s!==0&&(r=ws(s)))}else o=n&~i,o!==0?r=ws(o):s!==0&&(r=ws(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-kn(t),i=1<<n,r|=e[n],t&=~i;return r}function Y0(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G0(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-kn(s),a=1<<o,c=i[o];c===-1?(!(a&n)||a&r)&&(i[o]=Y0(a,t)):c<=t&&(e.expiredLanes|=a),s&=~a}}function _c(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ap(){var e=bo;return bo<<=1,!(bo&4194240)&&(bo=64),e}function Ca(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function fo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-kn(t),e[t]=n}function K0(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-kn(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function Pu(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-kn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var it=0;function Dp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Mp,Tu,zp,Rp,Pp,Nc=!1,jo=[],xr=null,vr=null,wr=null,Hs=new Map,Ws=new Map,hr=[],X0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qd(e,t){switch(e){case"focusin":case"focusout":xr=null;break;case"dragenter":case"dragleave":vr=null;break;case"mouseover":case"mouseout":wr=null;break;case"pointerover":case"pointerout":Hs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ws.delete(t.pointerId)}}function ss(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=po(t),t!==null&&Tu(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Q0(e,t,n,r,i){switch(t){case"focusin":return xr=ss(xr,e,t,n,r,i),!0;case"dragenter":return vr=ss(vr,e,t,n,r,i),!0;case"mouseover":return wr=ss(wr,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Hs.set(s,ss(Hs.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ws.set(s,ss(Ws.get(s)||null,e,t,n,r,i)),!0}return!1}function Tp(e){var t=Lr(e.target);if(t!==null){var n=ri(t);if(n!==null){if(t=n.tag,t===13){if(t=bp(n),t!==null){e.blockedOn=t,Pp(e.priority,function(){zp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Zo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ac(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);bc=r,n.target.dispatchEvent(r),bc=null}else return t=po(n),t!==null&&Tu(t),e.blockedOn=n,!1;t.shift()}return!0}function Jd(e,t,n){Zo(e)&&n.delete(t)}function J0(){Nc=!1,xr!==null&&Zo(xr)&&(xr=null),vr!==null&&Zo(vr)&&(vr=null),wr!==null&&Zo(wr)&&(wr=null),Hs.forEach(Jd),Ws.forEach(Jd)}function os(e,t){e.blockedOn===t&&(e.blockedOn=null,Nc||(Nc=!0,qt.unstable_scheduleCallback(qt.unstable_NormalPriority,J0)))}function Us(e){function t(i){return os(i,e)}if(0<jo.length){os(jo[0],e);for(var n=1;n<jo.length;n++){var r=jo[n];r.blockedOn===e&&(r.blockedOn=null)}}for(xr!==null&&os(xr,e),vr!==null&&os(vr,e),wr!==null&&os(wr,e),Hs.forEach(t),Ws.forEach(t),n=0;n<hr.length;n++)r=hr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<hr.length&&(n=hr[0],n.blockedOn===null);)Tp(n),n.blockedOn===null&&hr.shift()}var Ri=ir.ReactCurrentBatchConfig,yl=!0;function Z0(e,t,n,r){var i=it,s=Ri.transition;Ri.transition=null;try{it=1,Iu(e,t,n,r)}finally{it=i,Ri.transition=s}}function q0(e,t,n,r){var i=it,s=Ri.transition;Ri.transition=null;try{it=4,Iu(e,t,n,r)}finally{it=i,Ri.transition=s}}function Iu(e,t,n,r){if(yl){var i=Ac(e,t,n,r);if(i===null)Pa(e,t,r,xl,n),Qd(e,r);else if(Q0(i,e,t,n,r))r.stopPropagation();else if(Qd(e,r),t&4&&-1<X0.indexOf(e)){for(;i!==null;){var s=po(i);if(s!==null&&Mp(s),s=Ac(e,t,n,r),s===null&&Pa(e,t,r,xl,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Pa(e,t,r,null,n)}}var xl=null;function Ac(e,t,n,r){if(xl=null,e=zu(r),e=Lr(e),e!==null)if(t=ri(e),t===null)e=null;else if(n=t.tag,n===13){if(e=bp(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xl=e,null}function Ip(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(B0()){case Ru:return 1;case _p:return 4;case gl:case F0:return 16;case Np:return 536870912;default:return 16}default:return 16}}var mr=null,$u=null,qo=null;function $p(){if(qo)return qo;var e,t=$u,n=t.length,r,i="value"in mr?mr.value:mr.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return qo=i.slice(e,1<r?1-r:void 0)}function el(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Eo(){return!0}function Zd(){return!1}function nn(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Eo:Zd,this.isPropagationStopped=Zd,this}return ht(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Eo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Eo)},persist:function(){},isPersistent:Eo}),t}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lu=nn(Zi),ho=ht({},Zi,{view:0,detail:0}),ex=nn(ho),ja,Ea,ls,Ql=ht({},ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ou,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ls&&(ls&&e.type==="mousemove"?(ja=e.screenX-ls.screenX,Ea=e.screenY-ls.screenY):Ea=ja=0,ls=e),ja)},movementY:function(e){return"movementY"in e?e.movementY:Ea}}),qd=nn(Ql),tx=ht({},Ql,{dataTransfer:0}),nx=nn(tx),rx=ht({},ho,{relatedTarget:0}),_a=nn(rx),ix=ht({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),sx=nn(ix),ox=ht({},Zi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),lx=nn(ox),ax=ht({},Zi,{data:0}),ef=nn(ax),cx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ux={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=dx[e])?!!t[e]:!1}function Ou(){return fx}var hx=ht({},ho,{key:function(e){if(e.key){var t=cx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=el(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ux[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ou,charCode:function(e){return e.type==="keypress"?el(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?el(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),px=nn(hx),gx=ht({},Ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tf=nn(gx),mx=ht({},ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ou}),yx=nn(mx),xx=ht({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),vx=nn(xx),wx=ht({},Ql,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Sx=nn(wx),kx=[9,13,27,32],Bu=Zn&&"CompositionEvent"in window,As=null;Zn&&"documentMode"in document&&(As=document.documentMode);var bx=Zn&&"TextEvent"in window&&!As,Lp=Zn&&(!Bu||As&&8<As&&11>=As),nf=" ",rf=!1;function Op(e,t){switch(e){case"keyup":return kx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xi=!1;function Cx(e,t){switch(e){case"compositionend":return Bp(t);case"keypress":return t.which!==32?null:(rf=!0,nf);case"textInput":return e=t.data,e===nf&&rf?null:e;default:return null}}function jx(e,t){if(xi)return e==="compositionend"||!Bu&&Op(e,t)?(e=$p(),qo=$u=mr=null,xi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Lp&&t.locale!=="ko"?null:t.data;default:return null}}var Ex={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ex[e.type]:t==="textarea"}function Fp(e,t,n,r){xp(r),t=vl(t,"onChange"),0<t.length&&(n=new Lu("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ds=null,Vs=null;function _x(e){Zp(e,0)}function Jl(e){var t=Si(e);if(dp(t))return e}function Nx(e,t){if(e==="change")return t}var Hp=!1;if(Zn){var Na;if(Zn){var Aa="oninput"in document;if(!Aa){var of=document.createElement("div");of.setAttribute("oninput","return;"),Aa=typeof of.oninput=="function"}Na=Aa}else Na=!1;Hp=Na&&(!document.documentMode||9<document.documentMode)}function lf(){Ds&&(Ds.detachEvent("onpropertychange",Wp),Vs=Ds=null)}function Wp(e){if(e.propertyName==="value"&&Jl(Vs)){var t=[];Fp(t,Vs,e,zu(e)),kp(_x,t)}}function Ax(e,t,n){e==="focusin"?(lf(),Ds=t,Vs=n,Ds.attachEvent("onpropertychange",Wp)):e==="focusout"&&lf()}function Dx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Jl(Vs)}function Mx(e,t){if(e==="click")return Jl(t)}function zx(e,t){if(e==="input"||e==="change")return Jl(t)}function Rx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var jn=typeof Object.is=="function"?Object.is:Rx;function Ys(e,t){if(jn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!dc.call(t,i)||!jn(e[i],t[i]))return!1}return!0}function af(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cf(e,t){var n=af(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=af(n)}}function Up(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Up(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Vp(){for(var e=window,t=fl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=fl(e.document)}return t}function Fu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Px(e){var t=Vp(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Up(n.ownerDocument.documentElement,n)){if(r!==null&&Fu(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=cf(n,s);var o=cf(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Tx=Zn&&"documentMode"in document&&11>=document.documentMode,vi=null,Dc=null,Ms=null,Mc=!1;function uf(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Mc||vi==null||vi!==fl(r)||(r=vi,"selectionStart"in r&&Fu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ms&&Ys(Ms,r)||(Ms=r,r=vl(Dc,"onSelect"),0<r.length&&(t=new Lu("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vi)))}function _o(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:_o("Animation","AnimationEnd"),animationiteration:_o("Animation","AnimationIteration"),animationstart:_o("Animation","AnimationStart"),transitionend:_o("Transition","TransitionEnd")},Da={},Yp={};Zn&&(Yp=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);function Zl(e){if(Da[e])return Da[e];if(!wi[e])return e;var t=wi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Yp)return Da[e]=t[n];return e}var Gp=Zl("animationend"),Kp=Zl("animationiteration"),Xp=Zl("animationstart"),Qp=Zl("transitionend"),Jp=new Map,df="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){Jp.set(e,t),ni(t,[e])}for(var Ma=0;Ma<df.length;Ma++){var za=df[Ma],Ix=za.toLowerCase(),$x=za[0].toUpperCase()+za.slice(1);Ar(Ix,"on"+$x)}Ar(Gp,"onAnimationEnd");Ar(Kp,"onAnimationIteration");Ar(Xp,"onAnimationStart");Ar("dblclick","onDoubleClick");Ar("focusin","onFocus");Ar("focusout","onBlur");Ar(Qp,"onTransitionEnd");Bi("onMouseEnter",["mouseout","mouseover"]);Bi("onMouseLeave",["mouseout","mouseover"]);Bi("onPointerEnter",["pointerout","pointerover"]);Bi("onPointerLeave",["pointerout","pointerover"]);ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ni("onBeforeInput",["compositionend","keypress","textInput","paste"]);ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ss="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ss));function ff(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,I0(r,t,void 0,e),e.currentTarget=null}function Zp(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;ff(i,a,u),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;ff(i,a,u),s=c}}}if(pl)throw e=Ec,pl=!1,Ec=null,e}function at(e,t){var n=t[Ic];n===void 0&&(n=t[Ic]=new Set);var r=e+"__bubble";n.has(r)||(qp(t,e,2,!1),n.add(r))}function Ra(e,t,n){var r=0;t&&(r|=4),qp(n,e,r,t)}var No="_reactListening"+Math.random().toString(36).slice(2);function Gs(e){if(!e[No]){e[No]=!0,op.forEach(function(n){n!=="selectionchange"&&(Lx.has(n)||Ra(n,!1,e),Ra(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[No]||(t[No]=!0,Ra("selectionchange",!1,t))}}function qp(e,t,n,r){switch(Ip(t)){case 1:var i=Z0;break;case 4:i=q0;break;default:i=Iu}n=i.bind(null,t,n,e),i=void 0,!jc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Pa(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Lr(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}kp(function(){var u=s,f=zu(n),h=[];e:{var g=Jp.get(e);if(g!==void 0){var m=Lu,S=e;switch(e){case"keypress":if(el(n)===0)break e;case"keydown":case"keyup":m=px;break;case"focusin":S="focus",m=_a;break;case"focusout":S="blur",m=_a;break;case"beforeblur":case"afterblur":m=_a;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=qd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=nx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=yx;break;case Gp:case Kp:case Xp:m=sx;break;case Qp:m=vx;break;case"scroll":m=ex;break;case"wheel":m=Sx;break;case"copy":case"cut":case"paste":m=lx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=tf}var w=(t&4)!==0,N=!w&&e==="scroll",d=w?g!==null?g+"Capture":null:g;w=[];for(var p=u,x;p!==null;){x=p;var y=x.stateNode;if(x.tag===5&&y!==null&&(x=y,d!==null&&(y=Fs(p,d),y!=null&&w.push(Ks(p,y,x)))),N)break;p=p.return}0<w.length&&(g=new m(g,S,null,n,f),h.push({event:g,listeners:w}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",g&&n!==bc&&(S=n.relatedTarget||n.fromElement)&&(Lr(S)||S[qn]))break e;if((m||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,m?(S=n.relatedTarget||n.toElement,m=u,S=S?Lr(S):null,S!==null&&(N=ri(S),S!==N||S.tag!==5&&S.tag!==6)&&(S=null)):(m=null,S=u),m!==S)){if(w=qd,y="onMouseLeave",d="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(w=tf,y="onPointerLeave",d="onPointerEnter",p="pointer"),N=m==null?g:Si(m),x=S==null?g:Si(S),g=new w(y,p+"leave",m,n,f),g.target=N,g.relatedTarget=x,y=null,Lr(f)===u&&(w=new w(d,p+"enter",S,n,f),w.target=x,w.relatedTarget=N,y=w),N=y,m&&S)t:{for(w=m,d=S,p=0,x=w;x;x=si(x))p++;for(x=0,y=d;y;y=si(y))x++;for(;0<p-x;)w=si(w),p--;for(;0<x-p;)d=si(d),x--;for(;p--;){if(w===d||d!==null&&w===d.alternate)break t;w=si(w),d=si(d)}w=null}else w=null;m!==null&&hf(h,g,m,w,!1),S!==null&&N!==null&&hf(h,N,S,w,!0)}}e:{if(g=u?Si(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var C=Nx;else if(sf(g))if(Hp)C=zx;else{C=Dx;var A=Ax}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(C=Mx);if(C&&(C=C(e,u))){Fp(h,C,n,f);break e}A&&A(e,g,u),e==="focusout"&&(A=g._wrapperState)&&A.controlled&&g.type==="number"&&xc(g,"number",g.value)}switch(A=u?Si(u):window,e){case"focusin":(sf(A)||A.contentEditable==="true")&&(vi=A,Dc=u,Ms=null);break;case"focusout":Ms=Dc=vi=null;break;case"mousedown":Mc=!0;break;case"contextmenu":case"mouseup":case"dragend":Mc=!1,uf(h,n,f);break;case"selectionchange":if(Tx)break;case"keydown":case"keyup":uf(h,n,f)}var D;if(Bu)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else xi?Op(e,n)&&(R="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(Lp&&n.locale!=="ko"&&(xi||R!=="onCompositionStart"?R==="onCompositionEnd"&&xi&&(D=$p()):(mr=f,$u="value"in mr?mr.value:mr.textContent,xi=!0)),A=vl(u,R),0<A.length&&(R=new ef(R,e,null,n,f),h.push({event:R,listeners:A}),D?R.data=D:(D=Bp(n),D!==null&&(R.data=D)))),(D=bx?Cx(e,n):jx(e,n))&&(u=vl(u,"onBeforeInput"),0<u.length&&(f=new ef("onBeforeInput","beforeinput",null,n,f),h.push({event:f,listeners:u}),f.data=D))}Zp(h,t)})}function Ks(e,t,n){return{instance:e,listener:t,currentTarget:n}}function vl(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Fs(e,n),s!=null&&r.unshift(Ks(e,s,i)),s=Fs(e,t),s!=null&&r.push(Ks(e,s,i))),e=e.return}return r}function si(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function hf(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,u=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&u!==null&&(a=u,i?(c=Fs(n,s),c!=null&&o.unshift(Ks(n,c,a))):i||(c=Fs(n,s),c!=null&&o.push(Ks(n,c,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Ox=/\r\n?/g,Bx=/\u0000|\uFFFD/g;function pf(e){return(typeof e=="string"?e:""+e).replace(Ox,`
`).replace(Bx,"")}function Ao(e,t,n){if(t=pf(t),pf(e)!==t&&n)throw Error(ne(425))}function wl(){}var zc=null,Rc=null;function Pc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Tc=typeof setTimeout=="function"?setTimeout:void 0,Fx=typeof clearTimeout=="function"?clearTimeout:void 0,gf=typeof Promise=="function"?Promise:void 0,Hx=typeof queueMicrotask=="function"?queueMicrotask:typeof gf<"u"?function(e){return gf.resolve(null).then(e).catch(Wx)}:Tc;function Wx(e){setTimeout(function(){throw e})}function Ta(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Us(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Us(t)}function Sr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function mf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var qi=Math.random().toString(36).slice(2),In="__reactFiber$"+qi,Xs="__reactProps$"+qi,qn="__reactContainer$"+qi,Ic="__reactEvents$"+qi,Ux="__reactListeners$"+qi,Vx="__reactHandles$"+qi;function Lr(e){var t=e[In];if(t)return t;for(var n=e.parentNode;n;){if(t=n[qn]||n[In]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=mf(e);e!==null;){if(n=e[In])return n;e=mf(e)}return t}e=n,n=e.parentNode}return null}function po(e){return e=e[In]||e[qn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Si(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ne(33))}function ql(e){return e[Xs]||null}var $c=[],ki=-1;function Dr(e){return{current:e}}function ct(e){0>ki||(e.current=$c[ki],$c[ki]=null,ki--)}function ot(e,t){ki++,$c[ki]=e.current,e.current=t}var Nr={},Tt=Dr(Nr),Vt=Dr(!1),Xr=Nr;function Fi(e,t){var n=e.type.contextTypes;if(!n)return Nr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Yt(e){return e=e.childContextTypes,e!=null}function Sl(){ct(Vt),ct(Tt)}function yf(e,t,n){if(Tt.current!==Nr)throw Error(ne(168));ot(Tt,t),ot(Vt,n)}function eg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ne(108,A0(e)||"Unknown",i));return ht({},n,r)}function kl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nr,Xr=Tt.current,ot(Tt,e),ot(Vt,Vt.current),!0}function xf(e,t,n){var r=e.stateNode;if(!r)throw Error(ne(169));n?(e=eg(e,t,Xr),r.__reactInternalMemoizedMergedChildContext=e,ct(Vt),ct(Tt),ot(Tt,e)):ct(Vt),ot(Vt,n)}var Vn=null,ea=!1,Ia=!1;function tg(e){Vn===null?Vn=[e]:Vn.push(e)}function Yx(e){ea=!0,tg(e)}function Mr(){if(!Ia&&Vn!==null){Ia=!0;var e=0,t=it;try{var n=Vn;for(it=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Vn=null,ea=!1}catch(i){throw Vn!==null&&(Vn=Vn.slice(e+1)),Ep(Ru,Mr),i}finally{it=t,Ia=!1}}return null}var bi=[],Ci=0,bl=null,Cl=0,sn=[],on=0,Qr=null,Gn=1,Kn="";function Rr(e,t){bi[Ci++]=Cl,bi[Ci++]=bl,bl=e,Cl=t}function ng(e,t,n){sn[on++]=Gn,sn[on++]=Kn,sn[on++]=Qr,Qr=e;var r=Gn;e=Kn;var i=32-kn(r)-1;r&=~(1<<i),n+=1;var s=32-kn(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Gn=1<<32-kn(t)+i|n<<i|r,Kn=s+e}else Gn=1<<s|n<<i|r,Kn=e}function Hu(e){e.return!==null&&(Rr(e,1),ng(e,1,0))}function Wu(e){for(;e===bl;)bl=bi[--Ci],bi[Ci]=null,Cl=bi[--Ci],bi[Ci]=null;for(;e===Qr;)Qr=sn[--on],sn[on]=null,Kn=sn[--on],sn[on]=null,Gn=sn[--on],sn[on]=null}var Zt=null,Jt=null,ut=!1,wn=null;function rg(e,t){var n=an(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function vf(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Zt=e,Jt=Sr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Zt=e,Jt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Qr!==null?{id:Gn,overflow:Kn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=an(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Zt=e,Jt=null,!0):!1;default:return!1}}function Lc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Oc(e){if(ut){var t=Jt;if(t){var n=t;if(!vf(e,t)){if(Lc(e))throw Error(ne(418));t=Sr(n.nextSibling);var r=Zt;t&&vf(e,t)?rg(r,n):(e.flags=e.flags&-4097|2,ut=!1,Zt=e)}}else{if(Lc(e))throw Error(ne(418));e.flags=e.flags&-4097|2,ut=!1,Zt=e}}}function wf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Zt=e}function Do(e){if(e!==Zt)return!1;if(!ut)return wf(e),ut=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Pc(e.type,e.memoizedProps)),t&&(t=Jt)){if(Lc(e))throw ig(),Error(ne(418));for(;t;)rg(e,t),t=Sr(t.nextSibling)}if(wf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Jt=Sr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Jt=null}}else Jt=Zt?Sr(e.stateNode.nextSibling):null;return!0}function ig(){for(var e=Jt;e;)e=Sr(e.nextSibling)}function Hi(){Jt=Zt=null,ut=!1}function Uu(e){wn===null?wn=[e]:wn.push(e)}var Gx=ir.ReactCurrentBatchConfig;function as(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,e))}return e}function Mo(e,t){throw e=Object.prototype.toString.call(t),Error(ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sf(e){var t=e._init;return t(e._payload)}function sg(e){function t(d,p){if(e){var x=d.deletions;x===null?(d.deletions=[p],d.flags|=16):x.push(p)}}function n(d,p){if(!e)return null;for(;p!==null;)t(d,p),p=p.sibling;return null}function r(d,p){for(d=new Map;p!==null;)p.key!==null?d.set(p.key,p):d.set(p.index,p),p=p.sibling;return d}function i(d,p){return d=jr(d,p),d.index=0,d.sibling=null,d}function s(d,p,x){return d.index=x,e?(x=d.alternate,x!==null?(x=x.index,x<p?(d.flags|=2,p):x):(d.flags|=2,p)):(d.flags|=1048576,p)}function o(d){return e&&d.alternate===null&&(d.flags|=2),d}function a(d,p,x,y){return p===null||p.tag!==6?(p=Wa(x,d.mode,y),p.return=d,p):(p=i(p,x),p.return=d,p)}function c(d,p,x,y){var C=x.type;return C===yi?f(d,p,x.props.children,y,x.key):p!==null&&(p.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ar&&Sf(C)===p.type)?(y=i(p,x.props),y.ref=as(d,p,x),y.return=d,y):(y=ll(x.type,x.key,x.props,null,d.mode,y),y.ref=as(d,p,x),y.return=d,y)}function u(d,p,x,y){return p===null||p.tag!==4||p.stateNode.containerInfo!==x.containerInfo||p.stateNode.implementation!==x.implementation?(p=Ua(x,d.mode,y),p.return=d,p):(p=i(p,x.children||[]),p.return=d,p)}function f(d,p,x,y,C){return p===null||p.tag!==7?(p=Vr(x,d.mode,y,C),p.return=d,p):(p=i(p,x),p.return=d,p)}function h(d,p,x){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Wa(""+p,d.mode,x),p.return=d,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case wo:return x=ll(p.type,p.key,p.props,null,d.mode,x),x.ref=as(d,null,p),x.return=d,x;case mi:return p=Ua(p,d.mode,x),p.return=d,p;case ar:var y=p._init;return h(d,y(p._payload),x)}if(vs(p)||rs(p))return p=Vr(p,d.mode,x,null),p.return=d,p;Mo(d,p)}return null}function g(d,p,x,y){var C=p!==null?p.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return C!==null?null:a(d,p,""+x,y);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case wo:return x.key===C?c(d,p,x,y):null;case mi:return x.key===C?u(d,p,x,y):null;case ar:return C=x._init,g(d,p,C(x._payload),y)}if(vs(x)||rs(x))return C!==null?null:f(d,p,x,y,null);Mo(d,x)}return null}function m(d,p,x,y,C){if(typeof y=="string"&&y!==""||typeof y=="number")return d=d.get(x)||null,a(p,d,""+y,C);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case wo:return d=d.get(y.key===null?x:y.key)||null,c(p,d,y,C);case mi:return d=d.get(y.key===null?x:y.key)||null,u(p,d,y,C);case ar:var A=y._init;return m(d,p,x,A(y._payload),C)}if(vs(y)||rs(y))return d=d.get(x)||null,f(p,d,y,C,null);Mo(p,y)}return null}function S(d,p,x,y){for(var C=null,A=null,D=p,R=p=0,P=null;D!==null&&R<x.length;R++){D.index>R?(P=D,D=null):P=D.sibling;var F=g(d,D,x[R],y);if(F===null){D===null&&(D=P);break}e&&D&&F.alternate===null&&t(d,D),p=s(F,p,R),A===null?C=F:A.sibling=F,A=F,D=P}if(R===x.length)return n(d,D),ut&&Rr(d,R),C;if(D===null){for(;R<x.length;R++)D=h(d,x[R],y),D!==null&&(p=s(D,p,R),A===null?C=D:A.sibling=D,A=D);return ut&&Rr(d,R),C}for(D=r(d,D);R<x.length;R++)P=m(D,d,R,x[R],y),P!==null&&(e&&P.alternate!==null&&D.delete(P.key===null?R:P.key),p=s(P,p,R),A===null?C=P:A.sibling=P,A=P);return e&&D.forEach(function(G){return t(d,G)}),ut&&Rr(d,R),C}function w(d,p,x,y){var C=rs(x);if(typeof C!="function")throw Error(ne(150));if(x=C.call(x),x==null)throw Error(ne(151));for(var A=C=null,D=p,R=p=0,P=null,F=x.next();D!==null&&!F.done;R++,F=x.next()){D.index>R?(P=D,D=null):P=D.sibling;var G=g(d,D,F.value,y);if(G===null){D===null&&(D=P);break}e&&D&&G.alternate===null&&t(d,D),p=s(G,p,R),A===null?C=G:A.sibling=G,A=G,D=P}if(F.done)return n(d,D),ut&&Rr(d,R),C;if(D===null){for(;!F.done;R++,F=x.next())F=h(d,F.value,y),F!==null&&(p=s(F,p,R),A===null?C=F:A.sibling=F,A=F);return ut&&Rr(d,R),C}for(D=r(d,D);!F.done;R++,F=x.next())F=m(D,d,R,F.value,y),F!==null&&(e&&F.alternate!==null&&D.delete(F.key===null?R:F.key),p=s(F,p,R),A===null?C=F:A.sibling=F,A=F);return e&&D.forEach(function(J){return t(d,J)}),ut&&Rr(d,R),C}function N(d,p,x,y){if(typeof x=="object"&&x!==null&&x.type===yi&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case wo:e:{for(var C=x.key,A=p;A!==null;){if(A.key===C){if(C=x.type,C===yi){if(A.tag===7){n(d,A.sibling),p=i(A,x.props.children),p.return=d,d=p;break e}}else if(A.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ar&&Sf(C)===A.type){n(d,A.sibling),p=i(A,x.props),p.ref=as(d,A,x),p.return=d,d=p;break e}n(d,A);break}else t(d,A);A=A.sibling}x.type===yi?(p=Vr(x.props.children,d.mode,y,x.key),p.return=d,d=p):(y=ll(x.type,x.key,x.props,null,d.mode,y),y.ref=as(d,p,x),y.return=d,d=y)}return o(d);case mi:e:{for(A=x.key;p!==null;){if(p.key===A)if(p.tag===4&&p.stateNode.containerInfo===x.containerInfo&&p.stateNode.implementation===x.implementation){n(d,p.sibling),p=i(p,x.children||[]),p.return=d,d=p;break e}else{n(d,p);break}else t(d,p);p=p.sibling}p=Ua(x,d.mode,y),p.return=d,d=p}return o(d);case ar:return A=x._init,N(d,p,A(x._payload),y)}if(vs(x))return S(d,p,x,y);if(rs(x))return w(d,p,x,y);Mo(d,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,p!==null&&p.tag===6?(n(d,p.sibling),p=i(p,x),p.return=d,d=p):(n(d,p),p=Wa(x,d.mode,y),p.return=d,d=p),o(d)):n(d,p)}return N}var Wi=sg(!0),og=sg(!1),jl=Dr(null),El=null,ji=null,Vu=null;function Yu(){Vu=ji=El=null}function Gu(e){var t=jl.current;ct(jl),e._currentValue=t}function Bc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Pi(e,t){El=e,Vu=ji=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wt=!0),e.firstContext=null)}function dn(e){var t=e._currentValue;if(Vu!==e)if(e={context:e,memoizedValue:t,next:null},ji===null){if(El===null)throw Error(ne(308));ji=e,El.dependencies={lanes:0,firstContext:e}}else ji=ji.next=e;return t}var Or=null;function Ku(e){Or===null?Or=[e]:Or.push(e)}function lg(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Ku(t)):(n.next=i.next,i.next=n),t.interleaved=n,er(e,r)}function er(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var cr=!1;function Xu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ag(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Qn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function kr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,tt&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,er(e,n)}return i=r.interleaved,i===null?(t.next=t,Ku(r)):(t.next=i.next,i.next=t),r.interleaved=t,er(e,n)}function tl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Pu(e,n)}}function kf(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function _l(e,t,n,r){var i=e.updateQueue;cr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=c))}if(s!==null){var h=i.baseState;o=0,f=u=c=null,a=s;do{var g=a.lane,m=a.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var S=e,w=a;switch(g=t,m=n,w.tag){case 1:if(S=w.payload,typeof S=="function"){h=S.call(m,h,g);break e}h=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=w.payload,g=typeof S=="function"?S.call(m,h,g):S,g==null)break e;h=ht({},h,g);break e;case 2:cr=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else m={eventTime:m,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=m,c=h):f=f.next=m,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=f,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Zr|=o,e.lanes=o,e.memoizedState=h}}function bf(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ne(191,i));i.call(r)}}}var go={},Bn=Dr(go),Qs=Dr(go),Js=Dr(go);function Br(e){if(e===go)throw Error(ne(174));return e}function Qu(e,t){switch(ot(Js,t),ot(Qs,e),ot(Bn,go),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:wc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=wc(t,e)}ct(Bn),ot(Bn,t)}function Ui(){ct(Bn),ct(Qs),ct(Js)}function cg(e){Br(Js.current);var t=Br(Bn.current),n=wc(t,e.type);t!==n&&(ot(Qs,e),ot(Bn,n))}function Ju(e){Qs.current===e&&(ct(Bn),ct(Qs))}var dt=Dr(0);function Nl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $a=[];function Zu(){for(var e=0;e<$a.length;e++)$a[e]._workInProgressVersionPrimary=null;$a.length=0}var nl=ir.ReactCurrentDispatcher,La=ir.ReactCurrentBatchConfig,Jr=0,ft=null,vt=null,bt=null,Al=!1,zs=!1,Zs=0,Kx=0;function zt(){throw Error(ne(321))}function qu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!jn(e[n],t[n]))return!1;return!0}function ed(e,t,n,r,i,s){if(Jr=s,ft=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nl.current=e===null||e.memoizedState===null?Zx:qx,e=n(r,i),zs){s=0;do{if(zs=!1,Zs=0,25<=s)throw Error(ne(301));s+=1,bt=vt=null,t.updateQueue=null,nl.current=ev,e=n(r,i)}while(zs)}if(nl.current=Dl,t=vt!==null&&vt.next!==null,Jr=0,bt=vt=ft=null,Al=!1,t)throw Error(ne(300));return e}function td(){var e=Zs!==0;return Zs=0,e}function Pn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?ft.memoizedState=bt=e:bt=bt.next=e,bt}function fn(){if(vt===null){var e=ft.alternate;e=e!==null?e.memoizedState:null}else e=vt.next;var t=bt===null?ft.memoizedState:bt.next;if(t!==null)bt=t,vt=e;else{if(e===null)throw Error(ne(310));vt=e,e={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},bt===null?ft.memoizedState=bt=e:bt=bt.next=e}return bt}function qs(e,t){return typeof t=="function"?t(e):t}function Oa(e){var t=fn(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var r=vt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,u=s;do{var f=u.lane;if((Jr&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=h,o=r):c=c.next=h,ft.lanes|=f,Zr|=f}u=u.next}while(u!==null&&u!==s);c===null?o=r:c.next=a,jn(r,t.memoizedState)||(Wt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,ft.lanes|=s,Zr|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ba(e){var t=fn(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);jn(s,t.memoizedState)||(Wt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function ug(){}function dg(e,t){var n=ft,r=fn(),i=t(),s=!jn(r.memoizedState,i);if(s&&(r.memoizedState=i,Wt=!0),r=r.queue,nd(pg.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,eo(9,hg.bind(null,n,r,i,t),void 0,null),Ct===null)throw Error(ne(349));Jr&30||fg(n,t,i)}return i}function fg(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function hg(e,t,n,r){t.value=n,t.getSnapshot=r,gg(t)&&mg(e)}function pg(e,t,n){return n(function(){gg(t)&&mg(e)})}function gg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!jn(e,n)}catch{return!0}}function mg(e){var t=er(e,1);t!==null&&bn(t,e,1,-1)}function Cf(e){var t=Pn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:e},t.queue=e,e=e.dispatch=Jx.bind(null,ft,e),[t.memoizedState,e]}function eo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function yg(){return fn().memoizedState}function rl(e,t,n,r){var i=Pn();ft.flags|=e,i.memoizedState=eo(1|t,n,void 0,r===void 0?null:r)}function ta(e,t,n,r){var i=fn();r=r===void 0?null:r;var s=void 0;if(vt!==null){var o=vt.memoizedState;if(s=o.destroy,r!==null&&qu(r,o.deps)){i.memoizedState=eo(t,n,s,r);return}}ft.flags|=e,i.memoizedState=eo(1|t,n,s,r)}function jf(e,t){return rl(8390656,8,e,t)}function nd(e,t){return ta(2048,8,e,t)}function xg(e,t){return ta(4,2,e,t)}function vg(e,t){return ta(4,4,e,t)}function wg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Sg(e,t,n){return n=n!=null?n.concat([e]):null,ta(4,4,wg.bind(null,t,e),n)}function rd(){}function kg(e,t){var n=fn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&qu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function bg(e,t){var n=fn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&qu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Cg(e,t,n){return Jr&21?(jn(n,t)||(n=Ap(),ft.lanes|=n,Zr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wt=!0),e.memoizedState=n)}function Xx(e,t){var n=it;it=n!==0&&4>n?n:4,e(!0);var r=La.transition;La.transition={};try{e(!1),t()}finally{it=n,La.transition=r}}function jg(){return fn().memoizedState}function Qx(e,t,n){var r=Cr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Eg(e))_g(t,n);else if(n=lg(e,t,n,r),n!==null){var i=$t();bn(n,e,r,i),Ng(n,t,r)}}function Jx(e,t,n){var r=Cr(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Eg(e))_g(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,jn(a,o)){var c=t.interleaved;c===null?(i.next=i,Ku(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=lg(e,t,i,r),n!==null&&(i=$t(),bn(n,e,r,i),Ng(n,t,r))}}function Eg(e){var t=e.alternate;return e===ft||t!==null&&t===ft}function _g(e,t){zs=Al=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ng(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Pu(e,n)}}var Dl={readContext:dn,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},Zx={readContext:dn,useCallback:function(e,t){return Pn().memoizedState=[e,t===void 0?null:t],e},useContext:dn,useEffect:jf,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,rl(4194308,4,wg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return rl(4194308,4,e,t)},useInsertionEffect:function(e,t){return rl(4,2,e,t)},useMemo:function(e,t){var n=Pn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Pn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Qx.bind(null,ft,e),[r.memoizedState,e]},useRef:function(e){var t=Pn();return e={current:e},t.memoizedState=e},useState:Cf,useDebugValue:rd,useDeferredValue:function(e){return Pn().memoizedState=e},useTransition:function(){var e=Cf(!1),t=e[0];return e=Xx.bind(null,e[1]),Pn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ft,i=Pn();if(ut){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=t(),Ct===null)throw Error(ne(349));Jr&30||fg(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,jf(pg.bind(null,r,s,e),[e]),r.flags|=2048,eo(9,hg.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Pn(),t=Ct.identifierPrefix;if(ut){var n=Kn,r=Gn;n=(r&~(1<<32-kn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Zs++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Kx++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},qx={readContext:dn,useCallback:kg,useContext:dn,useEffect:nd,useImperativeHandle:Sg,useInsertionEffect:xg,useLayoutEffect:vg,useMemo:bg,useReducer:Oa,useRef:yg,useState:function(){return Oa(qs)},useDebugValue:rd,useDeferredValue:function(e){var t=fn();return Cg(t,vt.memoizedState,e)},useTransition:function(){var e=Oa(qs)[0],t=fn().memoizedState;return[e,t]},useMutableSource:ug,useSyncExternalStore:dg,useId:jg,unstable_isNewReconciler:!1},ev={readContext:dn,useCallback:kg,useContext:dn,useEffect:nd,useImperativeHandle:Sg,useInsertionEffect:xg,useLayoutEffect:vg,useMemo:bg,useReducer:Ba,useRef:yg,useState:function(){return Ba(qs)},useDebugValue:rd,useDeferredValue:function(e){var t=fn();return vt===null?t.memoizedState=e:Cg(t,vt.memoizedState,e)},useTransition:function(){var e=Ba(qs)[0],t=fn().memoizedState;return[e,t]},useMutableSource:ug,useSyncExternalStore:dg,useId:jg,unstable_isNewReconciler:!1};function yn(e,t){if(e&&e.defaultProps){t=ht({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Fc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ht({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var na={isMounted:function(e){return(e=e._reactInternals)?ri(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=$t(),i=Cr(e),s=Qn(r,i);s.payload=t,n!=null&&(s.callback=n),t=kr(e,s,i),t!==null&&(bn(t,e,i,r),tl(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=$t(),i=Cr(e),s=Qn(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=kr(e,s,i),t!==null&&(bn(t,e,i,r),tl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$t(),r=Cr(e),i=Qn(n,r);i.tag=2,t!=null&&(i.callback=t),t=kr(e,i,r),t!==null&&(bn(t,e,r,n),tl(t,e,r))}};function Ef(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!Ys(n,r)||!Ys(i,s):!0}function Ag(e,t,n){var r=!1,i=Nr,s=t.contextType;return typeof s=="object"&&s!==null?s=dn(s):(i=Yt(t)?Xr:Tt.current,r=t.contextTypes,s=(r=r!=null)?Fi(e,i):Nr),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=na,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function _f(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&na.enqueueReplaceState(t,t.state,null)}function Hc(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Xu(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=dn(s):(s=Yt(t)?Xr:Tt.current,i.context=Fi(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Fc(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&na.enqueueReplaceState(i,i.state,null),_l(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Vi(e,t){try{var n="",r=t;do n+=N0(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Fa(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Wc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var tv=typeof WeakMap=="function"?WeakMap:Map;function Dg(e,t,n){n=Qn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){zl||(zl=!0,qc=r),Wc(e,t)},n}function Mg(e,t,n){n=Qn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Wc(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Wc(e,t),typeof r!="function"&&(br===null?br=new Set([this]):br.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Nf(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new tv;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=gv.bind(null,e,t,n),t.then(e,e))}function Af(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Df(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Qn(-1,1),t.tag=2,kr(n,t,1))),n.lanes|=1),e)}var nv=ir.ReactCurrentOwner,Wt=!1;function It(e,t,n,r){t.child=e===null?og(t,null,n,r):Wi(t,e.child,n,r)}function Mf(e,t,n,r,i){n=n.render;var s=t.ref;return Pi(t,i),r=ed(e,t,n,r,s,i),n=td(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,tr(e,t,i)):(ut&&n&&Hu(t),t.flags|=1,It(e,t,r,i),t.child)}function zf(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!dd(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,zg(e,t,s,r,i)):(e=ll(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ys,n(o,r)&&e.ref===t.ref)return tr(e,t,i)}return t.flags|=1,e=jr(s,r),e.ref=t.ref,e.return=t,t.child=e}function zg(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(Ys(s,r)&&e.ref===t.ref)if(Wt=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(Wt=!0);else return t.lanes=e.lanes,tr(e,t,i)}return Uc(e,t,n,r,i)}function Rg(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(_i,Qt),Qt|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ot(_i,Qt),Qt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ot(_i,Qt),Qt|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,ot(_i,Qt),Qt|=r;return It(e,t,i,n),t.child}function Pg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Uc(e,t,n,r,i){var s=Yt(n)?Xr:Tt.current;return s=Fi(t,s),Pi(t,i),n=ed(e,t,n,r,s,i),r=td(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,tr(e,t,i)):(ut&&r&&Hu(t),t.flags|=1,It(e,t,n,i),t.child)}function Rf(e,t,n,r,i){if(Yt(n)){var s=!0;kl(t)}else s=!1;if(Pi(t,i),t.stateNode===null)il(e,t),Ag(t,n,r),Hc(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=dn(u):(u=Yt(n)?Xr:Tt.current,u=Fi(t,u));var f=n.getDerivedStateFromProps,h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==u)&&_f(t,o,r,u),cr=!1;var g=t.memoizedState;o.state=g,_l(t,r,o,i),c=t.memoizedState,a!==r||g!==c||Vt.current||cr?(typeof f=="function"&&(Fc(t,n,f,r),c=t.memoizedState),(a=cr||Ef(t,n,a,r,g,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ag(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:yn(t.type,a),o.props=u,h=t.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=dn(c):(c=Yt(n)?Xr:Tt.current,c=Fi(t,c));var m=n.getDerivedStateFromProps;(f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||g!==c)&&_f(t,o,r,c),cr=!1,g=t.memoizedState,o.state=g,_l(t,r,o,i);var S=t.memoizedState;a!==h||g!==S||Vt.current||cr?(typeof m=="function"&&(Fc(t,n,m,r),S=t.memoizedState),(u=cr||Ef(t,n,u,r,g,S,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=S),o.props=r,o.state=S,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),r=!1)}return Vc(e,t,n,r,s,i)}function Vc(e,t,n,r,i,s){Pg(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&xf(t,n,!1),tr(e,t,s);r=t.stateNode,nv.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Wi(t,e.child,null,s),t.child=Wi(t,null,a,s)):It(e,t,a,s),t.memoizedState=r.state,i&&xf(t,n,!0),t.child}function Tg(e){var t=e.stateNode;t.pendingContext?yf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&yf(e,t.context,!1),Qu(e,t.containerInfo)}function Pf(e,t,n,r,i){return Hi(),Uu(i),t.flags|=256,It(e,t,n,r),t.child}var Yc={dehydrated:null,treeContext:null,retryLane:0};function Gc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ig(e,t,n){var r=t.pendingProps,i=dt.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),ot(dt,i&1),e===null)return Oc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=sa(o,r,0,null),e=Vr(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Gc(n),t.memoizedState=Yc,e):id(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return rv(e,t,o,r,a,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=jr(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=jr(a,s):(s=Vr(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?Gc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=Yc,r}return s=e.child,e=s.sibling,r=jr(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function id(e,t){return t=sa({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function zo(e,t,n,r){return r!==null&&Uu(r),Wi(t,e.child,null,n),e=id(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rv(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=Fa(Error(ne(422))),zo(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=sa({mode:"visible",children:r.children},i,0,null),s=Vr(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&Wi(t,e.child,null,o),t.child.memoizedState=Gc(o),t.memoizedState=Yc,s);if(!(t.mode&1))return zo(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ne(419)),r=Fa(s,r,void 0),zo(e,t,o,r)}if(a=(o&e.childLanes)!==0,Wt||a){if(r=Ct,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,er(e,i),bn(r,e,i,-1))}return ud(),r=Fa(Error(ne(421))),zo(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=mv.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Jt=Sr(i.nextSibling),Zt=t,ut=!0,wn=null,e!==null&&(sn[on++]=Gn,sn[on++]=Kn,sn[on++]=Qr,Gn=e.id,Kn=e.overflow,Qr=t),t=id(t,r.children),t.flags|=4096,t)}function Tf(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Bc(e.return,t,n)}function Ha(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function $g(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(It(e,t,r.children,n),r=dt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Tf(e,n,t);else if(e.tag===19)Tf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ot(dt,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Nl(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ha(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Nl(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ha(t,!0,n,null,s);break;case"together":Ha(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function il(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function tr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Zr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ne(153));if(t.child!==null){for(e=t.child,n=jr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=jr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function iv(e,t,n){switch(t.tag){case 3:Tg(t),Hi();break;case 5:cg(t);break;case 1:Yt(t.type)&&kl(t);break;case 4:Qu(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;ot(jl,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ot(dt,dt.current&1),t.flags|=128,null):n&t.child.childLanes?Ig(e,t,n):(ot(dt,dt.current&1),e=tr(e,t,n),e!==null?e.sibling:null);ot(dt,dt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return $g(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ot(dt,dt.current),r)break;return null;case 22:case 23:return t.lanes=0,Rg(e,t,n)}return tr(e,t,n)}var Lg,Kc,Og,Bg;Lg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kc=function(){};Og=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Br(Bn.current);var s=null;switch(n){case"input":i=mc(e,i),r=mc(e,r),s=[];break;case"select":i=ht({},i,{value:void 0}),r=ht({},r,{value:void 0}),s=[];break;case"textarea":i=vc(e,i),r=vc(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=wl)}Sc(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Os.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Os.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&at("scroll",e),s||a===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};Bg=function(e,t,n,r){n!==r&&(t.flags|=4)};function cs(e,t){if(!ut)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function sv(e,t,n){var r=t.pendingProps;switch(Wu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(t),null;case 1:return Yt(t.type)&&Sl(),Rt(t),null;case 3:return r=t.stateNode,Ui(),ct(Vt),ct(Tt),Zu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Do(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,wn!==null&&(nu(wn),wn=null))),Kc(e,t),Rt(t),null;case 5:Ju(t);var i=Br(Js.current);if(n=t.type,e!==null&&t.stateNode!=null)Og(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ne(166));return Rt(t),null}if(e=Br(Bn.current),Do(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[In]=t,r[Xs]=s,e=(t.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(i=0;i<Ss.length;i++)at(Ss[i],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":Wd(r,s),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},at("invalid",r);break;case"textarea":Vd(r,s),at("invalid",r)}Sc(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ao(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ao(r.textContent,a,e),i=["children",""+a]):Os.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&at("scroll",r)}switch(n){case"input":So(r),Ud(r,s,!0);break;case"textarea":So(r),Yd(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=wl)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=pp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[In]=t,e[Xs]=r,Lg(e,t,!1,!1),t.stateNode=e;e:{switch(o=kc(n,r),n){case"dialog":at("cancel",e),at("close",e),i=r;break;case"iframe":case"object":case"embed":at("load",e),i=r;break;case"video":case"audio":for(i=0;i<Ss.length;i++)at(Ss[i],e);i=r;break;case"source":at("error",e),i=r;break;case"img":case"image":case"link":at("error",e),at("load",e),i=r;break;case"details":at("toggle",e),i=r;break;case"input":Wd(e,r),i=mc(e,r),at("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=ht({},r,{value:void 0}),at("invalid",e);break;case"textarea":Vd(e,r),i=vc(e,r),at("invalid",e);break;default:i=r}Sc(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?yp(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&gp(e,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Bs(e,c):typeof c=="number"&&Bs(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Os.hasOwnProperty(s)?c!=null&&s==="onScroll"&&at("scroll",e):c!=null&&Nu(e,s,c,o))}switch(n){case"input":So(e),Ud(e,r,!1);break;case"textarea":So(e),Yd(e);break;case"option":r.value!=null&&e.setAttribute("value",""+_r(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?Di(e,!!r.multiple,s,!1):r.defaultValue!=null&&Di(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=wl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Rt(t),null;case 6:if(e&&t.stateNode!=null)Bg(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ne(166));if(n=Br(Js.current),Br(Bn.current),Do(t)){if(r=t.stateNode,n=t.memoizedProps,r[In]=t,(s=r.nodeValue!==n)&&(e=Zt,e!==null))switch(e.tag){case 3:Ao(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ao(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[In]=t,t.stateNode=r}return Rt(t),null;case 13:if(ct(dt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ut&&Jt!==null&&t.mode&1&&!(t.flags&128))ig(),Hi(),t.flags|=98560,s=!1;else if(s=Do(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(ne(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ne(317));s[In]=t}else Hi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Rt(t),s=!1}else wn!==null&&(nu(wn),wn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||dt.current&1?wt===0&&(wt=3):ud())),t.updateQueue!==null&&(t.flags|=4),Rt(t),null);case 4:return Ui(),Kc(e,t),e===null&&Gs(t.stateNode.containerInfo),Rt(t),null;case 10:return Gu(t.type._context),Rt(t),null;case 17:return Yt(t.type)&&Sl(),Rt(t),null;case 19:if(ct(dt),s=t.memoizedState,s===null)return Rt(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)cs(s,!1);else{if(wt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Nl(e),o!==null){for(t.flags|=128,cs(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ot(dt,dt.current&1|2),t.child}e=e.sibling}s.tail!==null&&mt()>Yi&&(t.flags|=128,r=!0,cs(s,!1),t.lanes=4194304)}else{if(!r)if(e=Nl(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),cs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ut)return Rt(t),null}else 2*mt()-s.renderingStartTime>Yi&&n!==1073741824&&(t.flags|=128,r=!0,cs(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=mt(),t.sibling=null,n=dt.current,ot(dt,r?n&1|2:n&1),t):(Rt(t),null);case 22:case 23:return cd(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Qt&1073741824&&(Rt(t),t.subtreeFlags&6&&(t.flags|=8192)):Rt(t),null;case 24:return null;case 25:return null}throw Error(ne(156,t.tag))}function ov(e,t){switch(Wu(t),t.tag){case 1:return Yt(t.type)&&Sl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ui(),ct(Vt),ct(Tt),Zu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ju(t),null;case 13:if(ct(dt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ne(340));Hi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ct(dt),null;case 4:return Ui(),null;case 10:return Gu(t.type._context),null;case 22:case 23:return cd(),null;case 24:return null;default:return null}}var Ro=!1,Pt=!1,lv=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Ei(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){pt(e,t,r)}else n.current=null}function Xc(e,t,n){try{n()}catch(r){pt(e,t,r)}}var If=!1;function av(e,t){if(zc=yl,e=Vp(),Fu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,u=0,f=0,h=e,g=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)g=h,h=m;for(;;){if(h===e)break t;if(g===n&&++u===i&&(a=o),g===s&&++f===r&&(c=o),(m=h.nextSibling)!==null)break;h=g,g=h.parentNode}h=m}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Rc={focusedElem:e,selectionRange:n},yl=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var S=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var w=S.memoizedProps,N=S.memoizedState,d=t.stateNode,p=d.getSnapshotBeforeUpdate(t.elementType===t.type?w:yn(t.type,w),N);d.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(y){pt(t,t.return,y)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return S=If,If=!1,S}function Rs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Xc(t,n,s)}i=i.next}while(i!==r)}}function ra(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Qc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Fg(e){var t=e.alternate;t!==null&&(e.alternate=null,Fg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[In],delete t[Xs],delete t[Ic],delete t[Ux],delete t[Vx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Hg(e){return e.tag===5||e.tag===3||e.tag===4}function $f(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Jc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=wl));else if(r!==4&&(e=e.child,e!==null))for(Jc(e,t,n),e=e.sibling;e!==null;)Jc(e,t,n),e=e.sibling}function Zc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Zc(e,t,n),e=e.sibling;e!==null;)Zc(e,t,n),e=e.sibling}var Et=null,xn=!1;function sr(e,t,n){for(n=n.child;n!==null;)Wg(e,t,n),n=n.sibling}function Wg(e,t,n){if(On&&typeof On.onCommitFiberUnmount=="function")try{On.onCommitFiberUnmount(Xl,n)}catch{}switch(n.tag){case 5:Pt||Ei(n,t);case 6:var r=Et,i=xn;Et=null,sr(e,t,n),Et=r,xn=i,Et!==null&&(xn?(e=Et,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Et.removeChild(n.stateNode));break;case 18:Et!==null&&(xn?(e=Et,n=n.stateNode,e.nodeType===8?Ta(e.parentNode,n):e.nodeType===1&&Ta(e,n),Us(e)):Ta(Et,n.stateNode));break;case 4:r=Et,i=xn,Et=n.stateNode.containerInfo,xn=!0,sr(e,t,n),Et=r,xn=i;break;case 0:case 11:case 14:case 15:if(!Pt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Xc(n,t,o),i=i.next}while(i!==r)}sr(e,t,n);break;case 1:if(!Pt&&(Ei(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){pt(n,t,a)}sr(e,t,n);break;case 21:sr(e,t,n);break;case 22:n.mode&1?(Pt=(r=Pt)||n.memoizedState!==null,sr(e,t,n),Pt=r):sr(e,t,n);break;default:sr(e,t,n)}}function Lf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new lv),t.forEach(function(r){var i=yv.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function gn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Et=a.stateNode,xn=!1;break e;case 3:Et=a.stateNode.containerInfo,xn=!0;break e;case 4:Et=a.stateNode.containerInfo,xn=!0;break e}a=a.return}if(Et===null)throw Error(ne(160));Wg(s,o,i),Et=null,xn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){pt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ug(t,e),t=t.sibling}function Ug(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gn(t,e),Nn(e),r&4){try{Rs(3,e,e.return),ra(3,e)}catch(w){pt(e,e.return,w)}try{Rs(5,e,e.return)}catch(w){pt(e,e.return,w)}}break;case 1:gn(t,e),Nn(e),r&512&&n!==null&&Ei(n,n.return);break;case 5:if(gn(t,e),Nn(e),r&512&&n!==null&&Ei(n,n.return),e.flags&32){var i=e.stateNode;try{Bs(i,"")}catch(w){pt(e,e.return,w)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&fp(i,s),kc(a,o);var u=kc(a,s);for(o=0;o<c.length;o+=2){var f=c[o],h=c[o+1];f==="style"?yp(i,h):f==="dangerouslySetInnerHTML"?gp(i,h):f==="children"?Bs(i,h):Nu(i,f,h,u)}switch(a){case"input":yc(i,s);break;case"textarea":hp(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Di(i,!!s.multiple,m,!1):g!==!!s.multiple&&(s.defaultValue!=null?Di(i,!!s.multiple,s.defaultValue,!0):Di(i,!!s.multiple,s.multiple?[]:"",!1))}i[Xs]=s}catch(w){pt(e,e.return,w)}}break;case 6:if(gn(t,e),Nn(e),r&4){if(e.stateNode===null)throw Error(ne(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(w){pt(e,e.return,w)}}break;case 3:if(gn(t,e),Nn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Us(t.containerInfo)}catch(w){pt(e,e.return,w)}break;case 4:gn(t,e),Nn(e);break;case 13:gn(t,e),Nn(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ld=mt())),r&4&&Lf(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Pt=(u=Pt)||f,gn(t,e),Pt=u):gn(t,e),Nn(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(Ne=e,f=e.child;f!==null;){for(h=Ne=f;Ne!==null;){switch(g=Ne,m=g.child,g.tag){case 0:case 11:case 14:case 15:Rs(4,g,g.return);break;case 1:Ei(g,g.return);var S=g.stateNode;if(typeof S.componentWillUnmount=="function"){r=g,n=g.return;try{t=r,S.props=t.memoizedProps,S.state=t.memoizedState,S.componentWillUnmount()}catch(w){pt(r,n,w)}}break;case 5:Ei(g,g.return);break;case 22:if(g.memoizedState!==null){Bf(h);continue}}m!==null?(m.return=g,Ne=m):Bf(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=mp("display",o))}catch(w){pt(e,e.return,w)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(w){pt(e,e.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gn(t,e),Nn(e),r&4&&Lf(e);break;case 21:break;default:gn(t,e),Nn(e)}}function Nn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Hg(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Bs(i,""),r.flags&=-33);var s=$f(e);Zc(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=$f(e);Jc(e,a,o);break;default:throw Error(ne(161))}}catch(c){pt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function cv(e,t,n){Ne=e,Vg(e)}function Vg(e,t,n){for(var r=(e.mode&1)!==0;Ne!==null;){var i=Ne,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Ro;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Pt;a=Ro;var u=Pt;if(Ro=o,(Pt=c)&&!u)for(Ne=i;Ne!==null;)o=Ne,c=o.child,o.tag===22&&o.memoizedState!==null?Ff(i):c!==null?(c.return=o,Ne=c):Ff(i);for(;s!==null;)Ne=s,Vg(s),s=s.sibling;Ne=i,Ro=a,Pt=u}Of(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ne=s):Of(e)}}function Of(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Pt||ra(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Pt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:yn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&bf(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bf(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Us(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}Pt||t.flags&512&&Qc(t)}catch(g){pt(t,t.return,g)}}if(t===e){Ne=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ne=n;break}Ne=t.return}}function Bf(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ne=n;break}Ne=t.return}}function Ff(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ra(4,t)}catch(c){pt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){pt(t,i,c)}}var s=t.return;try{Qc(t)}catch(c){pt(t,s,c)}break;case 5:var o=t.return;try{Qc(t)}catch(c){pt(t,o,c)}}}catch(c){pt(t,t.return,c)}if(t===e){Ne=null;break}var a=t.sibling;if(a!==null){a.return=t.return,Ne=a;break}Ne=t.return}}var uv=Math.ceil,Ml=ir.ReactCurrentDispatcher,sd=ir.ReactCurrentOwner,un=ir.ReactCurrentBatchConfig,tt=0,Ct=null,xt=null,At=0,Qt=0,_i=Dr(0),wt=0,to=null,Zr=0,ia=0,od=0,Ps=null,Ht=null,ld=0,Yi=1/0,Un=null,zl=!1,qc=null,br=null,Po=!1,yr=null,Rl=0,Ts=0,eu=null,sl=-1,ol=0;function $t(){return tt&6?mt():sl!==-1?sl:sl=mt()}function Cr(e){return e.mode&1?tt&2&&At!==0?At&-At:Gx.transition!==null?(ol===0&&(ol=Ap()),ol):(e=it,e!==0||(e=window.event,e=e===void 0?16:Ip(e.type)),e):1}function bn(e,t,n,r){if(50<Ts)throw Ts=0,eu=null,Error(ne(185));fo(e,n,r),(!(tt&2)||e!==Ct)&&(e===Ct&&(!(tt&2)&&(ia|=n),wt===4&&pr(e,At)),Gt(e,r),n===1&&tt===0&&!(t.mode&1)&&(Yi=mt()+500,ea&&Mr()))}function Gt(e,t){var n=e.callbackNode;G0(e,t);var r=ml(e,e===Ct?At:0);if(r===0)n!==null&&Xd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Xd(n),t===1)e.tag===0?Yx(Hf.bind(null,e)):tg(Hf.bind(null,e)),Hx(function(){!(tt&6)&&Mr()}),n=null;else{switch(Dp(r)){case 1:n=Ru;break;case 4:n=_p;break;case 16:n=gl;break;case 536870912:n=Np;break;default:n=gl}n=qg(n,Yg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Yg(e,t){if(sl=-1,ol=0,tt&6)throw Error(ne(327));var n=e.callbackNode;if(Ti()&&e.callbackNode!==n)return null;var r=ml(e,e===Ct?At:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Pl(e,r);else{t=r;var i=tt;tt|=2;var s=Kg();(Ct!==e||At!==t)&&(Un=null,Yi=mt()+500,Ur(e,t));do try{hv();break}catch(a){Gg(e,a)}while(!0);Yu(),Ml.current=s,tt=i,xt!==null?t=0:(Ct=null,At=0,t=wt)}if(t!==0){if(t===2&&(i=_c(e),i!==0&&(r=i,t=tu(e,i))),t===1)throw n=to,Ur(e,0),pr(e,r),Gt(e,mt()),n;if(t===6)pr(e,r);else{if(i=e.current.alternate,!(r&30)&&!dv(i)&&(t=Pl(e,r),t===2&&(s=_c(e),s!==0&&(r=s,t=tu(e,s))),t===1))throw n=to,Ur(e,0),pr(e,r),Gt(e,mt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ne(345));case 2:Pr(e,Ht,Un);break;case 3:if(pr(e,r),(r&130023424)===r&&(t=ld+500-mt(),10<t)){if(ml(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){$t(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Tc(Pr.bind(null,e,Ht,Un),t);break}Pr(e,Ht,Un);break;case 4:if(pr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-kn(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uv(r/1960))-r,10<r){e.timeoutHandle=Tc(Pr.bind(null,e,Ht,Un),r);break}Pr(e,Ht,Un);break;case 5:Pr(e,Ht,Un);break;default:throw Error(ne(329))}}}return Gt(e,mt()),e.callbackNode===n?Yg.bind(null,e):null}function tu(e,t){var n=Ps;return e.current.memoizedState.isDehydrated&&(Ur(e,t).flags|=256),e=Pl(e,t),e!==2&&(t=Ht,Ht=n,t!==null&&nu(t)),e}function nu(e){Ht===null?Ht=e:Ht.push.apply(Ht,e)}function dv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!jn(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function pr(e,t){for(t&=~od,t&=~ia,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-kn(t),r=1<<n;e[n]=-1,t&=~r}}function Hf(e){if(tt&6)throw Error(ne(327));Ti();var t=ml(e,0);if(!(t&1))return Gt(e,mt()),null;var n=Pl(e,t);if(e.tag!==0&&n===2){var r=_c(e);r!==0&&(t=r,n=tu(e,r))}if(n===1)throw n=to,Ur(e,0),pr(e,t),Gt(e,mt()),n;if(n===6)throw Error(ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Pr(e,Ht,Un),Gt(e,mt()),null}function ad(e,t){var n=tt;tt|=1;try{return e(t)}finally{tt=n,tt===0&&(Yi=mt()+500,ea&&Mr())}}function qr(e){yr!==null&&yr.tag===0&&!(tt&6)&&Ti();var t=tt;tt|=1;var n=un.transition,r=it;try{if(un.transition=null,it=1,e)return e()}finally{it=r,un.transition=n,tt=t,!(tt&6)&&Mr()}}function cd(){Qt=_i.current,ct(_i)}function Ur(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Fx(n)),xt!==null)for(n=xt.return;n!==null;){var r=n;switch(Wu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sl();break;case 3:Ui(),ct(Vt),ct(Tt),Zu();break;case 5:Ju(r);break;case 4:Ui();break;case 13:ct(dt);break;case 19:ct(dt);break;case 10:Gu(r.type._context);break;case 22:case 23:cd()}n=n.return}if(Ct=e,xt=e=jr(e.current,null),At=Qt=t,wt=0,to=null,od=ia=Zr=0,Ht=Ps=null,Or!==null){for(t=0;t<Or.length;t++)if(n=Or[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Or=null}return e}function Gg(e,t){do{var n=xt;try{if(Yu(),nl.current=Dl,Al){for(var r=ft.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Al=!1}if(Jr=0,bt=vt=ft=null,zs=!1,Zs=0,sd.current=null,n===null||n.return===null){wt=1,to=t,xt=null;break}e:{var s=e,o=n.return,a=n,c=t;if(t=At,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=a,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Af(o);if(m!==null){m.flags&=-257,Df(m,o,a,s,t),m.mode&1&&Nf(s,u,t),t=m,c=u;var S=t.updateQueue;if(S===null){var w=new Set;w.add(c),t.updateQueue=w}else S.add(c);break e}else{if(!(t&1)){Nf(s,u,t),ud();break e}c=Error(ne(426))}}else if(ut&&a.mode&1){var N=Af(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Df(N,o,a,s,t),Uu(Vi(c,a));break e}}s=c=Vi(c,a),wt!==4&&(wt=2),Ps===null?Ps=[s]:Ps.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var d=Dg(s,c,t);kf(s,d);break e;case 1:a=c;var p=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(br===null||!br.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var y=Mg(s,a,t);kf(s,y);break e}}s=s.return}while(s!==null)}Qg(n)}catch(C){t=C,xt===n&&n!==null&&(xt=n=n.return);continue}break}while(!0)}function Kg(){var e=Ml.current;return Ml.current=Dl,e===null?Dl:e}function ud(){(wt===0||wt===3||wt===2)&&(wt=4),Ct===null||!(Zr&268435455)&&!(ia&268435455)||pr(Ct,At)}function Pl(e,t){var n=tt;tt|=2;var r=Kg();(Ct!==e||At!==t)&&(Un=null,Ur(e,t));do try{fv();break}catch(i){Gg(e,i)}while(!0);if(Yu(),tt=n,Ml.current=r,xt!==null)throw Error(ne(261));return Ct=null,At=0,wt}function fv(){for(;xt!==null;)Xg(xt)}function hv(){for(;xt!==null&&!L0();)Xg(xt)}function Xg(e){var t=Zg(e.alternate,e,Qt);e.memoizedProps=e.pendingProps,t===null?Qg(e):xt=t,sd.current=null}function Qg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=ov(n,t),n!==null){n.flags&=32767,xt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{wt=6,xt=null;return}}else if(n=sv(n,t,Qt),n!==null){xt=n;return}if(t=t.sibling,t!==null){xt=t;return}xt=t=e}while(t!==null);wt===0&&(wt=5)}function Pr(e,t,n){var r=it,i=un.transition;try{un.transition=null,it=1,pv(e,t,n,r)}finally{un.transition=i,it=r}return null}function pv(e,t,n,r){do Ti();while(yr!==null);if(tt&6)throw Error(ne(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ne(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(K0(e,s),e===Ct&&(xt=Ct=null,At=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Po||(Po=!0,qg(gl,function(){return Ti(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=un.transition,un.transition=null;var o=it;it=1;var a=tt;tt|=4,sd.current=null,av(e,n),Ug(n,e),Px(Rc),yl=!!zc,Rc=zc=null,e.current=n,cv(n),O0(),tt=a,it=o,un.transition=s}else e.current=n;if(Po&&(Po=!1,yr=e,Rl=i),s=e.pendingLanes,s===0&&(br=null),H0(n.stateNode),Gt(e,mt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(zl)throw zl=!1,e=qc,qc=null,e;return Rl&1&&e.tag!==0&&Ti(),s=e.pendingLanes,s&1?e===eu?Ts++:(Ts=0,eu=e):Ts=0,Mr(),null}function Ti(){if(yr!==null){var e=Dp(Rl),t=un.transition,n=it;try{if(un.transition=null,it=16>e?16:e,yr===null)var r=!1;else{if(e=yr,yr=null,Rl=0,tt&6)throw Error(ne(331));var i=tt;for(tt|=4,Ne=e.current;Ne!==null;){var s=Ne,o=s.child;if(Ne.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(Ne=u;Ne!==null;){var f=Ne;switch(f.tag){case 0:case 11:case 15:Rs(8,f,s)}var h=f.child;if(h!==null)h.return=f,Ne=h;else for(;Ne!==null;){f=Ne;var g=f.sibling,m=f.return;if(Fg(f),f===u){Ne=null;break}if(g!==null){g.return=m,Ne=g;break}Ne=m}}}var S=s.alternate;if(S!==null){var w=S.child;if(w!==null){S.child=null;do{var N=w.sibling;w.sibling=null,w=N}while(w!==null)}}Ne=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Ne=o;else e:for(;Ne!==null;){if(s=Ne,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Rs(9,s,s.return)}var d=s.sibling;if(d!==null){d.return=s.return,Ne=d;break e}Ne=s.return}}var p=e.current;for(Ne=p;Ne!==null;){o=Ne;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,Ne=x;else e:for(o=p;Ne!==null;){if(a=Ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ra(9,a)}}catch(C){pt(a,a.return,C)}if(a===o){Ne=null;break e}var y=a.sibling;if(y!==null){y.return=a.return,Ne=y;break e}Ne=a.return}}if(tt=i,Mr(),On&&typeof On.onPostCommitFiberRoot=="function")try{On.onPostCommitFiberRoot(Xl,e)}catch{}r=!0}return r}finally{it=n,un.transition=t}}return!1}function Wf(e,t,n){t=Vi(n,t),t=Dg(e,t,1),e=kr(e,t,1),t=$t(),e!==null&&(fo(e,1,t),Gt(e,t))}function pt(e,t,n){if(e.tag===3)Wf(e,e,n);else for(;t!==null;){if(t.tag===3){Wf(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(br===null||!br.has(r))){e=Vi(n,e),e=Mg(t,e,1),t=kr(t,e,1),e=$t(),t!==null&&(fo(t,1,e),Gt(t,e));break}}t=t.return}}function gv(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=$t(),e.pingedLanes|=e.suspendedLanes&n,Ct===e&&(At&n)===n&&(wt===4||wt===3&&(At&130023424)===At&&500>mt()-ld?Ur(e,0):od|=n),Gt(e,t)}function Jg(e,t){t===0&&(e.mode&1?(t=Co,Co<<=1,!(Co&130023424)&&(Co=4194304)):t=1);var n=$t();e=er(e,t),e!==null&&(fo(e,t,n),Gt(e,n))}function mv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Jg(e,n)}function yv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(t),Jg(e,n)}var Zg;Zg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vt.current)Wt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Wt=!1,iv(e,t,n);Wt=!!(e.flags&131072)}else Wt=!1,ut&&t.flags&1048576&&ng(t,Cl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;il(e,t),e=t.pendingProps;var i=Fi(t,Tt.current);Pi(t,n),i=ed(null,t,r,e,i,n);var s=td();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yt(r)?(s=!0,kl(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Xu(t),i.updater=na,t.stateNode=i,i._reactInternals=t,Hc(t,r,e,n),t=Vc(null,t,r,!0,s,n)):(t.tag=0,ut&&s&&Hu(t),It(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(il(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=vv(r),e=yn(r,e),i){case 0:t=Uc(null,t,r,e,n);break e;case 1:t=Rf(null,t,r,e,n);break e;case 11:t=Mf(null,t,r,e,n);break e;case 14:t=zf(null,t,r,yn(r.type,e),n);break e}throw Error(ne(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:yn(r,i),Uc(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:yn(r,i),Rf(e,t,r,i,n);case 3:e:{if(Tg(t),e===null)throw Error(ne(387));r=t.pendingProps,s=t.memoizedState,i=s.element,ag(e,t),_l(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Vi(Error(ne(423)),t),t=Pf(e,t,r,n,i);break e}else if(r!==i){i=Vi(Error(ne(424)),t),t=Pf(e,t,r,n,i);break e}else for(Jt=Sr(t.stateNode.containerInfo.firstChild),Zt=t,ut=!0,wn=null,n=og(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hi(),r===i){t=tr(e,t,n);break e}It(e,t,r,n)}t=t.child}return t;case 5:return cg(t),e===null&&Oc(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Pc(r,i)?o=null:s!==null&&Pc(r,s)&&(t.flags|=32),Pg(e,t),It(e,t,o,n),t.child;case 6:return e===null&&Oc(t),null;case 13:return Ig(e,t,n);case 4:return Qu(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Wi(t,null,r,n):It(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:yn(r,i),Mf(e,t,r,i,n);case 7:return It(e,t,t.pendingProps,n),t.child;case 8:return It(e,t,t.pendingProps.children,n),t.child;case 12:return It(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,ot(jl,r._currentValue),r._currentValue=o,s!==null)if(jn(s.value,o)){if(s.children===i.children&&!Vt.current){t=tr(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Qn(-1,n&-n),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Bc(s.return,n,t),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ne(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Bc(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}It(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Pi(t,n),i=dn(i),r=r(i),t.flags|=1,It(e,t,r,n),t.child;case 14:return r=t.type,i=yn(r,t.pendingProps),i=yn(r.type,i),zf(e,t,r,i,n);case 15:return zg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:yn(r,i),il(e,t),t.tag=1,Yt(r)?(e=!0,kl(t)):e=!1,Pi(t,n),Ag(t,r,i),Hc(t,r,i,n),Vc(null,t,r,!0,e,n);case 19:return $g(e,t,n);case 22:return Rg(e,t,n)}throw Error(ne(156,t.tag))};function qg(e,t){return Ep(e,t)}function xv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(e,t,n,r){return new xv(e,t,n,r)}function dd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vv(e){if(typeof e=="function")return dd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Du)return 11;if(e===Mu)return 14}return 2}function jr(e,t){var n=e.alternate;return n===null?(n=an(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ll(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")dd(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case yi:return Vr(n.children,i,s,t);case Au:o=8,i|=8;break;case fc:return e=an(12,n,t,i|2),e.elementType=fc,e.lanes=s,e;case hc:return e=an(13,n,t,i),e.elementType=hc,e.lanes=s,e;case pc:return e=an(19,n,t,i),e.elementType=pc,e.lanes=s,e;case cp:return sa(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lp:o=10;break e;case ap:o=9;break e;case Du:o=11;break e;case Mu:o=14;break e;case ar:o=16,r=null;break e}throw Error(ne(130,e==null?e:typeof e,""))}return t=an(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function Vr(e,t,n,r){return e=an(7,e,r,t),e.lanes=n,e}function sa(e,t,n,r){return e=an(22,e,r,t),e.elementType=cp,e.lanes=n,e.stateNode={isHidden:!1},e}function Wa(e,t,n){return e=an(6,e,null,t),e.lanes=n,e}function Ua(e,t,n){return t=an(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function wv(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ca(0),this.expirationTimes=Ca(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ca(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function fd(e,t,n,r,i,s,o,a,c){return e=new wv(e,t,n,a,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=an(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xu(s),e}function Sv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function em(e){if(!e)return Nr;e=e._reactInternals;e:{if(ri(e)!==e||e.tag!==1)throw Error(ne(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ne(171))}if(e.tag===1){var n=e.type;if(Yt(n))return eg(e,n,t)}return t}function tm(e,t,n,r,i,s,o,a,c){return e=fd(n,r,!0,e,i,s,o,a,c),e.context=em(null),n=e.current,r=$t(),i=Cr(n),s=Qn(r,i),s.callback=t??null,kr(n,s,i),e.current.lanes=i,fo(e,i,r),Gt(e,r),e}function oa(e,t,n,r){var i=t.current,s=$t(),o=Cr(i);return n=em(n),t.context===null?t.context=n:t.pendingContext=n,t=Qn(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=kr(i,t,o),e!==null&&(bn(e,i,o,s),tl(e,i,o)),o}function Tl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Uf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function hd(e,t){Uf(e,t),(e=e.alternate)&&Uf(e,t)}function kv(){return null}var nm=typeof reportError=="function"?reportError:function(e){console.error(e)};function pd(e){this._internalRoot=e}la.prototype.render=pd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ne(409));oa(e,t,null,null)};la.prototype.unmount=pd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;qr(function(){oa(null,e,null,null)}),t[qn]=null}};function la(e){this._internalRoot=e}la.prototype.unstable_scheduleHydration=function(e){if(e){var t=Rp();e={blockedOn:null,target:e,priority:t};for(var n=0;n<hr.length&&t!==0&&t<hr[n].priority;n++);hr.splice(n,0,e),n===0&&Tp(e)}};function gd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function aa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Vf(){}function bv(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Tl(o);s.call(u)}}var o=tm(t,r,e,0,null,!1,!1,"",Vf);return e._reactRootContainer=o,e[qn]=o.current,Gs(e.nodeType===8?e.parentNode:e),qr(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Tl(c);a.call(u)}}var c=fd(e,0,!1,null,null,!1,!1,"",Vf);return e._reactRootContainer=c,e[qn]=c.current,Gs(e.nodeType===8?e.parentNode:e),qr(function(){oa(t,c,n,r)}),c}function ca(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=Tl(o);a.call(c)}}oa(t,o,e,i)}else o=bv(n,t,e,i,r);return Tl(o)}Mp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ws(t.pendingLanes);n!==0&&(Pu(t,n|1),Gt(t,mt()),!(tt&6)&&(Yi=mt()+500,Mr()))}break;case 13:qr(function(){var r=er(e,1);if(r!==null){var i=$t();bn(r,e,1,i)}}),hd(e,1)}};Tu=function(e){if(e.tag===13){var t=er(e,134217728);if(t!==null){var n=$t();bn(t,e,134217728,n)}hd(e,134217728)}};zp=function(e){if(e.tag===13){var t=Cr(e),n=er(e,t);if(n!==null){var r=$t();bn(n,e,t,r)}hd(e,t)}};Rp=function(){return it};Pp=function(e,t){var n=it;try{return it=e,t()}finally{it=n}};Cc=function(e,t,n){switch(t){case"input":if(yc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ql(r);if(!i)throw Error(ne(90));dp(r),yc(r,i)}}}break;case"textarea":hp(e,n);break;case"select":t=n.value,t!=null&&Di(e,!!n.multiple,t,!1)}};wp=ad;Sp=qr;var Cv={usingClientEntryPoint:!1,Events:[po,Si,ql,xp,vp,ad]},us={findFiberByHostInstance:Lr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jv={bundleType:us.bundleType,version:us.version,rendererPackageName:us.rendererPackageName,rendererConfig:us.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ir.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Cp(e),e===null?null:e.stateNode},findFiberByHostInstance:us.findFiberByHostInstance||kv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var To=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!To.isDisabled&&To.supportsFiber)try{Xl=To.inject(jv),On=To}catch{}}tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cv;tn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gd(t))throw Error(ne(200));return Sv(e,t,null,n)};tn.createRoot=function(e,t){if(!gd(e))throw Error(ne(299));var n=!1,r="",i=nm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=fd(e,1,!1,null,null,n,!1,r,i),e[qn]=t.current,Gs(e.nodeType===8?e.parentNode:e),new pd(t)};tn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ne(188)):(e=Object.keys(e).join(","),Error(ne(268,e)));return e=Cp(t),e=e===null?null:e.stateNode,e};tn.flushSync=function(e){return qr(e)};tn.hydrate=function(e,t,n){if(!aa(t))throw Error(ne(200));return ca(null,e,t,!0,n)};tn.hydrateRoot=function(e,t,n){if(!gd(e))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=nm;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=tm(t,null,e,1,n??null,i,!1,s,o),e[qn]=t.current,Gs(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new la(t)};tn.render=function(e,t,n){if(!aa(t))throw Error(ne(200));return ca(null,e,t,!1,n)};tn.unmountComponentAtNode=function(e){if(!aa(e))throw Error(ne(40));return e._reactRootContainer?(qr(function(){ca(null,null,e,!1,function(){e._reactRootContainer=null,e[qn]=null})}),!0):!1};tn.unstable_batchedUpdates=ad;tn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!aa(n))throw Error(ne(200));if(e==null||e._reactInternals===void 0)throw Error(ne(38));return ca(e,t,n,!1,r)};tn.version="18.3.1-next-f1338f8080-20240426";function rm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rm)}catch(e){console.error(e)}}rm(),rp.exports=tn;var Ev=rp.exports,im,Yf=Ev;im=Yf.createRoot,Yf.hydrateRoot;/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Nv=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),Gf=e=>{const t=Nv(e);return t.charAt(0).toUpperCase()+t.slice(1)},sm=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),Av=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Dv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=k.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},c)=>k.createElement("svg",{ref:c,...Dv,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:sm("lucide",i),...!s&&!Av(a)&&{"aria-hidden":"true"},...a},[...o.map(([u,f])=>k.createElement(u,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=(e,t)=>{const n=k.forwardRef(({className:r,...i},s)=>k.createElement(Mv,{ref:s,iconNode:t,className:sm(`lucide-${_v(Gf(e))}`,`lucide-${e}`,r),...i}));return n.displayName=Gf(e),n};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],Rv=Bt("columns-2",zv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pv=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 12h.01",key:"czm47f"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Tv=Bt("dice-6",Pv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ru=Bt("info",Iv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Lv=Bt("layout-grid",$v);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Bv=Bt("list",Ov);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Hv=Bt("plus",Fv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],Uv=Bt("redo-2",Wv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]],Yv=Bt("scale",Vv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Kv=Bt("settings-2",Gv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],om=Bt("shield",Xv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],Jv=Bt("shuffle",Qv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zv=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],oi=Bt("sparkles",Zv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qv=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]],md=Bt("sword",qv);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e1=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],t1=Bt("undo-2",e1);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n1=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],r1=Bt("zap",n1),li=[{id:"gwm",name:"Great Weapon Master",text:"Power attacks with heavy weapons; bonus attack on crit/kill."},{id:"ss",name:"Sharpshooter",text:"Longrange shots without disadvantage; ignore cover; power shot."},{id:"pam",name:"Polearm Master",text:"Bonus attack with polearms; opportunity on entering reach."},{id:"cbe",name:"Crossbow Expert",text:"Ignore loading; no disadvantage in melee; bonus hand crossbow attack."},{id:"alert",name:"Alert",text:"+5 initiative; cant be surprised while conscious; hidden foes dont gain advantage."},{id:"tough",name:"Tough",text:"Increase hit points by 2 per level."},{id:"prodigy",name:"Prodigy",text:"Gain proficiency in one skill; if already proficient, gain expertise (demo)."}],Xt=[{id:"human",name:"Human (Base)",asis:{str:1,dex:1,con:1,int:1,wis:1,cha:1},speed:30,traits:[{id:"versatile",name:"Versatile",text:"+1 to all ability scores."}]},{id:"human-variant",name:"Human (Variant)",asis:{str:1,dex:1},speed:30,traits:[{id:"adaptable",name:"Adaptable",text:"+1 to two ability scores (demo variant)."}]},{id:"elf-wood",name:"Elf (Wood)",asis:{dex:2,wis:1},speed:35,traits:[{id:"darkvision",name:"Darkvision",text:"See in dim light 60 ft."},{id:"keen",name:"Keen Senses",text:"Proficiency in Perception."},{id:"fey-ancestry",name:"Fey Ancestry",text:"Advantage on saves against being charmed; magic cant put you to sleep."}]},{id:"elf-high",name:"Elf (High)",asis:{dex:2,int:1},speed:30,traits:[{id:"darkvision",name:"Darkvision",text:"See in dim light 60 ft."},{id:"keen",name:"Keen Senses",text:"Proficiency in Perception."},{id:"fey-ancestry",name:"Fey Ancestry",text:"Advantage on saves against being charmed; magic cant put you to sleep."}]},{id:"dwarf-hill",name:"Dwarf (Hill)",asis:{con:2,wis:1},speed:25,traits:[{id:"darkvision",name:"Darkvision",text:"See in dim light 60 ft."},{id:"dwarven-resilience",name:"Dwarven Resilience",text:"Advantage on saving throws against poison, and resistance to poison damage (demo flavor)."}]},{id:"dwarf-mountain",name:"Dwarf (Mountain)",asis:{con:2,str:2},speed:25,traits:[{id:"darkvision",name:"Darkvision",text:"See in dim light 60 ft."},{id:"dwarven-resilience",name:"Dwarven Resilience",text:"Advantage on saving throws against poison, and resistance to poison damage (demo flavor)."}]},{id:"halfling-lightfoot",name:"Halfling (Lightfoot)",asis:{dex:2,cha:1},speed:25,traits:[{id:"lucky",name:"Lucky",text:"Reroll 1s on attack, ability, or save rolls (demo flavor)."},{id:"brave",name:"Brave",text:"Advantage on saves vs. fear."}]},{id:"halfling-stout",name:"Halfling (Stout)",asis:{dex:2,con:1},speed:25,traits:[{id:"lucky",name:"Lucky",text:"Reroll 1s on attack, ability, or save rolls (demo flavor)."},{id:"brave",name:"Brave",text:"Advantage on saves vs. fear."},{id:"stout-resilience",name:"Stout Resilience",text:"Advantage on saves vs. poison (demo flavor)."}]},{id:"tiefling",name:"Tiefling",asis:{cha:2,int:1},speed:30,traits:[{id:"darkvision",name:"Darkvision",text:"See in dim light 60 ft."},{id:"hellish-resistance",name:"Hellish Resistance",text:"Resistance to fire damage."}]},{id:"dragonborn",name:"Dragonborn",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry",name:"Draconic Ancestry",text:"Breath weapon and damage resistance depend on ancestry."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance based on ancestry."}]},{id:"dragonborn-black",name:"Dragonborn (Black)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-black",name:"Draconic Ancestry  Black",text:"Acid breath; resistance to acid (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to acid (demo)."}]},{id:"dragonborn-blue",name:"Dragonborn (Blue)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-blue",name:"Draconic Ancestry  Blue",text:"Lightning breath; resistance to lightning (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to lightning (demo)."}]},{id:"dragonborn-brass",name:"Dragonborn (Brass)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-brass",name:"Draconic Ancestry  Brass",text:"Fire breath; resistance to fire (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to fire (demo)."}]},{id:"dragonborn-bronze",name:"Dragonborn (Bronze)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-bronze",name:"Draconic Ancestry  Bronze",text:"Lightning breath; resistance to lightning (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to lightning (demo)."}]},{id:"dragonborn-copper",name:"Dragonborn (Copper)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-copper",name:"Draconic Ancestry  Copper",text:"Acid breath; resistance to acid (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to acid (demo)."}]},{id:"dragonborn-gold",name:"Dragonborn (Gold)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-gold",name:"Draconic Ancestry  Gold",text:"Fire breath; resistance to fire (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to fire (demo)."}]},{id:"dragonborn-green",name:"Dragonborn (Green)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-green",name:"Draconic Ancestry  Green",text:"Poison breath; resistance to poison (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to poison (demo)."}]},{id:"dragonborn-red",name:"Dragonborn (Red)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-red",name:"Draconic Ancestry  Red",text:"Fire breath; resistance to fire (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to fire (demo)."}]},{id:"dragonborn-silver",name:"Dragonborn (Silver)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-silver",name:"Draconic Ancestry  Silver",text:"Cold breath; resistance to cold (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to cold (demo)."}]},{id:"dragonborn-white",name:"Dragonborn (White)",asis:{str:2,cha:1},speed:30,traits:[{id:"draconic-ancestry-white",name:"Draconic Ancestry  White",text:"Cold breath; resistance to cold (demo)."},{id:"breath-weapon",name:"Breath Weapon",text:"Exhale destructive energy (demo flavor)."},{id:"damage-resistance",name:"Damage Resistance",text:"Resistance to cold (demo)."}]},{id:"gnome",name:"Gnome",asis:{int:2},speed:25,traits:[{id:"darkvision",name:"Darkvision",text:"See in dim light 60 ft."},{id:"gnome-cunning",name:"Gnome Cunning",text:"Advantage on INT, WIS, and CHA saves against magic."}]},{id:"half-orc",name:"Half-Orc",asis:{str:2,con:1},speed:30,traits:[{id:"darkvision",name:"Darkvision",text:"See in dim light 60 ft."},{id:"menacing",name:"Menacing",text:"Proficiency in Intimidation."},{id:"relentless-endurance",name:"Relentless Endurance",text:"When reduced to 0 HP but not killed, drop to 1 HP instead (1/long rest)."},{id:"savage-attacks",name:"Savage Attacks",text:"Extra weapon die on a crit (demo flavor)."}]}],Fr=[{id:"barbarian",name:"Barbarian",hitDie:12,armor:["light","medium","shields"],weapons:["simple","martial"],grants:{subactions:["Rage","Reckless Attack"]},featuresByLevel:{1:[{name:"Rage",text:"+2 damage, advantage on STR checks; uses/long rest."},{name:"Unarmored Defense",text:"AC = 10 + DEX + CON when no armor; shield allowed."}],2:[{name:"Reckless Attack",text:"Gain advantage on melee STR attacks this turn; attacks against you have advantage until your next turn."},{name:"Danger Sense",text:"Advantage on DEX saves vs. effects you can see."}],3:[{name:"Primal Path",text:"Choose a subclass and gain its level 3 features."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Extra Attack",text:"Attack twice, instead of once, whenever you take the Attack action."},{name:"Fast Movement",text:"Your speed increases by 10 ft. while not wearing heavy armor."}]},acFormula:e=>e.armor==="none"?10+e.dexMod+e.conMod:void 0,saves:["str","con"],subclasses:[{id:"berserker",name:"Path of the Berserker",unlockLevel:3,grants:{subactions:["Frenzy"]}}]},{id:"ranger",name:"Ranger",hitDie:10,armor:["light","medium","shields"],weapons:["simple","martial"],grants:{subactions:["Cast Spell"]},featuresByLevel:{1:[{name:"Favored Enemy",text:"You have significant experience studying, tracking, and hunting a certain type of enemy."},{name:"Natural Explorer",text:"You are particularly familiar with one type of natural environment and adept at traveling and surviving in such regions."}],2:[{name:"Fighting Style",text:"Choose a combat style to hone your martial prowess."},{name:"Spellcasting",text:"WISbased spellcasting (halfcaster). Gains 1stlevel spells at level 2."}],3:[{name:"Ranger Archetype",text:"Choose an archetype and gain its features."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Extra Attack",text:"Attack twice, instead of once, whenever you take the Attack action."}]},saves:["str","dex"],subclasses:[{id:"hunter",name:"Hunter",unlockLevel:3},{id:"beast-master",name:"Beast Master",unlockLevel:3}]},{id:"rogue",name:"Rogue",hitDie:8,armor:["light"],weapons:["simple","hand-crossbow","longsword","rapier","shortsword"],featuresByLevel:{1:[{name:"Sneak Attack",text:"Deal extra damage once per turn when you have advantage or an ally is adjacent."},{name:"Thieves Cant",text:"Secret mix of dialect, jargon, and code that allows you to hide messages."},{name:"Expertise",text:"Choose two skills; double proficiency bonus for them."}],2:[{name:"Cunning Action",text:"Dash, Disengage, or Hide as a bonus action."}],3:[{name:"Roguish Archetype",text:"Choose an archetype and gain its features."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Uncanny Dodge",text:"Use your reaction to halve the damage from an attacker you can see."}]},saves:["dex","int"],subclasses:[{id:"thief",name:"Thief",unlockLevel:3},{id:"assassin",name:"Assassin",unlockLevel:3},{id:"arcane-trickster",name:"Arcane Trickster",unlockLevel:3}]},{id:"monk",name:"Monk",hitDie:8,armor:[],weapons:["simple","shortswords"],grants:{subactions:["Flurry of Blows","Patient Defense","Step of the Wind"]},featuresByLevel:{1:[{name:"Unarmored Defense",text:"AC = 10 + DEX + WIS while not wearing armor or a shield."},{name:"Martial Arts",text:"Use DEX for unarmed/monk weapon attacks; bonus unarmed strike."}],2:[{name:"Ki",text:"Fuel abilities like Flurry of Blows, Patient Defense, Step of the Wind."},{name:"Unarmored Movement",text:"+10 ft. movement speed while unarmored."}],3:[{name:"Monastic Tradition",text:"Choose a subclass (tradition) and gain its level 3 features."},{name:"Deflect Missiles",text:"Reduce ranged weapon damage; catch/throw sometimes."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."},{name:"Slow Fall",text:"Reduce falling damage by 5  monk level."}],5:[{name:"Extra Attack",text:"Attack twice when you take the Attack action."},{name:"Stunning Strike",text:"On a hit, spend ki to stun a creature that fails a CON save."}]},saves:["str","dex"],subclasses:[{id:"open-hand",name:"Way of the Open Hand",unlockLevel:3,grants:{subactions:[]}},{id:"shadow",name:"Way of Shadow",unlockLevel:3,grants:{subactions:[]}}]},{id:"paladin",name:"Paladin",hitDie:10,armor:["all","shields"],weapons:["simple","martial"],grants:{subactions:["Divine Smite"]},featuresByLevel:{1:[{name:"Divine Sense",text:"Detect celestials, fiends, and undead (limited uses)."},{name:"Lay on Hands",text:"Pool of healing equal to 5  paladin level."}],2:[{name:"Fighting Style",text:"Choose a combat style for a passive benefit."},{name:"Spellcasting",text:"CHAbased halfcaster; gains 1stlevel spell slots."},{name:"Divine Smite",text:"Expend a spell slot to deal radiant damage on a hit."}],3:[{name:"Sacred Oath",text:"Swear an oath (subclass) and gain Channel Divinity options."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Extra Attack",text:"Attack twice, instead of once, whenever you take the Attack action."}]},saves:["wis","cha"],subclasses:[{id:"oath-devotion",name:"Oath of Devotion",unlockLevel:3,grants:{subactions:["Channel Divinity (Devotion)"]}},{id:"oath-vengeance",name:"Oath of Vengeance",unlockLevel:3,grants:{subactions:["Channel Divinity (Vengeance)"]}}]},{id:"fighter",name:"Fighter",hitDie:10,armor:["all","shields"],weapons:["simple","martial"],grants:{subactions:["Second Wind"]},featuresByLevel:{1:[{name:"Second Wind",text:"1d10 + level selfheal, 1/short rest."},{name:"Fighting Style",text:"Choose a combat style for a passive benefit."}],2:[{name:"Action Surge",text:"Take one additional action on your turn, 1/short rest."}],3:[{name:"Martial Archetype",text:"Choose a subclass and gain its level 3 features."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Extra Attack",text:"Attack twice, instead of once, whenever you take the Attack action."}]},saves:["str","con"],subclasses:[{id:"champion",name:"Champion",unlockLevel:3,grants:{subactions:["Improved Critical"]}}]},{id:"bard",name:"Bard",hitDie:8,armor:["light"],weapons:["simple","hand crossbows","longswords","rapiers","shortswords"],grants:{subactions:["Cast Spell","Bardic Inspiration"]},featuresByLevel:{1:[{name:"Spellcasting",text:"CHAbased spellcasting. Cantrips & 1stlevel slots."},{name:"Bardic Inspiration (d6)",text:"As a bonus action, give a creature a d6 inspiration die (CHA uses/long rest)."}],2:[{name:"Jack of All Trades",text:"Add half your proficiency bonus to ability checks you are not proficient in."},{name:"Song of Rest (d6)",text:"During a short rest, allies who hear your performance regain extra 1d6 HP."}],3:[{name:"Bard College",text:"Choose a subclass and gain its level 3 features."},{name:"Expertise",text:"Choose two skills you are proficient in; your proficiency bonus is doubled for them."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Font of Inspiration",text:"Regain all uses of Bardic Inspiration on a short rest."}]},saves:["dex","cha"],subclasses:[{id:"college-of-lore",name:"College of Lore",unlockLevel:3,grants:{subactions:[]}},{id:"college-of-valor",name:"College of Valor",unlockLevel:3,grants:{subactions:[]}}]},{id:"cleric",name:"Cleric",hitDie:8,armor:["light","medium","shields"],weapons:["simple"],grants:{subactions:["Cast Spell"]},featuresByLevel:{1:[{name:"Spellcasting",text:"WISbased spellcasting. Cantrips & 1stlevel slots."},{name:"Divine Domain",text:"Choose a domain (subclass) and gain its level 1 features."}],2:[{name:"Channel Divinity (1/rest)",text:"Turn Undead; your domain adds an additional Channel Divinity option."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Destroy Undead (CR 1/2)",text:"When a turned undead of CR 1/2 or lower fails its save, it is destroyed."},{name:"Spellcasting Progression",text:"Access to higherlevel spell slots and prepared spells."}]},saves:["wis","cha"],subclasses:[{id:"life-domain",name:"Life Domain",unlockLevel:1,grants:{subactions:["Channel Divinity: Preserve Life"]}},{id:"light-domain",name:"Light Domain",unlockLevel:1,grants:{subactions:["Channel Divinity: Radiance of the Dawn"]}}]},{id:"druid",name:"Druid",hitDie:8,armor:["light","medium","shields"],weapons:["clubs","daggers","darts","javelins","maces","quarterstaff","scimitars","sickles","slings","spears"],grants:{subactions:["Cast Spell"]},featuresByLevel:{1:[{name:"Druidic",text:"Secret druidic language known to druids."},{name:"Spellcasting",text:"WISbased prepared spellcasting. Cantrips & 1stlevel slots."}],2:[{name:"Wild Shape",text:"Magically assume the shape of a beast you have seen (limited CR/time)."},{name:"Druid Circle",text:"Choose a circle (subclass) and gain its level 2 features."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Wild Shape Improvement",text:"Improved wild shape options and spellcasting progression."}]},saves:["int","wis"],subclasses:[{id:"circle-land",name:"Circle of the Land",unlockLevel:2,grants:{subactions:[]}},{id:"circle-moon",name:"Circle of the Moon",unlockLevel:2,grants:{subactions:["Combat Wild Shape"]}}]},{id:"wizard",name:"Wizard",hitDie:6,armor:[],weapons:["daggers","quarterstaff"],grants:{subactions:["Cast Spell"]},featuresByLevel:{1:[{name:"Spellcasting",text:"INT spellcasting. Cantrips & 1stlevel slots."},{name:"Arcane Recovery",text:"Recover expended slots on short rest."}],2:[{name:"Arcane Tradition",text:"Choose a subclass (school) and gain its level 2/3 features."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}],5:[{name:"Spellcasting Progression",text:"Access to higherlevel spell slots and prepared spells."}]},saves:["int","wis"],subclasses:[{id:"evocation",name:"School of Evocation",unlockLevel:2,grants:{subactions:["Sculpt Spells"]}}]},{id:"warlock",name:"Warlock",hitDie:8,armor:["light"],weapons:["simple"],grants:{subactions:["Cast Spell"]},featuresByLevel:{1:[{name:"Otherworldly Patron",text:"Form a pact with a powerful entity and gain patron features."},{name:"Pact Magic",text:"CHAbased spellcasting using pact slots; Eldritch Blast cantrip available."}],2:[{name:"Eldritch Invocations",text:"Learn special invocations to augment abilities."}],3:[{name:"Pact Boon",text:"Choose Chain, Blade, or Tome (not modeled in this demo)."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}]},saves:["wis","cha"],subclasses:[{id:"fiend",name:"The Fiend",unlockLevel:1},{id:"archfey",name:"The Archfey",unlockLevel:1},{id:"great-old-one",name:"The Great Old One",unlockLevel:1}]},{id:"sorcerer",name:"Sorcerer",hitDie:6,armor:[],weapons:["daggers","quarterstaff","light-crossbow"],grants:{subactions:["Cast Spell"]},featuresByLevel:{1:[{name:"Sorcerous Origin",text:"Choose a bloodline that grants innate magic."},{name:"Spellcasting",text:"CHAbased flexible spellcasting. Cantrips & 1stlevel slots."}],2:[{name:"Font of Magic",text:"Sorcery Points fuel metamagic and spell slot conversions."}],3:[{name:"Metamagic",text:"Alter spells using metamagic options."}],4:[{name:"Ability Score Improvement",text:"+2 to one ability or +1 to two abilities (demo text)."}]},saves:["con","cha"],subclasses:[{id:"draconic-bloodline",name:"Draconic Bloodline",unlockLevel:1},{id:"wild-magic",name:"Wild Magic",unlockLevel:1}]}],ai=[{id:"greataxe",name:"Greataxe",type:"weapon",group:"martial",hands:2,dmg:"1d12 slashing",tags:["weapon","heavy","twohanded"],grants:["Melee Attack (Greataxe)"]},{id:"greatsword",name:"Greatsword",type:"weapon",group:"martial",hands:2,dmg:"2d6 slashing",tags:["weapon","heavy","twohanded"],grants:["Melee Attack (Greatsword)"]},{id:"longsword",name:"Longsword",type:"weapon",group:"martial",hands:1,dmg:"1d8 slashing",tags:["weapon","versatile"],grants:["Melee Attack (Longsword)"]},{id:"rapier",name:"Rapier",type:"weapon",group:"martial",hands:1,dmg:"1d8 piercing",tags:["weapon","finesse"],grants:["Melee Attack (Rapier)"]},{id:"shortsword",name:"Shortsword",type:"weapon",group:"martial",hands:1,dmg:"1d6 piercing",tags:["weapon","finesse","light"],grants:["Melee Attack (Shortsword)"]},{id:"warhammer",name:"Warhammer",type:"weapon",group:"martial",hands:1,dmg:"1d8 bludgeoning",tags:["weapon","versatile"],grants:["Melee Attack (Warhammer)"]},{id:"mace",name:"Mace",type:"weapon",group:"simple",hands:1,dmg:"1d6 bludgeoning",tags:["weapon","simple"],grants:["Melee Attack (Mace)"]},{id:"handaxe",name:"Handaxe",type:"weapon",group:"simple",hands:1,dmg:"1d6 slashing",tags:["weapon","simple","light","thrown"],grants:["Melee Attack (Handaxe)","Ranged Attack (Handaxe)"]},{id:"dagger",name:"Dagger",type:"weapon",group:"simple",hands:1,dmg:"1d4 piercing",tags:["weapon","simple","light","finesse","thrown"],grants:["Melee Attack (Dagger)","Ranged Attack (Dagger)"]},{id:"spear",name:"Spear",type:"weapon",group:"simple",hands:1,dmg:"1d6 piercing",tags:["weapon","simple","thrown","versatile"],grants:["Melee Attack (Spear)","Ranged Attack (Spear)"]},{id:"longbow",name:"Longbow",type:"weapon",group:"martial",hands:2,dmg:"1d8 piercing",tags:["weapon","heavy","twohanded","ranged"],grants:["Ranged Attack (Longbow)"]},{id:"shortbow",name:"Shortbow",type:"weapon",group:"simple",hands:2,dmg:"1d6 piercing",tags:["weapon","twohanded","ranged"],grants:["Ranged Attack (Shortbow)"]},{id:"light-crossbow",name:"Light Crossbow",type:"weapon",group:"simple",hands:2,dmg:"1d8 piercing",tags:["weapon","twohanded","ranged","loading"],grants:["Ranged Attack (Light Crossbow)"]},{id:"heavy-crossbow",name:"Heavy Crossbow",type:"weapon",group:"martial",hands:2,dmg:"1d10 piercing",tags:["weapon","heavy","twohanded","ranged","loading"],grants:["Ranged Attack (Heavy Crossbow)"]},{id:"shield",name:"Shield",type:"shield",ac:2,hands:1,tags:["shield"],grants:["Raise Shield"]},{id:"padded",name:"Padded Armor",type:"armor",ac:11,dexMax:Number.POSITIVE_INFINITY,tags:["armor","light"]},{id:"leather",name:"Leather Armor",type:"armor",ac:11,dexMax:Number.POSITIVE_INFINITY,tags:["armor","light"]},{id:"studded-leather",name:"Studded Leather",type:"armor",ac:12,dexMax:Number.POSITIVE_INFINITY,tags:["armor","light"]},{id:"scale-mail",name:"Scale Mail",type:"armor",ac:14,dexMax:2,tags:["armor","medium"]},{id:"breastplate",name:"Breastplate",type:"armor",ac:14,dexMax:2,tags:["armor","medium"]},{id:"half-plate",name:"Half Plate",type:"armor",ac:15,dexMax:2,tags:["armor","medium"]},{id:"chain",name:"Chain Mail",type:"armor",ac:16,dexMax:0,reqStr:13,tags:["armor","heavy"]},{id:"splint",name:"Splint Armor",type:"armor",ac:17,dexMax:0,reqStr:15,tags:["armor","heavy"]},{id:"plate",name:"Plate Armor",type:"armor",ac:18,dexMax:0,reqStr:15,tags:["armor","heavy"]}],lm={greataxe:["Melee Attack (Greataxe)"],greatsword:["Melee Attack (Greatsword)"],longsword:["Melee Attack (Longsword)"],rapier:["Melee Attack (Rapier)"],shortsword:["Melee Attack (Shortsword)"],warhammer:["Melee Attack (Warhammer)"],mace:["Melee Attack (Mace)"],handaxe:["Melee Attack (Handaxe)","Ranged Attack (Handaxe)"],dagger:["Melee Attack (Dagger)","Ranged Attack (Dagger)"],spear:["Melee Attack (Spear)","Ranged Attack (Spear)"],longbow:["Ranged Attack (Longbow)"],shortbow:["Ranged Attack (Shortbow)"],"light-crossbow":["Ranged Attack (Light Crossbow)"],"heavy-crossbow":["Ranged Attack (Heavy Crossbow)"],shield:["Raise Shield"]},Kt=[{id:"acrobatics",name:"Acrobatics",ability:"dex"},{id:"animal",name:"Animal Handling",ability:"wis"},{id:"arcana",name:"Arcana",ability:"int"},{id:"athletics",name:"Athletics",ability:"str"},{id:"deception",name:"Deception",ability:"cha"},{id:"history",name:"History",ability:"int"},{id:"insight",name:"Insight",ability:"wis"},{id:"intimidation",name:"Intimidation",ability:"cha"},{id:"investigation",name:"Investigation",ability:"int"},{id:"medicine",name:"Medicine",ability:"wis"},{id:"nature",name:"Nature",ability:"int"},{id:"perception",name:"Perception",ability:"wis"},{id:"performance",name:"Performance",ability:"cha"},{id:"persuasion",name:"Persuasion",ability:"cha"},{id:"religion",name:"Religion",ability:"int"},{id:"sleight",name:"Sleight of Hand",ability:"dex"},{id:"stealth",name:"Stealth",ability:"dex"},{id:"survival",name:"Survival",ability:"wis"}],Il={keen:["perception"],menacing:["intimidation"]},ks={barbarian:{count:2,options:["animal","athletics","intimidation","nature","perception","survival"]},bard:{count:3,options:["acrobatics","animal","arcana","athletics","deception","history","insight","intimidation","investigation","medicine","nature","perception","performance","persuasion","religion","sleight","stealth","survival"]},cleric:{count:2,options:["history","insight","medicine","persuasion","religion"]},druid:{count:2,options:["arcana","animal","insight","medicine","nature","perception","religion","survival"]},fighter:{count:2,options:["acrobatics","animal","athletics","history","insight","intimidation","perception","survival"]},monk:{count:2,options:["acrobatics","athletics","history","insight","religion","stealth"]},paladin:{count:2,options:["athletics","insight","intimidation","medicine","persuasion","religion"]},ranger:{count:3,options:["animal","athletics","insight","investigation","nature","perception","stealth","survival"]},rogue:{count:4,options:["acrobatics","athletics","deception","insight","intimidation","investigation","perception","performance","persuasion","sleight","stealth"]},sorcerer:{count:2,options:["arcana","deception","insight","intimidation","persuasion","religion"]},warlock:{count:2,options:["arcana","deception","history","intimidation","investigation","nature","religion"]},wizard:{count:2,options:["arcana","history","insight","investigation","medicine","religion"]}},ci={fighter:[{id:"fighting-style",name:"Fighting Style",level:1,picks:1,options:[{id:"archery",name:"Archery",text:"+2 to attack rolls with ranged weapons."},{id:"defense",name:"Defense",text:"+1 AC while wearing armor."},{id:"dueling",name:"Dueling",text:"+2 damage when wielding a single onehanded weapon."},{id:"great-weapon",name:"Great Weapon Fighting",text:"Reroll 1s and 2s on damage dice with twohanded weapons."},{id:"protection",name:"Protection",text:"Use a shield to impose disadvantage on an attack (reaction)."},{id:"two-weapon",name:"TwoWeapon Fighting",text:"Add ability mod to offhand damage with twoweapon fighting."}]}],paladin:[{id:"fighting-style",name:"Fighting Style",level:2,picks:1,options:[{id:"defense",name:"Defense",text:"+1 AC while wearing armor."},{id:"dueling",name:"Dueling",text:"+2 damage when wielding a single onehanded weapon."},{id:"great-weapon",name:"Great Weapon Fighting",text:"Reroll 1s and 2s on damage dice with twohanded weapons."},{id:"protection",name:"Protection",text:"Use a shield to impose disadvantage on an attack (reaction)."}]},{id:"sacred-oath",name:"Sacred Oath",level:3,picks:1,options:[{id:"oath-devotion",name:"Oath of Devotion",text:"Channel Divinity options: Sacred Weapon, Turn the Unholy."},{id:"oath-vengeance",name:"Oath of Vengeance",text:"Channel Divinity options: Abjure Enemy, Vow of Enmity."}]}],cleric:[{id:"divine-domain",name:"Divine Domain",level:1,picks:1,options:[{id:"life-domain",name:"Life Domain",text:"Healerfocused domain; Channel Divinity: Preserve Life."},{id:"light-domain",name:"Light Domain",text:"Radiant/Fire domain; Channel Divinity: Radiance of the Dawn."}]}],druid:[{id:"druid-circle",name:"Druid Circle",level:2,picks:1,options:[{id:"circle-land",name:"Circle of the Land",text:"Bonus spells and recovery tied to the land."},{id:"circle-moon",name:"Circle of the Moon",text:"Combatfocused Wild Shape improvements."}]}],bard:[{id:"bard-college",name:"Bard College",level:3,picks:1,options:[{id:"college-of-lore",name:"College of Lore",text:"Additional magical secrets and skills."},{id:"college-of-valor",name:"College of Valor",text:"Martial training with medium armor, shields, and martial weapons."}]},{id:"expertise",name:"Expertise",level:3,picks:2,options:[{id:"acrobatics",name:"Acrobatics",text:"Double proficiency in Acrobatics."},{id:"animal",name:"Animal Handling",text:"Double proficiency in Animal Handling."},{id:"arcana",name:"Arcana",text:"Double proficiency in Arcana."},{id:"athletics",name:"Athletics",text:"Double proficiency in Athletics."},{id:"deception",name:"Deception",text:"Double proficiency in Deception."},{id:"history",name:"History",text:"Double proficiency in History."},{id:"insight",name:"Insight",text:"Double proficiency in Insight."},{id:"intimidation",name:"Intimidation",text:"Double proficiency in Intimidation."},{id:"investigation",name:"Investigation",text:"Double proficiency in Investigation."},{id:"medicine",name:"Medicine",text:"Double proficiency in Medicine."},{id:"nature",name:"Nature",text:"Double proficiency in Nature."},{id:"perception",name:"Perception",text:"Double proficiency in Perception."},{id:"performance",name:"Performance",text:"Double proficiency in Performance."},{id:"persuasion",name:"Persuasion",text:"Double proficiency in Persuasion."},{id:"religion",name:"Religion",text:"Double proficiency in Religion."},{id:"sleight",name:"Sleight of Hand",text:"Double proficiency in Sleight of Hand."},{id:"stealth",name:"Stealth",text:"Double proficiency in Stealth."},{id:"survival",name:"Survival",text:"Double proficiency in Survival."}]}],monk:[{id:"monastic-tradition",name:"Monastic Tradition",level:3,picks:1,options:[{id:"open-hand",name:"Way of the Open Hand",text:"Enhance Flurry of Blows with additional effects."},{id:"shadow",name:"Way of Shadow",text:"Kipowered stealth and shadow arts."}]}],warlock:[{id:"otherworldly-patron",name:"Otherworldly Patron",level:1,picks:1,options:[{id:"fiend",name:"The Fiend",text:"Dark bargains grant destructive power."},{id:"archfey",name:"The Archfey",text:"Fey patrons grant beguiling and trickster magic."},{id:"great-old-one",name:"The Great Old One",text:"Alien entities gift telepathy and mindbending magic."}]},{id:"eldritch-invocations",name:"Eldritch Invocations",level:2,picks:2,options:[{id:"agonizing-blast",name:"Agonizing Blast",text:"Add CHA to Eldritch Blast damage (demo note)."},{id:"repelling-blast",name:"Repelling Blast",text:"Push creatures hit by Eldritch Blast (demo note)."},{id:"devil-sight",name:"Devils Sight",text:"See normally in magical darkness (demo note)."},{id:"armor-of-shadows",name:"Armor of Shadows",text:"Cast Mage Armor at will (demo note)."}]}],sorcerer:[{id:"sorcerous-origin",name:"Sorcerous Origin",level:1,picks:1,options:[{id:"draconic-bloodline",name:"Draconic Bloodline",text:"Innate draconic magic strengthens body and spells."},{id:"wild-magic",name:"Wild Magic",text:"Unpredictable surges of magic can occur when casting."}]},{id:"metamagic",name:"Metamagic",level:3,picks:2,options:[{id:"quickened-spell",name:"Quickened Spell",text:"Cast a spell as a bonus action (demo note)."},{id:"twinned-spell",name:"Twinned Spell",text:"Target a second creature with a single-target spell (demo note)."},{id:"subtle-spell",name:"Subtle Spell",text:"Cast without verbal or somatic components (demo note)."},{id:"careful-spell",name:"Careful Spell",text:"Protect allies from your spells effects (demo note)."}]}],ranger:[{id:"fighting-style",name:"Fighting Style",level:2,picks:1,options:[{id:"archery",name:"Archery",text:"+2 to attack rolls with ranged weapons."},{id:"defense",name:"Defense",text:"+1 AC while wearing armor."},{id:"dueling",name:"Dueling",text:"+2 damage when wielding a single onehanded weapon."},{id:"two-weapon",name:"TwoWeapon Fighting",text:"Add ability mod to offhand damage with twoweapon fighting."}]},{id:"ranger-archetype",name:"Ranger Archetype",level:3,picks:1,options:[{id:"hunter",name:"Hunter",text:"Gain defensive and offensive options tailored to hunting prey."},{id:"beast-master",name:"Beast Master",text:"Bond with a beast companion that fights alongside you."}]}],rogue:[{id:"expertise",name:"Expertise",level:1,picks:2,options:[{id:"acrobatics",name:"Acrobatics",text:"Double proficiency in Acrobatics."},{id:"animal",name:"Animal Handling",text:"Double proficiency in Animal Handling."},{id:"arcana",name:"Arcana",text:"Double proficiency in Arcana."},{id:"athletics",name:"Athletics",text:"Double proficiency in Athletics."},{id:"deception",name:"Deception",text:"Double proficiency in Deception."},{id:"history",name:"History",text:"Double proficiency in History."},{id:"insight",name:"Insight",text:"Double proficiency in Insight."},{id:"intimidation",name:"Intimidation",text:"Double proficiency in Intimidation."},{id:"investigation",name:"Investigation",text:"Double proficiency in Investigation."},{id:"medicine",name:"Medicine",text:"Double proficiency in Medicine."},{id:"nature",name:"Nature",text:"Double proficiency in Nature."},{id:"perception",name:"Perception",text:"Double proficiency in Perception."},{id:"performance",name:"Performance",text:"Double proficiency in Performance."},{id:"persuasion",name:"Persuasion",text:"Double proficiency in Persuasion."},{id:"religion",name:"Religion",text:"Double proficiency in Religion."},{id:"sleight",name:"Sleight of Hand",text:"Double proficiency in Sleight of Hand."},{id:"stealth",name:"Stealth",text:"Double proficiency in Stealth."},{id:"survival",name:"Survival",text:"Double proficiency in Survival."}]},{id:"roguish-archetype",name:"Roguish Archetype",level:3,picks:1,options:[{id:"thief",name:"Thief",text:"Fast Hands and Second-Story Work (demo note)."},{id:"assassin",name:"Assassin",text:"Bonus to disguises/poisons; devastating ambushes (demo note)."},{id:"arcane-trickster",name:"Arcane Trickster",text:"Learn minor spells from the wizard list (demo note)."}]}]},Va=[{id:"soldier",name:"Soldier",skills:["athletics","intimidation"],tools:["gaming set","vehicles (land)"],feature:{name:"Military Rank",text:"You have a military rank and can exert influence."}},{id:"acolyte",name:"Acolyte",skills:["insight","religion"],languages:2,feature:{name:"Shelter of the Faithful",text:"You command respect from those who share your faith."}},{id:"criminal",name:"Criminal",skills:["deception","stealth"],tools:["thieves tools","gaming set"],feature:{name:"Criminal Contact",text:"You have a reliable and trustworthy contact."}},{id:"sage",name:"Sage",skills:["arcana","history"],languages:2,feature:{name:"Researcher",text:"You can find information with ease in libraries and archives."}},{id:"folk-hero",name:"Folk Hero",skills:["animal","survival"],tools:["artisans tools","vehicles (land)"],feature:{name:"Rustic Hospitality",text:"You fit in among common folk and can find shelter among them."}},{id:"urchin",name:"Urchin",skills:["sleight","stealth"],tools:["disguise kit","thieves tools"],feature:{name:"City Secrets",text:"You know the secret patterns and flow to cities and can find passages through the urban sprawl."}},{id:"noble",name:"Noble",skills:["history","persuasion"],tools:["gaming set"],languages:1,feature:{name:"Position of Privilege",text:"People are inclined to think the best of you. You are welcome in high society."}},{id:"outlander",name:"Outlander",skills:["athletics","survival"],tools:["musical instrument"],feature:{name:"Wanderer",text:"You have an excellent memory for maps and geography; you can find food and fresh water for yourself and up to five others each day."}},{id:"sailor",name:"Sailor",skills:["athletics","perception"],tools:["navigator's tools","vehicles (water)"],feature:{name:"Ship's Passage",text:"You can secure free passage on a sailing ship for yourself and your companions."}}],Kf=[{id:"vicious-mockery",name:"Vicious Mockery",level:0,classes:["bard"],text:"Insult a creature; it takes psychic damage and has disadvantage on next attack."},{id:"prestidigitation",name:"Prestidigitation",level:0,classes:["bard","wizard"],text:"Minor magical tricks and sensory effects."},{id:"mage-hand",name:"Mage Hand",level:0,classes:["bard","wizard"],text:"Create a spectral hand to manipulate objects."},{id:"friends",name:"Friends",level:0,classes:["bard"],text:"Gain advantage on CHA checks directed at one creature."},{id:"produce-flame",name:"Produce Flame",level:0,classes:["druid"],text:"Conjure a flame in your hand; shed light and can hurl for fire damage."},{id:"shillelagh",name:"Shillelagh",level:0,classes:["druid"],text:"Imbue a club or quarterstaff; use WIS for attack/damage."},{id:"thorn-whip",name:"Thorn Whip",level:0,classes:["druid"],text:"Create a vine whip; pull a creature closer on a hit."},{id:"guidance",name:"Guidance",level:0,classes:["cleric"],text:"Add 1d4 to one ability check."},{id:"sacred-flame",name:"Sacred Flame",level:0,classes:["cleric"],text:"Radiant fire descends on a creature; DEX save for no damage."},{id:"thaumaturgy",name:"Thaumaturgy",level:0,classes:["cleric"],text:"Manifest minor wonders to show divine power."},{id:"spare-the-dying",name:"Spare the Dying",level:0,classes:["cleric"],text:"Stabilize a creature at 0 HP."},{id:"fire-bolt",name:"Fire Bolt",level:0,classes:["wizard"],text:"Ranged spell attack for fire damage."},{id:"ray-of-frost",name:"Ray of Frost",level:0,classes:["wizard"],text:"Ray of cold that slows the target."},{id:"eldritch-blast",name:"Eldritch Blast",level:0,classes:["warlock"],text:"Ranged spell attack dealing force damage."},{id:"healing-word",name:"Healing Word",level:1,classes:["bard","cleric"],text:"Bonus action healing at range."},{id:"tashas-hideous-laughter",name:"Tasha's Hideous Laughter",level:1,classes:["bard"],text:"A creature falls prone with laughter; WIS save ends."},{id:"dissonant-whispers",name:"Dissonant Whispers",level:1,classes:["bard"],text:"Psychic damage; target may flee immediately."},{id:"faerie-fire",name:"Faerie Fire",level:1,classes:["bard"],text:"Outline creatures; attacks against them have advantage."},{id:"charm-person",name:"Charm Person",level:1,classes:["bard","wizard"],text:"Attempt to charm a humanoid."},{id:"cure-wounds",name:"Cure Wounds",level:1,classes:["cleric"],text:"Touch-based healing."},{id:"bless",name:"Bless",level:1,classes:["cleric"],text:"Add 1d4 to allies attack rolls and saves."},{id:"guiding-bolt",name:"Guiding Bolt",level:1,classes:["cleric"],text:"Radiant damage and advantage for next attack against target."},{id:"sanctuary",name:"Sanctuary",level:1,classes:["cleric"],text:"Ward a creature against attack; attackers must make a save."},{id:"entangle",name:"Entangle",level:1,classes:["druid"],text:"Grasping weeds restrain creatures in a 20foot square."},{id:"goodberry",name:"Goodberry",level:1,classes:["druid"],text:"Create ten berries that heal when eaten."},{id:"hunters-mark",name:"Hunter's Mark",level:1,classes:["ranger"],text:"Mark a target to deal extra damage and track it more easily."},{id:"ensnaring-strike",name:"Ensnaring Strike",level:1,classes:["ranger"],text:"Vines spring forth to restrain the target on a hit."},{id:"compelled-duel",name:"Compelled Duel",level:1,classes:["paladin"],text:"Compel a creature to duel you; disadvantage to attack others."},{id:"divine-favor",name:"Divine Favor",level:1,classes:["paladin"],text:"Your weapon attacks deal +1d4 radiant damage."},{id:"shield-of-faith",name:"Shield of Faith",level:1,classes:["paladin"],text:"A shimmering field grants +2 AC for duration."},{id:"magic-missile",name:"Magic Missile",level:1,classes:["wizard"],text:"Automatically hits with force darts."},{id:"shield-spell",name:"Shield",level:1,classes:["wizard"],text:"+5 AC as a reaction until your next turn."},{id:"mage-armor",name:"Mage Armor",level:1,classes:["wizard"],text:"Protective magical force; set AC when unarmored."},{id:"sleep",name:"Sleep",level:1,classes:["wizard"],text:"Magically send creatures into slumber."},{id:"hex",name:"Hex",level:1,classes:["warlock"],text:"Curse a creature; deal extra damage and disadvantage on checks."},{id:"armor-of-agathys",name:"Armor of Agathys",level:1,classes:["warlock"],text:"Gain temporary HP and deal cold damage to attackers."}];function Nt(e){return Math.floor((e-10)/2)}function $n(e,t,n){return Math.max(t,Math.min(n,e))}function Is(e){return Array.from(new Set(e))}function iu(e){return e>=17?6:e>=13?5:e>=9?4:e>=5?3:2}function i1(e){return typeof e.hands=="number"?e.hands:0}function s1(e){const t=[],n=e.loadout.some(a=>a.type==="shield"),r=e.loadout.find(a=>a.type==="armor"),i=e.loadout.reduce((a,c)=>a+i1(c),0),s=e.loadout.find(a=>{var c;return(c=a.tags)==null?void 0:c.includes("twohanded")}),o=Tn(e.abilities,e.race,e.asi);return s&&n&&t.push({level:"error",msg:"Twohanded weapon cannot be used with a shield equipped."}),(r==null?void 0:r.id)==="chain"&&(o.str||10)<13&&t.push({level:"warn",msg:"Chain Mail requires STR 13 for optimal use (speed penalties otherwise)."}),e.classes.some(a=>a.klass.id==="wizard")&&r&&t.push({level:"warn",msg:"Wizards are not proficient with armor by default (toy rule)."}),e.classes.some(a=>a.klass.id==="barbarian")&&!r&&t.push({level:"hint",msg:"Unarmored Defense active: AC = 10 + DEX + CON. Shield allowed."}),i>2&&t.push({level:"error",msg:"You cannot hold more than two hands worth of equipment."}),t}function su(e){var C,A;const t=Tn(e.abilities,e.race,e.asi),n=Nt(t.dex),r=Nt(t.con),i=Nt(t.str),s=e.loadout.find(D=>D.type==="armor"),o=e.loadout.find(D=>D.type==="shield"),a=Math.max(1,e.classes.reduce((D,R)=>D+(R.level||0),0)||1);let c=10+n;if(s){const D=typeof s.dexMax=="number"?s.dexMax:1/0;c=s.ac+$n(n,-1/0,D)}!s&&e.classes.some(D=>D.klass.id==="barbarian")&&(c=10+n+r),o&&(c+=o.ac??2);let f=(((C=e.classes[0])==null?void 0:C.klass.hitDie)??8)+r;e.classes.forEach((D,R)=>{const P=Math.max(1,Math.floor(D.klass.hitDie/2)+1+r),F=Math.max(0,(D.level||0)-(R===0?1:0));f+=F*P}),(e.feats||[]).includes("tough")&&(f+=2*a);const h=((A=e.race)==null?void 0:A.speed)??30,g=e.classes.flatMap(D=>{var R;return((R=D.klass.grants)==null?void 0:R.subactions)??[]}),m=e.classes.flatMap(D=>{var R,P;return((P=(R=D.subclass)==null?void 0:R.grants)==null?void 0:P.subactions)??[]}),S=e.loadout.flatMap(D=>lm[D.id]??[]),w=Is([...g,...m,...S]),N=Tn(e.abilities,e.race,e.asi),d=iu(a),p=Is(e.classes.flatMap(D=>D.klass.saves??[])),x={str:Nt(N.str)+(p.includes("str")?d:0),dex:Nt(N.dex)+(p.includes("dex")?d:0),con:Nt(N.con)+(p.includes("con")?d:0),int:Nt(N.int)+(p.includes("int")?d:0),wis:Nt(N.wis)+(p.includes("wis")?d:0),cha:Nt(N.cha)+(p.includes("cha")?d:0)},y=n+((e.feats||[]).includes("alert")?5:0);return{ac:c,hp:f,speed:h,subactions:w,dexMod:n,conMod:r,strMod:i,saves:x,totalLevel:a,initiative:y}}function o1(e){const{subactions:t,strMod:n,dexMod:r,conMod:i}=su(e),s=(t.includes("Melee Attack (Greataxe)")?.6:0)+(t.includes("Ranged Attack (Longbow)")?.5:0)+Math.max(n,r)*.15,o=su(e).ac*.03+i*.4,a=(t.includes("Rage")?.5:0)+(t.includes("Second Wind")?.4:0)+(t.includes("Cast Spell")?.4:0),c=$n(Math.round((s+o+a)*100)/100,0,10);return{offense:s,defense:o,economy:a,readiness:c}}function mn(e){return l.jsxs("div",{style:{display:"grid",gap:6,alignContent:"start",justifyItems:"start"},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b",letterSpacing:.3,textTransform:"uppercase"},children:e.label}),e.children]})}function Ft(e){return l.jsx("span",{style:{padding:"2px 8px",borderRadius:999,background:"#f1f5f9",color:"#0f172a",fontSize:12,whiteSpace:"nowrap"},children:e.children})}function be(e){const{variant:t="default",size:n="md",style:r,...i}=e,s={borderRadius:8,border:"1px solid #cbd5e1",background:t==="default"?"#0ea5e9":"white",color:t==="default"?"white":"#0f172a",cursor:"pointer",whiteSpace:"nowrap"};return t==="outline"&&(s.background="white"),t==="ghost"&&(s.background="transparent",s.border="1px solid transparent"),n==="sm"?(s.padding="6px 10px",s.fontSize=12):n==="icon"?s.padding=6:s.padding="8px 12px",l.jsx("button",{...i,style:{...s,...r}})}function am({value:e}){return l.jsx("div",{style:{width:"100%",height:10,borderRadius:999,background:"#e2e8f0"},children:l.jsx("div",{style:{width:`${$n(e,0,100)}%`,height:"100%",borderRadius:999,background:"#0ea5e9"}})})}function Dn(e){return l.jsx("section",{style:a1,children:e.children})}function Mn(e){return l.jsx("div",{style:{padding:"14px 16px",borderBottom:"1px solid #e2e8f0"},children:e.children})}function zn(e){return l.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,fontWeight:700,fontSize:15},children:e.children})}function Rn(e){return l.jsx("div",{style:{padding:16,display:"grid",gap:12},children:e.children})}const Ya={width:"100%",padding:"8px 10px",borderRadius:8,border:"1px solid #cbd5e1"},l1={padding:"2px 8px",borderRadius:999,background:"#f1f5f9",border:"1px solid #e2e8f0",fontSize:12},a1={border:"1px solid #e2e8f0",borderRadius:12,background:"white",boxShadow:"0 2px 8px rgba(15,23,42,0.05)"};function c1(e){const[t,n]=k.useState("power"),[r,i]=k.useState("New Hero"),[s,o]=k.useState(Xt[0]),[a,c]=k.useState([{klass:Fr[0],level:1}]),[u,f]=k.useState({str:15,dex:14,con:14,int:10,wis:10,cha:8}),[h,g]=k.useState([ai[0],ai[1]]),[m,S]=k.useState(Va[0]),[w,N]=k.useState({}),[d,p]=k.useState("ability"),[x,y]=k.useState("grid"),[C,A]=k.useState({}),[D,R]=k.useState("list"),[P,F]=k.useState({}),[G,J]=k.useState([]),[B,v]=k.useState([]),[j,E]=k.useState({}),[L,_]=k.useState(!0),[b,M]=k.useState([]),[W,H]=k.useState([]),[re,oe]=k.useState(""),[ge,we]=k.useState([]),[z,ie]=k.useState(!1),le=k.useMemo(()=>Is(ai.flatMap(T=>T.tags||[])),[]),he=k.useMemo(()=>{const T=re.trim().toLowerCase();return ai.filter(X=>{const pe=X.tags||[],ue=T?X.name.toLowerCase().includes(T):!0,De=ge.length?ge.every(Re=>pe.includes(Re)):!0;return ue&&De})},[re,ge]),Te=T=>we(X=>X.includes(T)?X.filter(pe=>pe!==T):[...X,T]),[Q,Ae]=k.useState({}),[ve,Se]=k.useState({}),[Ve,Qe]=k.useState({str:0,dex:0,con:0,int:0,wis:0,cha:0}),[me,st]=k.useState([]),[I,Y]=k.useState({}),[U,O]=k.useState(null),[ee,q]=k.useState(null),fe={name:r,race:s,classes:a,abilities:u,loadout:h,background:m,spells:{known:Q,prepared:ve},asi:Ve,feats:me,featChoices:I},Z=k.useMemo(()=>su(fe),[fe]);k.useMemo(()=>s1(fe),[fe]);const ae=k.useMemo(()=>o1(fe),[fe]),de=k.useMemo(()=>a.filter(T=>{const X=T.klass.subclasses||[];return X.length?X.filter(ue=>T.level>=ue.unlockLevel).length>0&&!T.subclass:!1}),[a]);function Ue(T,X){c(pe=>pe.map(ue=>ue.klass.id===T?{...ue,subclass:X}:ue))}k.useEffect(()=>{c(T=>{let X=!1;const pe=T.map(ue=>{var Be;const Re=(ci[ue.klass.id]||[]).find($=>$.name==="Divine Domain"||$.name==="Bard College"||$.name==="Otherworldly Patron"||$.name==="Sorcerous Origin"||$.name==="Ranger Archetype"||$.name==="Roguish Archetype");if(!Re||(ue.level||0)<Re.level)return ue;const Pe=(Be=j[ue.klass.id])==null?void 0:Be[Re.id],Ie=Array.isArray(Pe)?Pe[0]:Pe;if(!Ie)return ue;const et=(ue.klass.subclasses||[]).find($=>$.id===Ie);return et&&(!ue.subclass||ue.subclass.id!==et.id)?(X=!0,{...ue,subclass:et}):ue});return X?pe:T})},[j]),k.useEffect(()=>{const T=(m==null?void 0:m.skills)??[],X=((s==null?void 0:s.traits)||[]).flatMap(Re=>Il[Re.id]||[]),pe=new Set(T),ue=new Set(X);T.filter(Re=>!(C[Re]||[]).includes("bg")),X.filter(Re=>!(C[Re]||[]).includes("race"));let De={};A(Re=>{const Pe={};return Object.entries(Re).forEach(([Ie,et])=>{const Be=et.filter($=>$==="bg"?pe.has(Ie):$==="race"?ue.has(Ie):!0);Be.length&&(Pe[Ie]=Be)}),T.forEach(Ie=>{Pe[Ie]=Array.from(new Set([...Pe[Ie]||[],"bg"]))}),X.forEach(Ie=>{Pe[Ie]=Array.from(new Set([...Pe[Ie]||[],"race"]))}),De=Pe,Pe}),N(Re=>{const Pe={};return Object.keys(De).forEach(Ie=>{Pe[Ie]=Re[Ie]&&Re[Ie]!=="none"?Re[Ie]:"prof"}),Pe})},[m,s,C]);function te(T,X){A(pe=>{const ue=pe[T]||[];return ue.includes(X)?pe:{...pe,[T]:[...ue,X]}}),N(pe=>({...pe,[T]:pe[T]&&pe[T]!=="none"?pe[T]:"prof"}))}function Ce(T,X){let pe=!0;A(ue=>{const De=ue[T]||[];if(!De.includes(X))return ue;const Re=De.filter(Ie=>Ie!==X);pe=Re.length>0;const Pe={...ue};return Re.length?Pe[T]=Re:delete Pe[T],Pe}),N(ue=>{if(pe)return ue;const De={...ue};return delete De[T],De})}k.useEffect(()=>{var T;(T=e.onCharacterChange)==null||T.call(e,fe,Z)},[r,s,JSON.stringify(a),JSON.stringify(u),JSON.stringify(h),JSON.stringify(m),Z]);function Le(T){const X=Xt.find($=>$.name===T.race)||s,pe=Va.find($=>$.name===T.background)||m,ue=Array.isArray(T.levels)?T.levels:[],De={};ue.forEach($=>{const se=String($.className||"").trim();se&&(De[se]=(De[se]||0)+1)});const Re=[];Object.entries(De).forEach(([$,se])=>{const ye=Fr.find(K=>K.name===$);ye&&Re.push({klass:ye,level:se})}),Re.length||Re.push({klass:Fr[0],level:1});const Pe=[];ue.forEach($=>{(Array.isArray($.feats)?$.feats:[]).forEach(ye=>{if(ye&&typeof ye=="string"){const K=li.find(ce=>ce.id===ye||ce.name.toLowerCase()===ye.toLowerCase());Pe.push(K?K.id:ye)}})});const Ie={},et={};return ue.slice().sort(($,se)=>(Number($.level)||0)-(Number(se.level)||0)).forEach($=>{const se=Array.isArray($.featureChoices)?$.featureChoices:[];if(!se.length)return;const ye=Fr.find(ce=>ce.name===$.className),K=ye==null?void 0:ye.id;se.forEach(ce=>{var xe;if(!(!ce||!K)){if(ce.kind==="fighting-style"){const Me=(ci[K]||[]).find(ze=>ze.id==="fighting-style"),He=String(ce.style||"").trim().toLowerCase();if(Me&&He){const ze=Me.options.find(Fe=>Fe.id===He||Fe.name.toLowerCase()===He);if(ze){const Fe=(xe=Ie[K])==null?void 0:xe[Me.id];if((Me.picks||1)>1){const Ee=Array.isArray(Fe)?Fe:Fe?[Fe]:[],Ye=Array.from(new Set([...Ee,ze.id]));Ie[K]={...Ie[K]||{},[Me.id]:Ye}}else Ie[K]={...Ie[K]||{},[Me.id]:ze.id}}}}else if(ce.kind==="subclass"){const Me=(ci[K]||[]).find(ze=>["sacred-oath","divine-domain","bard-college","monastic-tradition","druid-circle","roguish-archetype","ranger-archetype","sorcerous-origin","otherworldly-patron"].includes(ze.id)),He=String(ce.subclass||"").trim().toLowerCase();if(Me&&He){const ze=Me.options.find(Fe=>Fe.id===He||Fe.name.toLowerCase()===He||Fe.name.toLowerCase().includes(He));ze&&(Ie[K]={...Ie[K]||{},[Me.id]:ze.id})}}else if(ce.kind==="skill-proficiency"){const $e=Array.isArray(ce.skills)?ce.skills:[],Me=et[K]||[];$e.forEach(He=>{const ze=Kt.find(Fe=>Fe.name.toLowerCase()===String(He).toLowerCase()||Fe.id===String(He).toLowerCase());ze&&!Me.includes(ze.id)&&Me.push(ze.id)}),et[K]=Me}}})}),{nextRace:X,nextBg:pe,nextClasses:Re,nextFeats:Pe,nextCfc:Ie,nextClassSkillPicks:et}}function Oe(T){const X={};return T.forEach(ue=>{X[ue.klass.name]=(X[ue.klass.name]||0)+(ue.level||0)}),Object.entries(X).sort((ue,De)=>ue[0].localeCompare(De[0])).map(([ue,De])=>`${ue} x${De}`).join(", ")||"(none)"}function je(T){var $,se,ye,K;const X=[];(($=T.nextRace)==null?void 0:$.id)!==(s==null?void 0:s.id)&&X.push({key:"race",label:"Race",before:(s==null?void 0:s.name)||"(none)",after:((se=T.nextRace)==null?void 0:se.name)||"(none)"}),(((ye=T.nextBg)==null?void 0:ye.id)||null)!==((m==null?void 0:m.id)||null)&&X.push({key:"background",label:"Background",before:(m==null?void 0:m.name)||"(none)",after:((K=T.nextBg)==null?void 0:K.name)||"(none)"});const pe=Oe(a),ue=Oe(T.nextClasses);pe!==ue&&X.push({key:"classes",label:"Classes",before:pe,after:ue});const De=(me||[]).slice().sort(),Re=(T.nextFeats||[]).slice().sort();if(JSON.stringify(De)!==JSON.stringify(Re)){const ce=xe=>{var $e;return(($e=li.find(Me=>Me.id===xe))==null?void 0:$e.name)||xe};X.push({key:"feats",label:"Feats",before:De.map(ce).join(", ")||"(none)",after:Re.map(ce).join(", ")||"(none)"})}const Pe=JSON.stringify(j||{}),Ie=JSON.stringify(T.nextCfc||{});Pe!==Ie&&X.push({key:"featureChoices",label:"Class feature decisions",before:"(current)",after:"(from planner)"});const et=JSON.stringify(P||{}),Be=JSON.stringify(T.nextClassSkillPicks||{});return et!==Be&&X.push({key:"classSkills",label:"Class skill picks",before:"(current)",after:"(from planner)"}),X}function Ke(T){Xe(),o(T.nextRace),S(T.nextBg),c(T.nextClasses),st(T.nextFeats),T.nextCfc&&Object.keys(T.nextCfc).length&&E(T.nextCfc),T.nextClassSkillPicks&&Object.keys(T.nextClassSkillPicks).length&&(F(T.nextClassSkillPicks),Object.entries(T.nextClassSkillPicks).forEach(([X,pe])=>{pe.forEach(ue=>{try{te(ue,`class:${X}`)}catch{}})}))}k.useEffect(()=>{const T=e.importPlan;if(!T)return;const X=typeof T._ts=="number"?T._ts:Date.now();if(!(ee&&X===ee))try{const pe=Le(T);if(T._origin==="planner-passive"){const ue=je(pe);if(q(X),ue.length===0){O(null);return}O({plan:T,diff:ue,mapping:pe,ts:X});return}q(X),Ke(pe)}catch{}},[JSON.stringify(e.importPlan),ee]);function Xe(){M(T=>[...T,JSON.stringify(fe)]),H([])}function nt(){if(!b.length)return;const T=b[b.length-1];H(pe=>[JSON.stringify(fe),...pe]),M(pe=>pe.slice(0,-1));const X=JSON.parse(T);i(X.name),o(X.race),c(X.classes),f(X.abilities),g(X.loadout)}function kt(){if(!W.length)return;const T=W[0];M(pe=>[...pe,JSON.stringify(fe)]),H(pe=>pe.slice(1));const X=JSON.parse(T);i(X.name),o(X.race),c(X.classes),f(X.abilities),g(X.loadout)}return l.jsxs("div",{style:{display:"grid",gap:16},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 0"},children:[l.jsx(oi,{size:18}),l.jsx("div",{style:{fontWeight:600},children:"Character Builder"}),l.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:8,fontSize:12,color:"#64748b"},children:[l.jsx("span",{children:"Guided"}),l.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[l.jsx("input",{type:"checkbox",checked:t==="power",onChange:T=>n(T.target.checked?"power":"guided")}),l.jsx("span",{children:"Power"})]}),l.jsxs(be,{size:"sm",variant:"outline",onClick:nt,children:[l.jsx(t1,{size:16,style:{marginRight:6}}),"Undo"]}),l.jsxs(be,{size:"sm",variant:"outline",onClick:kt,children:[l.jsx(Uv,{size:16,style:{marginRight:6}}),"Redo"]}),l.jsxs(be,{size:"sm",onClick:Xe,children:[l.jsx(Kv,{size:16,style:{marginRight:6}}),"Save Draft"]})]})]}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) 420px",gap:16,alignItems:"start"},children:[l.jsxs("div",{style:{display:"grid",gap:12},children:[l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(ru,{size:16,style:{marginRight:6}}),"Basics"]})}),l.jsx(Rn,{children:l.jsxs("div",{style:{display:"grid",gap:12,gridTemplateColumns:"2fr 1fr 1fr",alignItems:"start",alignContent:"start"},children:[l.jsx(mn,{label:"Character Name",children:l.jsx("input",{value:r,onChange:T=>i(T.target.value),style:Ya})}),l.jsx(mn,{label:"Race",children:l.jsx(g1,{value:s,onChange:o})}),l.jsx(mn,{label:"Background",children:l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Va.map(T=>l.jsx(be,{size:"sm",variant:(m==null?void 0:m.id)===T.id?"default":"outline",onClick:()=>S(T),children:T.name},T.id))})}),l.jsx("div",{style:{gridColumn:"1 / -1"},children:l.jsx(p1,{classes:a,onChange:c})}),l.jsx(u1,{abilities:u,onChange:f,race:s,asi:Ve})]})})]}),(()=>{const T=new Set(Object.keys(C)),X=(m==null?void 0:m.skills)??[],pe=X.filter(K=>!T.has(K)),ue=X.filter(K=>T.has(K)),De=((s==null?void 0:s.traits)||[]).flatMap(K=>Il[K.id]||[]),Re=De.filter(K=>!(C[K]||[]).length),Pe=De.filter(K=>(C[K]||[]).some(ce=>ce!=="race"&&ce!=="race-pick"&&ce!=="manual")),Ie=[];a.forEach(K=>{const ce=ks[K.klass.id];if(!ce)return;const $e=(P[K.klass.id]||[]).filter(Boolean),Me=Math.max(0,ce.count-$e.length),He=ce.options;Ie.push({klassId:K.klass.id,klassName:K.klass.name,need:Me,count:ce.count,options:He})});const et=[];a.forEach(K=>{(ci[K.klass.id]||[]).forEach(xe=>{var $e;if((K.level||0)>=xe.level){const Me=($e=j[K.klass.id])==null?void 0:$e[xe.id];et.push({klassId:K.klass.id,klassName:K.klass.name,decision:xe,selected:Me})}})});const $=Kt.map(K=>K.id),se=Math.max(0,Pe.length-B.length),ye=Ie.reduce((K,ce)=>K+ce.need,0)+se+et.filter(K=>K.selected?Array.isArray(K.selected)?K.selected.length<(K.decision.picks||1):!1:!0).length>0;return l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsxs(zn,{children:[l.jsx(oi,{size:16,style:{marginRight:6}}),"Pending Choices"]}),l.jsx("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:8},children:l.jsx(be,{size:"sm",variant:L?"default":"outline",onClick:()=>_(K=>!K),children:L?"Show Completed: On":"Show Completed: Off"})})]})}),l.jsx(Rn,{children:l.jsxs("div",{style:{display:"grid",gap:12},children:[!ye&&l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"No pending choices. You can still review selections here."}),L&&l.jsxs("div",{style:{display:"grid",gap:8},children:[l.jsxs("div",{style:{fontWeight:600},children:["Background: ",m==null?void 0:m.name]}),pe.length>0&&l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Grants: ",pe.map(K=>{var ce;return((ce=Kt.find(xe=>xe.id===K))==null?void 0:ce.name)||K}).join(", ")," (will be applied)"]}),ue.length>0&&l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Conflicts detected: ",ue.map(K=>{var ce;return((ce=Kt.find(xe=>xe.id===K))==null?void 0:ce.name)||K}).join(", "),". This background doesn't grant alternatives."]})]}),De.length>0&&(L||Re.length>0||Pe.length>0)&&l.jsxs("div",{style:{display:"grid",gap:8},children:[l.jsxs("div",{style:{fontWeight:600},children:["Race: ",s==null?void 0:s.name]}),Re.length>0&&l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Grants: ",Re.map(K=>{var ce;return((ce=Kt.find(xe=>xe.id===K))==null?void 0:ce.name)||K}).join(", ")," (will be applied)"]}),Pe.length>0&&l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Conflicts detected: ",Pe.map(K=>{var ce;return((ce=Kt.find(xe=>xe.id===K))==null?void 0:ce.name)||K}).join(", "),". Pick ",Pe.length," replacement",Pe.length>1?"s":"",":",l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginTop:6},children:$.map(K=>{var Ye;const ce=B.includes(K),xe=G.includes(K),$e=B.length>=Pe.length,ze=(C[K]||[]).some(_e=>_e!=="race"&&_e!=="race-pick"&&_e!=="manual")&&!ce,Fe=ze||xe||$e&&!ce,Ee={};return ze&&(Ee.style={background:"#f97316",color:"white",borderColor:"#f97316"}),l.jsx(be,{size:"sm",variant:ce?"default":"outline",disabled:Fe,onClick:()=>{ze||xe||(v(_e=>ce?_e.filter(Ge=>Ge!==K):_e.length<Pe.length?[..._e,K]:_e),ce?Ce(K,"race-pick"):te(K,"race-pick"))},...Ee,children:((Ye=Kt.find(_e=>_e.id===K))==null?void 0:Ye.name)||K},K)})}),l.jsxs("div",{style:{marginTop:6},children:["Selected ",B.length," / ",Pe.length]})]})]}),Ie.filter(K=>L||K.need>0).length>0&&l.jsxs("div",{style:{display:"grid",gap:8},children:[l.jsx("div",{style:{fontWeight:600},children:"Class Skills"}),Ie.filter(K=>L||K.need>0).map(({klassId:K,klassName:ce,need:xe,count:$e,options:Me})=>l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:[ce,": ",xe>0?`pick ${xe}`:L?"complete":null]}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:Me.map(He=>{var hn;const ze=P[K]||[],Fe=ze.includes(He),_e=(C[He]||[]).some(We=>We!==`class:${K}`&&We!=="manual")&&!Fe,Ge=ze.length>=$e,rt=_e||Ge&&!Fe,rn={};return _e&&(rn.style={background:"#f97316",color:"white",borderColor:"#f97316"}),l.jsx(be,{size:"sm",variant:Fe?"default":"outline",disabled:rt,onClick:()=>{_e||(F(We=>{const pn=[...We[K]||[]],ii=Fe?pn.filter(ns=>ns!==He):pn.length<$e?[...pn,He]:pn;return{...We,[K]:ii}}),Fe?Ce(He,`class:${K}`):te(He,`class:${K}`))},...rn,children:((hn=Kt.find(We=>We.id===He))==null?void 0:hn.name)||He},He)})}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Selected ",(P[K]||[]).length," / ",$e]})]},K))]}),(()=>{const K=[];if(a.forEach(xe=>{(ci[xe.klass.id]||[]).forEach(Me=>{var He;if((xe.level||0)>=Me.level){const ze=(He=j[xe.klass.id])==null?void 0:He[Me.id];K.push({klassId:xe.klass.id,klassName:xe.klass.name,decision:Me,selected:ze})}})}),!K.length)return null;const ce=K.filter(({decision:xe,selected:$e})=>{const Me=xe.picks||1,He=Array.isArray($e)?$e.length:$e?1:0;return L||He<Me});return ce.length?l.jsxs("div",{style:{display:"grid",gap:8},children:[l.jsx("div",{style:{fontWeight:600},children:"Class Feature Decisions"}),ce.map(({klassId:xe,klassName:$e,decision:Me,selected:He})=>l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:[$e,": ",Me.name," ",(()=>{const ze=Me.picks||1,Fe=Array.isArray(He)?He.length:He?1:0;return Fe>=ze?L?"(complete)":"":`(pick ${ze-Fe} more)`})()]}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:Me.options.map(ze=>{const Fe=Me.picks||1,Ee=Array.isArray(He)?He:He?[He]:[],Ye=Ee.includes(ze.id),_e=Ee.length>=Fe;return l.jsx(be,{size:"sm",variant:Ye?"default":"outline",disabled:!Ye&&_e,onClick:()=>{E(Ge=>{const rt={...Ge[xe]||{}},rn=rt[Me.id],hn=Array.isArray(rn)?rn:rn?[rn]:[];let We;return Ye?We=hn.filter(pn=>pn!==ze.id):We=_e?hn:[...hn,ze.id],rt[Me.id]=Fe===1?We[0]||"":We,{...Ge,[xe]:rt}})},title:ze.text,style:{opacity:!Ye&&_e?.6:1},children:ze.name},ze.id)})})]},`${xe}:${Me.id}`))]}):null})(),l.jsx("div",{style:{display:"flex",gap:8},children:l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>{J([]),v([]),F({}),E({})},children:"Reset Selections"})})]})})]})})(),de.length?l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(oi,{size:16,style:{marginRight:6}}),"Class Feature Choices"]})}),l.jsxs(Rn,{children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"You have class choices to make."}),l.jsx("div",{style:{display:"grid",gap:8,marginTop:8},children:de.map(T=>l.jsxs("div",{style:{padding:8,borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:8},children:[l.jsxs("div",{style:{fontWeight:600},children:[T.klass.name,": Choose a Subclass"]}),l.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:(T.klass.subclasses||[]).filter(X=>T.level>=X.unlockLevel).map(X=>{var pe;return l.jsx(be,{size:"sm",variant:((pe=T.subclass)==null?void 0:pe.id)===X.id?"default":"outline",onClick:()=>Ue(T.klass.id,X),children:X.name},X.id)})})]},T.klass.id))})]})]}):null,(()=>{var Be;const T=new Set([4,8,12,16,19]),X=a.reduce(($,se)=>$+Array.from(T).filter(ye=>se.level>=ye).length,0),pe=X*2,ue=["str","dex","con","int","wis","cha"].reduce(($,se)=>$+(Ve[se]||0),0)+me.length*2,De=Math.max(0,pe-ue),Re=Tn(u,s,Ve),Pe=$=>De>0&&Re[$]+1<=20,Ie=$=>(Ve[$]||0)>0,et=$=>{st(se=>se.includes($)?se.filter(K=>K!==$):De<2?se:[...se,$])};return X===0?null:l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(oi,{size:16,style:{marginRight:6}}),"ASI & Feats"]})}),l.jsx(Rn,{children:l.jsxs("div",{style:{display:"grid",gap:12},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[l.jsxs(Ft,{children:["ASI slots ",X]}),l.jsxs(Ft,{children:["Points ",ue," / ",pe]}),l.jsxs(Ft,{children:["Remaining ",De]})]}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:8},children:["str","dex","con","int","wis","cha"].map($=>l.jsxs("div",{style:{padding:8,borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:6},children:[l.jsx("div",{style:{fontSize:10,textTransform:"uppercase",color:"#64748b"},children:$}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx(be,{size:"icon",variant:"outline",onClick:()=>Qe(se=>({...se,[$]:Math.max(0,(se[$]||0)-1)})),disabled:!Ie($),children:""}),l.jsxs("div",{style:{fontWeight:600,minWidth:44,textAlign:"center"},children:[Re[$],Ve[$]?` (+${Ve[$]})`:""]}),l.jsx(be,{size:"icon",variant:"outline",onClick:()=>{Pe($)&&Qe(se=>({...se,[$]:(se[$]||0)+1}))},disabled:!Pe($),children:"+"})]}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["mod ",Nt(Re[$])>=0?"+":"",Nt(Re[$])]})]},$))}),l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Feats (each costs 2 points)"}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:li.map($=>{const se=me.includes($.id),ye=De<2;return l.jsx(be,{size:"sm",variant:se?"default":"outline",disabled:!se&&ye,onClick:()=>et($.id),title:$.text,style:{opacity:!se&&ye?.6:1},children:$.name},$.id)})}),me.includes("prodigy")?l.jsxs("div",{style:{marginTop:6,padding:8,borderRadius:8,border:"1px solid #e2e8f0",background:"#fff"},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6},children:"Prodigy: choose a skill to gain proficiency (or expertise if already proficient)"}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:Kt.map($=>{const se=I.prodigySkill===$.id;return l.jsx(be,{size:"sm",variant:se?"default":"outline",onClick:()=>Y(ye=>({...ye,prodigySkill:$.id})),children:$.name},$.id)})}),I.prodigySkill?l.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#64748b"},children:["Selected: ",(Be=Kt.find($=>$.id===I.prodigySkill))==null?void 0:Be.name]}):null]}):null]}),me.length>0?l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Selected feats: ",me.map($=>{var se;return((se=li.find(ye=>ye.id===$))==null?void 0:se.name)||$}).join(", ")]}):null,l.jsx("div",{style:{display:"flex",gap:8},children:l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>{Qe({str:0,dex:0,con:0,int:0,wis:0,cha:0}),st([])},children:"Reset ASI/Feats"})})]})})]})})(),(()=>{var Re,Pe,Ie,et;const T=a.filter(Be=>(Be.level||0)>=1&&["bard","cleric","wizard","druid","warlock","paladin","sorcerer","ranger"].includes(Be.klass.id));if(!T.length)return null;const X=Be=>{const $=Tn(u,s,Ve),se=Be==="bard"?$.cha:Be==="cleric"||Be==="druid"?$.wis:Be==="warlock"||Be==="paladin"||Be==="sorcerer"?$.cha:Be==="ranger"?$.wis:$.int;return{mod:Nt(se),score:se}},pe=iu(Z.totalLevel),ue={bard:{cantrips:2,level1:2,prepared1:0},cleric:{cantrips:3,level1:0,prepared1:Math.max(1,X("cleric").mod+(((Re=a.find(Be=>Be.klass.id==="cleric"))==null?void 0:Re.level)||1))},wizard:{cantrips:3,level1:3,prepared1:0},druid:{cantrips:2,level1:0,prepared1:Math.max(1,X("druid").mod+(((Pe=a.find(Be=>Be.klass.id==="druid"))==null?void 0:Pe.level)||1))},warlock:{cantrips:2,level1:2,prepared1:0},paladin:{cantrips:0,level1:0,prepared1:Math.max(1,X("paladin").mod+(((Ie=a.find(Be=>Be.klass.id==="paladin"))==null?void 0:Ie.level)||1))},sorcerer:{cantrips:4,level1:2,prepared1:0},ranger:{cantrips:0,level1:0,prepared1:Math.max(1,X("ranger").mod+(((et=a.find(Be=>Be.klass.id==="ranger"))==null?void 0:et.level)||1))}},De=(Be,$,se=!1)=>{se?Se(ye=>{const K=ye[Be]||[],ce=K.includes($);return{...ye,[Be]:ce?K.filter(xe=>xe!==$):[...K,$]}}):Ae(ye=>{const K=ye[Be]||[],ce=K.includes($);return{...ye,[Be]:ce?K.filter(xe=>xe!==$):[...K,$]}})};return l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(oi,{size:16,style:{marginRight:6}}),"Spells"]})}),l.jsx(Rn,{children:l.jsx("div",{style:{display:"grid",gap:12},children:T.map(Be=>{const $=Be.klass.id,{mod:se,score:ye}=X($),K=8+pe+se,ce=pe+se,xe=Kf.filter(_e=>_e.level===0&&_e.classes.includes($)),$e=Kf.filter(_e=>_e.level===1&&_e.classes.includes($)),Me=Q[$]||[],He=ve[$]||[],ze=ue[$]||{cantrips:0,level1:0,prepared1:0},Fe=Me.filter(_e=>xe.some(Ge=>Ge.id===_e)).length,Ee=Me.filter(_e=>$e.some(Ge=>Ge.id===_e)).length,Ye=He.filter(_e=>$e.some(Ge=>Ge.id===_e)).length;return l.jsxs("div",{style:{padding:8,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:8},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[l.jsx("div",{style:{fontWeight:600},children:Be.klass.name}),l.jsxs(Ft,{children:["Spell DC ",K]}),l.jsxs(Ft,{children:["Spell Atk ",ce>=0?`+${ce}`:ce]}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Casting stat ",$==="bard"?"CHA":$==="cleric"||$==="druid"?"WIS":$==="warlock"||$==="paladin"||$==="sorcerer"?"CHA":$==="ranger"?"WIS":"INT"," (",ye," | ",se>=0?`+${se}`:se,")"]})]}),!!ze.cantrips&&l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Cantrips: pick ",ze.cantrips-Fe," more"]}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:xe.map(_e=>{const Ge=Me.includes(_e.id),rt=Fe>=ze.cantrips;return l.jsx(be,{size:"sm",variant:Ge?"default":"outline",disabled:!Ge&&rt,onClick:()=>De($,_e.id),title:_e.text,style:{opacity:!Ge&&rt?.6:1},children:_e.name},_e.id)})}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Selected ",Fe," / ",ze.cantrips]})]}),["bard","wizard","warlock","sorcerer"].includes($)&&!!ze.level1&&l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Level 1 Spells: pick ",ze.level1-Ee," more"]}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:$e.map(_e=>{const Ge=Me.includes(_e.id),rt=Ee>=ze.level1;return l.jsx(be,{size:"sm",variant:Ge?"default":"outline",disabled:!Ge&&rt,onClick:()=>De($,_e.id),title:_e.text,style:{opacity:!Ge&&rt?.6:1},children:_e.name},_e.id)})}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Selected ",Ee," / ",ze.level1]})]}),["cleric","druid","paladin","ranger"].includes($)&&ze.prepared1>0&&l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Prepared Level 1: pick ",Math.max(0,ze.prepared1-Ye)," more (limit ",ze.prepared1,")"]}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:$e.map(_e=>{const Ge=He.includes(_e.id),rt=Ye>=ze.prepared1;return l.jsx(be,{size:"sm",variant:Ge?"default":"outline",disabled:!Ge&&rt,onClick:()=>De($,_e.id,!0),title:_e.text,style:{opacity:!Ge&&rt?.6:1},children:_e.name},_e.id)})}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Prepared ",Ye," / ",ze.prepared1]})]})]},$)})})})]})})(),l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(ru,{size:16,style:{marginRight:6}}),"Skills"]})}),l.jsxs(Rn,{children:[l.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8},children:[l.jsx(be,{size:"sm",variant:D==="list"?"default":"outline",onClick:()=>R("list"),children:"List"}),l.jsx(be,{size:"sm",variant:D==="sources"?"default":"outline",onClick:()=>R("sources"),children:"Sources"})]}),D==="list"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8,flexWrap:"wrap"},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Sort By"}),l.jsxs("select",{value:d,onChange:T=>p(T.target.value),style:{...Ya,width:240,padding:"6px 10px"},children:[l.jsx("option",{value:"ability",children:"Ability Score"}),l.jsx("option",{value:"alpha",children:"Alphabetical"}),l.jsx("option",{value:"bonus",children:"Highest Bonus"}),l.jsx("option",{value:"proftype",children:"Proficiency Type"})]}),l.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:6},children:[l.jsx(be,{size:"sm",variant:x==="single"?"default":"outline",onClick:()=>y("single"),"aria-label":"Single column",title:"Single column",children:l.jsx(Bv,{size:16})}),l.jsx(be,{size:"sm",variant:x==="double"?"default":"outline",onClick:()=>y("double"),"aria-label":"Two columns",title:"Two columns",children:l.jsx(Rv,{size:16})}),l.jsx(be,{size:"sm",variant:x==="grid"?"default":"outline",onClick:()=>y("grid"),"aria-label":"Grid",title:"Grid",children:l.jsx(Lv,{size:16})})]})]}),(()=>{const T=Tn(u,s,Ve),X=iu(Z.totalLevel),pe=["cha","con","dex","int","str","wis"],ue=["expert","prof","half","none"],De=Kt.map(Ee=>{const Ye=Nt(T[Ee.ability]);let _e=w[Ee.id]??"none";me.includes("prodigy")&&I.prodigySkill===Ee.id&&(_e==="none"?_e="prof":_e==="prof"&&(_e="expert"));const Ge=_e==="half"?Math.floor(X/2):_e==="prof"?X:_e==="expert"?X*2:0,rt=Ye+Ge;return{...Ee,base:Ye,add:Ge,total:rt,t:_e}});De.sort((Ee,Ye)=>d==="alpha"?Ee.name.localeCompare(Ye.name):d==="bonus"?Ye.total-Ee.total||Ee.name.localeCompare(Ye.name):d==="proftype"?ue.indexOf(Ee.t)-ue.indexOf(Ye.t)||Ee.name.localeCompare(Ye.name):pe.indexOf(Ee.ability)-pe.indexOf(Ye.ability)||Ee.name.localeCompare(Ye.name));const Re=(Ee,Ye)=>{try{const Ge=document.createElement("canvas").getContext("2d");return Ge?(Ge.font=Ee,Ge.measureText(Ye).width):Ye.length*8}catch{return Ye.length*8}},Pe="system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",Ie=`600 14px ${Pe}`,et=`12px ${Pe}`,Be=`12px ${Pe}`,$=Math.max(...Kt.map(Ee=>Re(Ie,Ee.name))),se=Math.max(...De.map(Ee=>Re(et,Ee.total>=0?`+${Ee.total}`:`${Ee.total}`))),ye=Math.ceil(se+16+2),ce=Re(Be,"Expertise"),xe=Math.ceil(ce+20+2),$e=Math.ceil($),Me=Math.ceil($e+8+ye+8+xe+16),He={display:"grid",gap:8,gridTemplateColumns:x==="single"?`repeat(1, minmax(${Me}px, 1fr))`:x==="double"?`repeat(2, minmax(${Me}px, 1fr))`:`repeat(auto-fill, ${Me}px)`},ze={padding:8,borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,...x==="grid"?{width:Me}:{}};let Fe=De;if(x==="double"){const Ee=Math.ceil(De.length/2),Ye=De.slice(0,Ee),_e=De.slice(Ee),Ge=[];for(let rt=0;rt<Ee;rt++)Ye[rt]&&Ge.push(Ye[rt]),_e[rt]&&Ge.push(_e[rt]);Fe=Ge}return l.jsx("div",{style:He,children:Fe.map(Ee=>l.jsxs("div",{style:ze,children:[l.jsxs("div",{style:{display:"grid",gap:2},children:[l.jsx("div",{style:{fontWeight:600,whiteSpace:"nowrap"},children:Ee.name}),l.jsx("div",{style:{fontSize:11,color:"#64748b",textTransform:"uppercase",whiteSpace:"nowrap"},children:Ee.ability})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,whiteSpace:"nowrap"},children:[l.jsx(Ft,{children:Ee.total>=0?`+${Ee.total}`:Ee.total}),l.jsx(be,{size:"sm",variant:Ee.t==="none"?"outline":"default",onClick:()=>{(C[Ee.id]||[]).includes("manual")?Ce(Ee.id,"manual"):te(Ee.id,"manual")},children:Ee.t==="none"?"None":Ee.t==="half"?"Half":Ee.t==="prof"?"Prof":"Expertise"})]})]},Ee.id))})})()]}):null,D==="sources"?l.jsxs("div",{style:{display:"grid",gap:8},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Combined node graph showing all skills and their proficiency sources."}),l.jsx(m1,{skills:Kt.map(T=>({id:T.id,name:T.name})),skillSources:C,race:s,raceReplPicks:B,classes:a,background:m})]}):null]})]}),l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(md,{size:16,style:{marginRight:6}}),"Equipment & Loadout"]})}),l.jsx(Rn,{children:l.jsxs("div",{style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))"},children:[l.jsxs("div",{style:{display:"grid",gap:8},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Catalog"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{placeholder:"Search catalog...",value:re,onChange:T=>oe(T.target.value),style:{...Ya,flex:1}}),l.jsxs(be,{size:"sm",variant:z||ge.length?"default":"outline",onClick:()=>ie(T=>!T),children:["Filters",ge.length?` (${ge.length})`:""]})]}),z?l.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:[le.map(T=>l.jsx(be,{size:"sm",variant:ge.includes(T)?"default":"outline",onClick:()=>Te(T),children:T},T)),ge.length?l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>we([]),children:"Clear filters"}):null]}):null,l.jsx("div",{style:{maxHeight:360,overflowY:"auto",paddingRight:4},children:l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:12},children:he.length?he.map(T=>l.jsx(d1,{item:T,onAdd:()=>g(X=>Is([...X,T]))},T.id)):l.jsx("div",{style:{gridColumn:"1 / -1",fontSize:12,color:"#94a3b8"},children:"No items match your search."})})})]}),l.jsxs("div",{style:{display:"grid",gap:8,background:"#f8fafc",padding:8,borderRadius:10,border:"1px solid #e2e8f0"},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Loadout"}),l.jsx("div",{style:{maxHeight:360,overflowY:"auto",paddingRight:4},children:l.jsxs("div",{style:{display:"grid",gap:6},children:[h.length===0&&l.jsx("div",{style:{fontSize:12,color:"#94a3b8"},children:"Nothing equipped."}),h.map(T=>l.jsx(f1,{item:T,onRemove:()=>g(X=>X.filter(pe=>pe.id!==T.id))},T.id))]})})]})]})})]}),l.jsx(h1,{race:s,classes:a,loadout:h}),l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(r1,{size:16,style:{marginRight:6}}),"Toy Combat Readiness"]})}),l.jsxs(Rn,{children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"This demo computes a quick heuristic score. In production this would call your MCST to simulate turns and return rich analytics."}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginTop:12},children:[l.jsx(Ga,{label:"Offense",value:ae.offense}),l.jsx(Ga,{label:"Defense",value:ae.defense}),l.jsx(Ga,{label:"Economy",value:ae.economy})]}),l.jsxs("div",{style:{paddingTop:8},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:12,marginBottom:6},children:[l.jsx("span",{children:"Readiness"}),l.jsxs("span",{style:{fontWeight:600},children:[ae.readiness.toFixed(2)," / 10"]})]}),l.jsx(am,{value:ae.readiness/10*100})]}),l.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[l.jsxs(be,{variant:"outline",onClick:()=>{const T=ai[Math.floor(Math.random()*ai.length)];g(X=>Is([...X.filter(pe=>pe.type!==T.type),T]))},children:[l.jsx(Jv,{size:16,style:{marginRight:6}}),"Try Random Loadout"]}),l.jsxs(be,{onClick:Xe,children:[l.jsx(Tv,{size:16,style:{marginRight:6}}),"Snapshot Build"]})]})]})]})]}),l.jsx("aside",{style:{display:"grid",gap:12,position:"sticky",top:76},children:l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(Yv,{size:16,style:{marginRight:6}}),"Live Summary"]})}),l.jsxs(Rn,{children:[l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[l.jsx(mn,{label:"Race",children:l.jsx("div",{children:s.name})}),l.jsx(mn,{label:"Level",children:l.jsx(Ft,{children:Z.totalLevel})}),l.jsx(mn,{label:"Classes",children:l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:a.map(T=>l.jsxs(Ft,{children:[T.klass.name," ",T.level,T.subclass?` (${T.subclass.name})`:""]},T.klass.id))})}),l.jsx(mn,{label:"Speed",children:l.jsxs(Ft,{children:[Z.speed," ft."]})}),l.jsx(mn,{label:"HP @lvl",children:l.jsx(Ft,{children:Z.hp})}),l.jsx(mn,{label:"AC",children:l.jsx(Ft,{children:Z.ac})}),l.jsx(mn,{label:"Initiative",children:l.jsx(Ft,{children:Z.initiative>=0?`+${Z.initiative}`:Z.initiative})}),l.jsx(mn,{label:"Background",children:l.jsx("div",{children:(m==null?void 0:m.name)||""})})]}),l.jsxs("div",{style:{display:"grid",gap:8,marginTop:12},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Abilities & Saves"}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:8},children:["str","dex","con","int","wis","cha"].map(T=>l.jsxs("div",{style:{padding:8,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:6},children:[l.jsx("div",{style:{fontSize:10,textTransform:"uppercase",color:"#64748b"},children:T}),l.jsx("div",{style:{fontWeight:600},children:Tn(u,s,Ve)[T]}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["mod ",Nt(Tn(u,s,Ve)[T])>=0?"+":"",Nt(Tn(u,s,Ve)[T])]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:11,color:"#64748b"},children:"Save"}),l.jsx(Ft,{children:Z.saves[T]>=0?`+${Z.saves[T]}`:Z.saves[T]})]})]},T))})]}),l.jsxs("div",{style:{display:"grid",gap:8,marginTop:12},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Subactions Gained"}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:Z.subactions.length?Z.subactions.map(T=>l.jsx("span",{style:l1,children:T},T)):l.jsx("div",{style:{color:"#94a3b8"},children:"None yet."})}),l.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:8,display:"flex",alignItems:"center",gap:8},children:[l.jsx(oi,{size:16,style:{marginRight:6}}),"Class Features"]}),l.jsx("div",{style:{display:"grid",gap:8,fontSize:14},children:(()=>{const T=[];return a.filter(X=>(X.level||0)>=1).forEach(X=>{var et,Be;const pe=X.level||1,ue=X.klass.featuresByLevel,De=ci[X.klass.id]||[],Re={},Pe={};De.forEach($=>{var se;if(pe>=$.level){const ye=(se=j[X.klass.id])==null?void 0:se[$.id],ce=(Array.isArray(ye)?ye:ye?[ye]:[]).map(xe=>$.options.find($e=>$e.id===xe)).filter(Boolean);if(ce.length===1){const xe=ce[0];Re[$.id]={name:xe.name,text:xe.text},Pe[$.name]={name:xe.name,text:xe.text}}else if(ce.length>1){const xe=ce.map($e=>({name:$e.name,text:$e.text}));Re[$.id]={multi:xe},Pe[$.name]={multi:xe}}}});const Ie=new Set;if(ue?Object.keys(ue).map(se=>parseInt(se,10)).filter(se=>se<=pe).sort((se,ye)=>se-ye).forEach(se=>{ue[se].forEach(ye=>{const K=Pe[ye.name];if(K){const $e=De.find(Me=>Me.name===ye.name);$e&&Ie.add($e.id)}const ce=K?"multi"in K?`${ye.name}: ${K.multi.map($e=>$e.name).join(", ")}`:`${ye.name}: ${K.name}`:ye.name,xe=(()=>{if(ye.name.toLowerCase().includes("ability score improvement")){const Me=["str","dex","con","int","wis","cha"].filter(Ee=>(Ve[Ee]||0)>0),He=Me.length?`ASI: ${Me.map(Ee=>`${Ee.toUpperCase()} +${Ve[Ee]||0}`).join(", ")}`:"",ze=me.length?`Feats: ${me.map(Ee=>{var Ye;return((Ye=li.find(_e=>_e.id===Ee))==null?void 0:Ye.name)||Ee}).join(", ")}`:"",Fe=[He,ze].filter(Boolean);return Fe.length?Fe.join("  "):ye.text}return K?"multi"in K?K.multi.map(Me=>Me.text).join("  "):K.text:ye.text})();T.push({key:`${X.klass.id}-lvl${se}-${ye.name}`,name:ce,text:xe,source:`${X.klass.name}  L${se}`})})}):(X.klass.level1||[]).forEach($=>{if(Pe[$.name]){const ce=De.find(xe=>xe.name===$.name);ce&&Ie.add(ce.id)}const ye=(()=>{const ce=Pe[$.name];return ce?"multi"in ce?`${$.name}: ${ce.multi.map(xe=>xe.name).join(", ")}`:`${$.name}: ${ce.name}`:$.name})(),K=(()=>{if($.name.toLowerCase().includes("ability score improvement")){const $e=["str","dex","con","int","wis","cha"].filter(Fe=>(Ve[Fe]||0)>0),Me=$e.length?`ASI: ${$e.map(Fe=>`${Fe.toUpperCase()} +${Ve[Fe]||0}`).join(", ")}`:"",He=me.length?`Feats: ${me.map(Fe=>{var Ee;return((Ee=li.find(Ye=>Ye.id===Fe))==null?void 0:Ee.name)||Fe}).join(", ")}`:"",ze=[Me,He].filter(Boolean);return ze.length?ze.join("  "):$.text}const xe=Pe[$.name];return xe?"multi"in xe?xe.multi.map($e=>$e.text).join("  "):xe.text:$.text})();T.push({key:`${X.klass.id}-lvl1-${$.name}`,name:ye,text:K,source:X.klass.name})}),De.forEach($=>{if(pe>=$.level&&!Ie.has($.id)){const se=Re[$.id];se&&("multi"in se?T.push({key:`${X.klass.id}-dec-${$.id}`,name:`${$.name}: ${se.multi.map(ye=>ye.name).join(", ")}`,text:se.multi.map(ye=>ye.text).join("  "),source:X.klass.name}):T.push({key:`${X.klass.id}-dec-${$.id}`,name:`${$.name}: ${se.name}`,text:se.text,source:X.klass.name}))}}),X.subclass&&pe>=(X.subclass.unlockLevel||1/0)){const $=(Be=(et=X.subclass.grants)==null?void 0:et.subactions)!=null&&Be.length?`Grants: ${X.subclass.grants.subactions.join(", ")}`:"Subclass features unlocked.";T.push({key:`${X.klass.id}-sub-${X.subclass.id}`,name:X.subclass.name,text:$,source:X.klass.name})}}),T.length?T.map(X=>l.jsxs("div",{style:{padding:8,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc"},children:[l.jsxs("div",{style:{fontWeight:600},children:[X.name," ",l.jsxs("span",{style:{color:"#64748b",fontWeight:400},children:["(",X.source,")"]})]}),l.jsx("div",{style:{color:"#64748b"},children:X.text})]},X.key)):l.jsx("div",{style:{color:"#94a3b8"},children:"No class features."})})()})]}),l.jsxs("div",{style:{display:"grid",gap:8,marginTop:12},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Racial Features"}),l.jsx("div",{style:{display:"grid",gap:8,fontSize:14},children:(s.traits||[]).length?(s.traits||[]).map(T=>l.jsxs("div",{style:{padding:8,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc"},children:[l.jsx("div",{style:{fontWeight:600},children:T.name}),l.jsx("div",{style:{color:"#64748b"},children:T.text})]},T.id)):l.jsx("div",{style:{color:"#94a3b8"},children:"No racial features."})})]})]})]})})]}),l.jsx("div",{style:{fontSize:12,color:"#64748b",padding:"8px 0"},children:"Demo only. Replace permit/reward stubs with your engine calls to power full validation, previews, and MCSTdriven simulations."}),U?l.jsx("div",{style:{position:"fixed",left:12,right:12,bottom:12,display:"flex",justifyContent:"center",pointerEvents:"none",zIndex:50},children:l.jsxs("div",{style:{pointerEvents:"auto",maxWidth:720,width:"100%",background:"white",border:"1px solid #e2e8f0",borderRadius:12,boxShadow:"0 6px 20px rgba(0,0,0,0.08)",padding:12,display:"grid",gap:10},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsx("div",{style:{fontWeight:600},children:"Planner changes available"}),l.jsx(be,{size:"sm",variant:"outline",onClick:()=>{O(null)},children:"Dismiss"})]}),l.jsx("div",{style:{fontSize:13,color:"#475569"},children:"We found differences between Builder and the active plan. Apply these updates?"}),l.jsxs("ul",{style:{margin:0,paddingLeft:18,fontSize:13,color:"#334155"},children:[U.diff.slice(0,8).map(T=>l.jsxs("li",{children:[l.jsxs("strong",{children:[T.label,":"]})," ",T.before||""," ",T.after?" "+T.after:""]},T.key)),U.diff.length>8?l.jsxs("li",{children:["and ",U.diff.length-8," more"]}):null]}),l.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[l.jsx(be,{size:"sm",variant:"outline",onClick:()=>{O(null)},children:"Not now"}),l.jsx(be,{size:"sm",onClick:()=>{U&&(Ke(U.mapping),O(null))},children:"Apply changes"})]})]})}):null]})}function u1(e){const t=Tn(e.abilities,e.race,e.asi),n=["str","dex","con","int","wis","cha"],[r,i]=k.useState([]),[s,o]=k.useState({}),a=()=>Math.random().toString(36).slice(2,9),[c,u]=k.useState(!1),[f,h]=k.useState(!1),g=27;function m(j){switch(j){case 8:return 0;case 9:return 1;case 10:return 2;case 11:return 3;case 12:return 4;case 13:return 5;case 14:return 7;case 15:return 9;default:return Number.POSITIVE_INFINITY}}function S(j){return["str","dex","con","int","wis","cha"].reduce((E,L)=>{const _=Math.max(8,Math.min(15,j[L]||8));return E+m(_)},0)}const w=S(e.abilities),N=Math.max(0,g-w);function d(j,E){return Array.from({length:j},()=>1+Math.floor(Math.random()*E))}function p(){const j=d(4,6).sort((E,L)=>L-E);return j[0]+j[1]+j[2]}function x(){return d(3,6).reduce((j,E)=>j+E,0)}function y(j){return j.map(E=>({id:a(),value:E}))}function C(){const j=Array.from({length:6},()=>p());i(y(j)),o({}),u(!1)}function A(){const j=Array.from({length:6},()=>x());i(y(j)),o({}),u(!1)}function D(){const j=Array.from({length:6},()=>1+Math.floor(Math.random()*20));i(y(j)),o({}),u(!1)}function R(j){const E=[...j].sort((_,b)=>b-_),L={...e.abilities};n.forEach((_,b)=>{L[_]=$n(E[b]??10,3,20)}),e.onChange(L)}function P(){r.length&&(R(r.map(j=>j.value)),i([]),o({}))}function F(){i([]),o({})}function G(j,E){j.dataTransfer.setData("text/plain",E),j.dataTransfer.effectAllowed="move"}function J(j){j.preventDefault(),j.dataTransfer.dropEffect="move"}function B(j,E){E.preventDefault();const L=E.dataTransfer.getData("text/plain");if(!L)return;const _=r.findIndex(re=>re.id===L);if(_===-1)return;const b=r[_],M=r.filter((re,oe)=>oe!==_),W=s[j],H=[...M];typeof W=="number"&&H.push({id:a(),value:W}),o({...s,[j]:b.value}),i(H),e.onChange({...e.abilities,[j]:$n(b.value,3,20)})}function v(j,E){if(!c){e.onChange({...e.abilities,[j]:$n((e.abilities[j]||10)+E,3,20)});return}const L=$n(e.abilities[j]||8,8,15),_=$n(L+E,8,15);if(_===L)return;const b=m(_)-m(L);(b<=0||N-b>=0)&&e.onChange({...e.abilities,[j]:_})}return l.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gap:8},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Abilities"}),l.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:8},children:[l.jsx(be,{size:"sm",variant:"outline",onClick:()=>h(j=>!j),children:"Generate"}),l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>{e.onChange({str:10,dex:10,con:10,int:10,wis:10,cha:10}),F(),u(!1)},children:"Reset"}),f?l.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:8},children:[l.jsx(be,{size:"sm",variant:"outline",onClick:C,children:" 4d6 (drop lowest)"}),l.jsx(be,{size:"sm",variant:"outline",onClick:A,children:" 3d6"}),l.jsx(be,{size:"sm",variant:"outline",onClick:D,children:" 1d20"}),l.jsx(be,{size:"sm",variant:"outline",onClick:()=>{R([15,14,13,12,10,8]),F(),u(!1)},children:"Standard Array"}),c?l.jsxs(l.Fragment,{children:[l.jsxs("span",{style:{fontSize:12,color:"#64748b"},children:["Remaining: ",l.jsx("strong",{children:N})]}),l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>u(!1),children:"Exit Point Buy"})]}):l.jsx(be,{size:"sm",variant:"outline",onClick:()=>{u(!0),F(),e.onChange({str:8,dex:8,con:8,int:8,wis:8,cha:8})},children:"Point Buy (27)"}),r.length?l.jsxs(l.Fragment,{children:[l.jsx(be,{size:"sm",variant:"outline",onClick:P,children:"Auto-assign highlow"}),l.jsx(be,{size:"sm",variant:"ghost",onClick:F,children:"Clear Rolls"})]}):null]}):null]}),r.length?l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8,justifyContent:"center"},children:r.map(j=>l.jsx("div",{draggable:!0,onDragStart:E=>G(E,j.id),title:`Drag ${j.value} onto a stat`,style:{width:36,height:36,borderRadius:8,border:"1px solid #ef4444",background:"#ef4444",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600},children:j.value},j.id))}):null,l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:8},children:n.map(j=>l.jsxs("div",{onDragOver:J,onDrop:E=>B(j,E),style:{padding:8,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:6},children:[l.jsx("div",{style:{fontSize:10,textTransform:"uppercase",color:"#64748b"},children:j}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx(be,{size:"icon",variant:"outline",onClick:()=>v(j,-1),children:""}),l.jsx("div",{style:{fontWeight:600,width:24,textAlign:"center"},children:c?Math.max(8,Math.min(15,e.abilities[j]||8)):e.abilities[j]||10}),l.jsx(be,{size:"icon",variant:"outline",onClick:()=>v(j,1),children:"+"})]}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["mod ",Nt(t[j])>=0?"+":"",Nt(t[j])]}),typeof s[j]=="number"?l.jsxs("div",{style:{fontSize:11,color:"#64748b"},children:["Assigned: ",s[j]]}):r.length?l.jsx("div",{style:{fontSize:11,color:"#94a3b8"},children:"Drop a roll here"}):null]},j))})]})}function Tn(e,t,n){const r={str:10,dex:10,con:10,int:10,wis:10,cha:10,...e};return Object.entries((t==null?void 0:t.asis)||{}).forEach(([i,s])=>{const o=i;r[o]=(r[o]||10)+(s||0)}),n&&["str","dex","con","int","wis","cha"].forEach(i=>{const s=Math.max(0,Math.floor(n[i]||0));r[i]=(r[i]||10)+s}),r}function d1({item:e,onAdd:t}){const n=e.tags;return l.jsxs("div",{style:{padding:10,borderRadius:10,border:"1px solid #e2e8f0",background:"white",display:"grid",gap:6,minHeight:96},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.type==="weapon"&&l.jsx(md,{size:16}),e.type==="shield"&&l.jsx(om,{size:16}),l.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:6,flex:1,minWidth:0},children:[l.jsx("span",{style:{fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.name}),l.jsxs("span",{style:{fontSize:12,color:"#64748b",whiteSpace:"nowrap"},children:[e.type==="weapon"&&e.dmg,e.type==="armor"&&l.jsxs(l.Fragment,{children:["AC ",e.ac,typeof e.dexMax<"u"?`, Dex cap ${e.dexMax===1/0?"":e.dexMax}`:""]}),e.type==="shield"&&`+${e.ac||2} AC`]})]}),l.jsx(be,{size:"icon",onClick:t,"aria-label":"Add",children:l.jsx(Hv,{size:16})})]}),n!=null&&n.length?l.jsx("div",{style:{fontSize:11,color:"#64748b",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:n.join("  ")}):null]})}function f1({item:e,onRemove:t}){var n;return l.jsxs("div",{style:{padding:6,borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[e.type==="weapon"&&l.jsx(md,{size:16}),e.type==="shield"&&l.jsx(om,{size:16}),l.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:6,flexWrap:"wrap"},children:[l.jsx("div",{style:{fontWeight:600,fontSize:13},children:e.name}),l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:e.type==="weapon"?e.dmg:e.type==="armor"?`AC ${e.ac}`:e.type}),e.type==="armor"&&((n=e.tags)!=null&&n.length)?l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:e.tags.map(r=>l.jsx("span",{style:{padding:"1px 6px",borderRadius:999,border:"1px solid #e2e8f0",fontSize:10},children:r},r))}):null]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flexWrap:"wrap",justifyContent:"flex-end"},children:[(lm[e.id]||[]).map(r=>l.jsx("span",{style:{padding:"1px 6px",borderRadius:999,background:"#f1f5f9",border:"1px solid #e2e8f0",fontSize:11},children:r},r)),l.jsx(be,{size:"sm",variant:"ghost",onClick:t,style:{padding:"4px 6px"},children:"Remove"})]})]})}function Ga({label:e,value:t}){const n=$n(t/5*100,0,100);return l.jsxs("div",{style:{padding:12,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:8},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:e}),l.jsx("div",{style:{fontSize:18,fontWeight:600},children:t.toFixed(2)}),l.jsx(am,{value:n})]})}function h1({race:e,classes:t,loadout:n}){const[r,i]=k.useState(!1);return l.jsxs(Dn,{children:[l.jsx(Mn,{children:l.jsxs(zn,{children:[l.jsx(ru,{size:16,style:{marginRight:6}}),"Compare"]})}),l.jsxs(Rn,{children:[l.jsxs(be,{variant:"outline",onClick:()=>i(s=>!s),children:[r?"Close":"Open"," SidebySide Compare"]}),r?l.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[l.jsxs("div",{style:{padding:12,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:8},children:[l.jsx("div",{style:{fontWeight:600},children:"Race"}),l.jsx("div",{style:{fontSize:14},children:e.name}),l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:["Speed ",e.speed," ft"]}),l.jsx("div",{style:{display:"grid",gap:4},children:(e.traits||[]).map(s=>l.jsxs("div",{style:{fontSize:12},children:[" ",l.jsxs("span",{style:{fontWeight:600},children:[s.name,":"]})," ",s.text]},s.id))})]}),l.jsxs("div",{style:{padding:12,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:8},children:[l.jsx("div",{style:{fontWeight:600},children:"Classes"}),l.jsx("div",{style:{display:"grid",gap:4,fontSize:12,color:"#64748b"},children:t.map(s=>l.jsxs("div",{children:[" ",s.klass.name," ",s.level,s.subclass?` (${s.subclass.name})`:""]},s.klass.id))})]}),l.jsxs("div",{style:{padding:12,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:8},children:[l.jsx("div",{style:{fontWeight:600},children:"Loadout"}),l.jsx("div",{style:{display:"grid",gap:4,fontSize:14},children:n.map(s=>l.jsxs("div",{children:[" ",s.name]},s.id))})]})]}):null]})]})}function p1(e){const[t,n]=k.useState(!1),r=k.useRef(null),i=e.classes.reduce((g,m)=>g+m.level,0),s=20,o=Fr.filter(g=>!e.classes.some(m=>m.klass.id===g.id)).slice().sort((g,m)=>g.name.localeCompare(m.name)),a=i<s&&o.length>0;k.useEffect(()=>{if(!t)return;const g=S=>{r.current&&!r.current.contains(S.target)&&n(!1)},m=S=>{S.key==="Escape"&&n(!1)};return document.addEventListener("mousedown",g),document.addEventListener("touchstart",g),window.addEventListener("keydown",m),()=>{document.removeEventListener("mousedown",g),document.removeEventListener("touchstart",g),window.removeEventListener("keydown",m)}},[t]);function c(g,m){const S=i-e.classes[g].level,w=$n(m,1,Math.max(1,Math.min(s-S,20))),N=e.classes.map((d,p)=>{var x;return p===g?{...d,level:w,subclass:d.subclass&&w<(((x=d.subclass)==null?void 0:x.unlockLevel)||1/0)?void 0:d.subclass}:d});e.onChange(N)}function u(g){const m=e.classes.filter((S,w)=>w!==g);e.onChange(m.length?m:[{klass:Fr[0],level:1}])}function f(g){e.classes.some(S=>S.klass.id===g.id)||i>=s||(e.onChange([...e.classes,{klass:g,level:1}]),n(!1))}function h(g,m){const S=e.classes.map((w,N)=>N===g?{...w,subclass:m}:w);e.onChange(S)}return l.jsxs("div",{style:{display:"grid",gap:8},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsxs("div",{style:{fontSize:12,color:"#64748b",display:"flex",alignItems:"center"},children:["Classes (Total Level: ",l.jsx("strong",{children:i}),")"]}),l.jsxs("div",{style:{position:"relative"},ref:r,children:[l.jsx(be,{size:"sm",variant:"outline",onClick:()=>n(g=>!g),disabled:!a,children:"Add Class"}),t?l.jsx("div",{style:{position:"absolute",right:0,top:"100%",marginTop:6,background:"white",border:"1px solid #e2e8f0",borderRadius:8,boxShadow:"0 8px 16px rgba(15,23,42,0.12)",zIndex:20,minWidth:220},children:l.jsx("div",{style:{maxHeight:240,overflowY:"auto",display:"grid"},children:o.map(g=>l.jsx(be,{size:"sm",variant:"ghost",style:{width:"100%",justifyContent:"flex-start"},onClick:()=>f(g),children:g.name},g.id))})}):null]})]}),l.jsxs("div",{style:{display:"grid",gap:8,gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))"},children:[e.classes.map((g,m)=>{var S,w;return l.jsxs("div",{style:{padding:8,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",display:"grid",gap:6},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("div",{style:{fontWeight:600},children:g.klass.name}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx(be,{size:"icon",variant:"outline",onClick:()=>c(m,g.level-1),children:""}),l.jsx(Ft,{children:g.level}),l.jsx(be,{size:"icon",variant:"outline",onClick:()=>c(m,g.level+1),children:"+"})]})]}),l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>u(m),children:"Remove"})]}),(S=g.klass.subclasses)!=null&&S.length?l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Subclass"}),g.level<(((w=g.klass.subclasses[0])==null?void 0:w.unlockLevel)||1/0)?l.jsxs("span",{style:{fontSize:12,color:"#94a3b8"},children:["Unlocks at level ",Math.min(...g.klass.subclasses.map(N=>N.unlockLevel))]}):l.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[g.klass.subclasses.map(N=>{var d;return l.jsx(be,{size:"sm",variant:((d=g.subclass)==null?void 0:d.id)===N.id?"default":"outline",onClick:()=>h(m,N),children:N.name},N.id)}),g.subclass?l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>h(m,void 0),children:"Clear"}):null]})]}):null]},g.klass.id)}),e.classes.length===0&&l.jsx("div",{style:{gridColumn:"1 / -1",padding:8,borderRadius:12,border:"1px solid #e2e8f0",background:"#f8fafc",textAlign:"center",color:"#94a3b8"},children:'No classes added yet. Use "Add Class" to start building your character.'})]})]})}function g1(e){const[t,n]=k.useState(!1),[r,i]=k.useState(!1),[s,o]=k.useState(!1),[a,c]=k.useState(!1),[u,f]=k.useState(!1),h=v=>v?{background:"#4f46e5",color:"white",borderColor:"#4f46e5"}:{borderColor:"#4f46e5",color:"#4f46e5"},g=Xt.find(v=>v.id==="human"),m=Xt.find(v=>v.id==="human-variant"),S=Xt.find(v=>v.id==="elf-wood"),w=Xt.find(v=>v.id==="elf-high"),N=Xt.find(v=>v.id==="dwarf-hill"),d=Xt.find(v=>v.id==="dwarf-mountain"),p=Xt.find(v=>v.id==="halfling-lightfoot"),x=Xt.find(v=>v.id==="halfling-stout"),y=Xt.find(v=>v.id==="dragonborn"),C=Xt.filter(v=>v.id.startsWith("dragonborn-")),A=new Set(C.map(v=>v.id)),D=new Set(["human","human-variant","elf-wood","elf-high","dwarf-hill","dwarf-mountain","halfling-lightfoot","halfling-stout","dragonborn",...Array.from(A)]),R=Xt.filter(v=>!D.has(v.id)),P=e.value.id==="human"||e.value.id==="human-variant",F=e.value.id==="elf-wood"||e.value.id==="elf-high",G=e.value.id==="dwarf-hill"||e.value.id==="dwarf-mountain",J=e.value.id==="halfling-lightfoot"||e.value.id==="halfling-stout",B=e.value.id==="dragonborn"||e.value.id.startsWith("dragonborn-");return l.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[l.jsx(be,{size:"sm",variant:P?"default":"outline",onClick:()=>n(v=>!v),children:"Human"}),t&&l.jsxs(l.Fragment,{children:[l.jsx(be,{size:"sm",variant:e.value.id==="human"?"default":"outline",onClick:()=>e.onChange(g),style:h(e.value.id==="human"),children:"Base"}),l.jsx(be,{size:"sm",variant:e.value.id==="human-variant"?"default":"outline",onClick:()=>e.onChange(m),style:h(e.value.id==="human-variant"),children:"Variant"})]}),l.jsx(be,{size:"sm",variant:F?"default":"outline",onClick:()=>i(v=>!v),children:"Elf"}),r&&l.jsxs(l.Fragment,{children:[l.jsx(be,{size:"sm",variant:e.value.id==="elf-wood"?"default":"outline",onClick:()=>e.onChange(S),style:h(e.value.id==="elf-wood"),children:"Wood"}),l.jsx(be,{size:"sm",variant:e.value.id==="elf-high"?"default":"outline",onClick:()=>e.onChange(w),style:h(e.value.id==="elf-high"),children:"High"})]}),l.jsx(be,{size:"sm",variant:G?"default":"outline",onClick:()=>o(v=>!v),children:"Dwarf"}),s&&l.jsxs(l.Fragment,{children:[l.jsx(be,{size:"sm",variant:e.value.id==="dwarf-hill"?"default":"outline",onClick:()=>e.onChange(N),style:h(e.value.id==="dwarf-hill"),children:"Hill"}),l.jsx(be,{size:"sm",variant:e.value.id==="dwarf-mountain"?"default":"outline",onClick:()=>e.onChange(d),style:h(e.value.id==="dwarf-mountain"),children:"Mountain"})]}),l.jsx(be,{size:"sm",variant:J?"default":"outline",onClick:()=>c(v=>!v),children:"Halfling"}),a&&l.jsxs(l.Fragment,{children:[l.jsx(be,{size:"sm",variant:e.value.id==="halfling-lightfoot"?"default":"outline",onClick:()=>e.onChange(p),style:h(e.value.id==="halfling-lightfoot"),children:"Lightfoot"}),l.jsx(be,{size:"sm",variant:e.value.id==="halfling-stout"?"default":"outline",onClick:()=>e.onChange(x),style:h(e.value.id==="halfling-stout"),children:"Stout"})]}),l.jsx(be,{size:"sm",variant:B?"default":"outline",onClick:()=>f(v=>!v),children:"Dragonborn"}),u&&l.jsxs(l.Fragment,{children:[l.jsx(be,{size:"sm",variant:e.value.id==="dragonborn"?"default":"outline",onClick:()=>e.onChange(y),style:h(e.value.id==="dragonborn"),children:"Base"}),C.map(v=>{const j=v.name.replace(/^Dragonborn\s*\(/,"").replace(/\)$/,"");return l.jsx(be,{size:"sm",variant:e.value.id===v.id?"default":"outline",onClick:()=>e.onChange(v),style:h(e.value.id===v.id),children:j},v.id)})]}),R.map(v=>l.jsx(be,{size:"sm",variant:e.value.id===v.id?"default":"outline",onClick:()=>e.onChange(v),children:v.name},v.id))]})}function m1({skills:e,skillSources:t,race:n,raceReplPicks:r,classes:i,background:s}){const o=new Set((i||[]).flatMap(z=>{var ie;return((ie=ks[z.klass.id])==null?void 0:ie.options)||[]})),a=z=>(t[z]||[]).length>0,u=(n?(n.traits||[]).flatMap(z=>Il[z.id]||[]):[]).filter(z=>(t[z]||[]).some(ie=>ie!=="race"&&ie!=="race-pick"&&ie!=="manual")),f=z=>!n||u.length===0?!1:!(t[z]||[]).some(he=>he!=="race"&&he!=="race-pick"&&he!=="manual"),h=new Set;if(e.forEach(z=>{(a(z.id)||o.has(z.id)||f(z.id))&&h.add(z.id)}),h.size===0)return l.jsx("div",{style:{fontSize:12,color:"#94a3b8"},children:"No skills currently have sources or availability."});const g=z=>z==="manual"||z==="race-pick"||z.startsWith("class:"),m=Array.from(new Set(e.filter(z=>a(z.id)).flatMap(z=>t[z.id]||[]))),S=m.filter(z=>!g(z)),w=m.filter(z=>g(z)),N=z=>{var ie;if(z==="bg")return`Background${s!=null&&s.name?`: ${s.name}`:""}`;if(z==="race")return`Race${n!=null&&n.name?`: ${n.name}`:""}`;if(z==="race-pick")return"Race (replacement)";if(z==="manual")return"Manual";if(z.startsWith("class:")){const le=z.split(":")[1];return`Class: ${((ie=Fr.find(Te=>Te.id===le))==null?void 0:ie.name)||le}`}return z},d=16,p=256,x=32,y=160,C=160,A=d+y/2,D=A+p,R=D+p,P=[...S];n&&u.length>0&&!P.includes("race")&&P.push("race");const F=P.map((z,ie)=>({id:z,label:N(z),x:A,y:d+ie*x})),J=(i||[]).filter(z=>ks[z.klass.id]).map(z=>`class:${z.klass.id}`).map((z,ie)=>({id:z,label:N(z),x:A,y:d+(F.length+ie)*x})),B=[...F,...J],v={};B.forEach((z,ie)=>{v[z.id]=ie});const j=e.filter(z=>h.has(z.id)),E=z=>{const ie=[];return(t[z]||[]).forEach(le=>{g(le)||ie.push(le)}),(i||[]).forEach(le=>{const he=ks[le.klass.id];he&&he.options.includes(z)&&ie.push(`class:${le.klass.id}`)}),f(z)&&ie.push("race"),Array.from(new Set(ie))},L=j.map((z,ie)=>{const le=E(z.id).map(Te=>v[Te]).filter(Te=>typeof Te=="number"),he=le.length?le.reduce((Te,Q)=>Te+Q,0)/le.length:ie;return{s:z,key:he}});L.sort((z,ie)=>z.key-ie.key||z.s.name.localeCompare(ie.s.name));const _=L.map((z,ie)=>({id:z.s.id,label:z.s.name,x:D,y:d+ie*x})),b={};_.forEach((z,ie)=>{b[z.id]=ie});const M=w.map((z,ie)=>{const le=_.filter(Te=>(t[Te.id]||[]).includes(z)).map(Te=>b[Te.id]),he=le.length?le.reduce((Te,Q)=>Te+Q,0)/le.length:ie;return{key:z,avg:he}});M.sort((z,ie)=>z.avg-ie.avg||N(z.key).localeCompare(N(ie.key)));const W=M.map((z,ie)=>({id:z.key,label:N(z.key),x:R,y:d+ie*x})),H=[],re=[];_.forEach(z=>{(t[z.id]||[]).forEach(le=>{if(S.includes(le)){const he=B.find(Te=>Te.id===le);he&&H.push({sx:he.x+y/2,sy:he.y,tx:z.x-C/2,ty:z.y,key:`${le}->${z.id}`})}else if(w.includes(le)){const he=W.find(Te=>Te.id===le);he&&re.push({sx:z.x+C/2,sy:z.y,tx:he.x-y/2,ty:he.y,key:`${z.id}->${le}`})}})});const oe=R+y/2+d,ge=Math.max(B.length?B[B.length-1].y:0,_.length?_[_.length-1].y:0,W.length?W[W.length-1].y:0)+d,we=[];if(n){const ie=(n.traits||[]).flatMap(he=>Il[he.id]||[]).filter(he=>(t[he]||[]).some(Te=>Te!=="race"&&Te!=="race-pick"&&Te!=="manual")),le=B.find(he=>he.id==="race");le&&ie.length>0&&_.forEach(he=>{(t[he.id]||[]).some(Ae=>Ae!=="race"&&Ae!=="race-pick"&&Ae!=="manual")||we.push({sx:le.x+y/2,sy:le.y,tx:he.x-C/2,ty:he.y,key:`race~avail->${he.id}`})})}return i&&i.length&&i.forEach(z=>{const ie=`class:${z.klass.id}`,le=B.find(Te=>Te.id===ie),he=ks[z.klass.id];!le||!he||he.options.forEach(Te=>{const Q=_.find(Ae=>Ae.id===Te);Q&&we.push({sx:le.x+y/2,sy:le.y,tx:Q.x-C/2,ty:Q.y,key:`${ie}~avail->${Te}`})})}),l.jsx("div",{style:{width:"100%",overflowX:"auto"},children:l.jsxs("svg",{viewBox:`0 0 ${oe} ${ge}`,width:oe,height:ge,style:{display:"block",background:"#ffffff"},children:[H.map(z=>l.jsx("path",{d:`M ${z.sx} ${z.sy} C ${z.sx+24} ${z.sy}, ${z.tx-24} ${z.ty}, ${z.tx} ${z.ty}`,stroke:"#94a3b8",strokeWidth:1.5,fill:"none"},z.key)),we.map(z=>l.jsx("path",{d:`M ${z.sx} ${z.sy} C ${z.sx+24} ${z.sy}, ${z.tx-24} ${z.ty}, ${z.tx} ${z.ty}`,stroke:"#cbd5e1",strokeWidth:1.5,fill:"none",strokeDasharray:"4,4"},z.key)),re.map(z=>l.jsx("path",{d:`M ${z.sx} ${z.sy} C ${z.sx+24} ${z.sy}, ${z.tx-24} ${z.ty}, ${z.tx} ${z.ty}`,stroke:"#94a3b8",strokeWidth:1.5,fill:"none"},z.key)),B.map(z=>l.jsxs("g",{children:[l.jsx("rect",{x:z.x-y/2,y:z.y-12,width:y,height:24,rx:6,ry:6,fill:"#f1f5f9",stroke:"#e2e8f0"}),l.jsx("text",{x:z.x,y:z.y+4,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:z.label})]},z.id)),_.map(z=>{const ie=(t[z.id]||[]).length,le=ie>0,he=9,Te=z.x-C/2-he-6,Q=z.y,Ae=le?"#0ea5e9":"#f1f5f9",ve=le?"#0284c7":"#e2e8f0",Se=le?"#ffffff":"#0f172a";return l.jsxs("g",{children:[l.jsx("circle",{cx:Te,cy:Q,r:he,fill:"#e2e8f0",stroke:"#cbd5e1"}),l.jsx("text",{x:Te,y:Q+3,textAnchor:"middle",fontSize:"10",fill:"#0f172a",fontWeight:"600",children:ie}),l.jsx("rect",{x:z.x-C/2,y:z.y-12,width:C,height:24,rx:6,ry:6,fill:Ae,stroke:ve}),l.jsx("text",{x:z.x,y:z.y+4,textAnchor:"middle",fontSize:"11",fill:Se,children:z.label})]},z.id)}),W.map(z=>l.jsxs("g",{children:[l.jsx("rect",{x:z.x-y/2,y:z.y-12,width:y,height:24,rx:6,ry:6,fill:"#f1f5f9",stroke:"#e2e8f0"}),l.jsx("text",{x:z.x,y:z.y+4,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:z.label})]},z.id))]})})}function Mt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Mt(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var cm={exports:{}},um={},dm={exports:{}},fm={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gi=k;function y1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var x1=typeof Object.is=="function"?Object.is:y1,v1=Gi.useState,w1=Gi.useEffect,S1=Gi.useLayoutEffect,k1=Gi.useDebugValue;function b1(e,t){var n=t(),r=v1({inst:{value:n,getSnapshot:t}}),i=r[0].inst,s=r[1];return S1(function(){i.value=n,i.getSnapshot=t,Ka(i)&&s({inst:i})},[e,n,t]),w1(function(){return Ka(i)&&s({inst:i}),e(function(){Ka(i)&&s({inst:i})})},[e]),k1(n),n}function Ka(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!x1(e,n)}catch{return!0}}function C1(e,t){return t()}var j1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?C1:b1;fm.useSyncExternalStore=Gi.useSyncExternalStore!==void 0?Gi.useSyncExternalStore:j1;dm.exports=fm;var E1=dm.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ua=k,_1=E1;function N1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var A1=typeof Object.is=="function"?Object.is:N1,D1=_1.useSyncExternalStore,M1=ua.useRef,z1=ua.useEffect,R1=ua.useMemo,P1=ua.useDebugValue;um.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var s=M1(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=R1(function(){function c(m){if(!u){if(u=!0,f=m,m=r(m),i!==void 0&&o.hasValue){var S=o.value;if(i(S,m))return h=S}return h=m}if(S=h,A1(f,m))return S;var w=r(m);return i!==void 0&&i(S,w)?(f=m,S):(f=m,h=w)}var u=!1,f,h,g=n===void 0?null:n;return[function(){return c(t())},g===null?void 0:function(){return c(g())}]},[t,n,r,i]);var a=D1(e,s[0],s[1]);return z1(function(){o.hasValue=!0,o.value=a},[a]),P1(a),a};cm.exports=um;var T1=cm.exports;const I1=Vh(T1),$1={},Xf=e=>{let t;const n=new Set,r=(f,h)=>{const g=typeof f=="function"?f(t):f;if(!Object.is(g,t)){const m=t;t=h??(typeof g!="object"||g===null)?g:Object.assign({},t,g),n.forEach(S=>S(t,m))}},i=()=>t,c={setState:r,getState:i,getInitialState:()=>u,subscribe:f=>(n.add(f),()=>n.delete(f)),destroy:()=>{($1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,i,c);return c},L1=e=>e?Xf(e):Xf,{useDebugValue:O1}=V,{useSyncExternalStoreWithSelector:B1}=I1,F1=e=>e;function hm(e,t=F1,n){const r=B1(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return O1(r),r}const Qf=(e,t)=>{const n=L1(e),r=(i,s=t)=>hm(n,i,s);return Object.assign(r,n),r},H1=(e,t)=>e?Qf(e,t):Qf;function jt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var W1={value:()=>{}};function da(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new al(n)}function al(e){this._=e}function U1(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}al.prototype=da.prototype={constructor:al,on:function(e,t){var n=this._,r=U1(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=V1(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=Jf(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Jf(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new al(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function V1(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Jf(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=W1,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var ou="http://www.w3.org/1999/xhtml";const Zf={svg:"http://www.w3.org/2000/svg",xhtml:ou,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function fa(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Zf.hasOwnProperty(t)?{space:Zf[t],local:e}:e}function Y1(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ou&&t.documentElement.namespaceURI===ou?t.createElement(e):t.createElementNS(n,e)}}function G1(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function pm(e){var t=fa(e);return(t.local?G1:Y1)(t)}function K1(){}function yd(e){return e==null?K1:function(){return this.querySelector(e)}}function X1(e){typeof e!="function"&&(e=yd(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),c,u,f=0;f<o;++f)(c=s[f])&&(u=e.call(c,c.__data__,f,s))&&("__data__"in c&&(u.__data__=c.__data__),a[f]=u);return new en(r,this._parents)}function Q1(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function J1(){return[]}function gm(e){return e==null?J1:function(){return this.querySelectorAll(e)}}function Z1(e){return function(){return Q1(e.apply(this,arguments))}}function q1(e){typeof e=="function"?e=Z1(e):e=gm(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],a=o.length,c,u=0;u<a;++u)(c=o[u])&&(r.push(e.call(c,c.__data__,u,o)),i.push(c));return new en(r,i)}function mm(e){return function(){return this.matches(e)}}function ym(e){return function(t){return t.matches(e)}}var ew=Array.prototype.find;function tw(e){return function(){return ew.call(this.children,e)}}function nw(){return this.firstElementChild}function rw(e){return this.select(e==null?nw:tw(typeof e=="function"?e:ym(e)))}var iw=Array.prototype.filter;function sw(){return Array.from(this.children)}function ow(e){return function(){return iw.call(this.children,e)}}function lw(e){return this.selectAll(e==null?sw:ow(typeof e=="function"?e:ym(e)))}function aw(e){typeof e!="function"&&(e=mm(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],c,u=0;u<o;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&a.push(c);return new en(r,this._parents)}function xm(e){return new Array(e.length)}function cw(){return new en(this._enter||this._groups.map(xm),this._parents)}function $l(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}$l.prototype={constructor:$l,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function uw(e){return function(){return e}}function dw(e,t,n,r,i,s){for(var o=0,a,c=t.length,u=s.length;o<u;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):n[o]=new $l(e,s[o]);for(;o<c;++o)(a=t[o])&&(i[o]=a)}function fw(e,t,n,r,i,s,o){var a,c,u=new Map,f=t.length,h=s.length,g=new Array(f),m;for(a=0;a<f;++a)(c=t[a])&&(g[a]=m=o.call(c,c.__data__,a,t)+"",u.has(m)?i[a]=c:u.set(m,c));for(a=0;a<h;++a)m=o.call(e,s[a],a,s)+"",(c=u.get(m))?(r[a]=c,c.__data__=s[a],u.delete(m)):n[a]=new $l(e,s[a]);for(a=0;a<f;++a)(c=t[a])&&u.get(g[a])===c&&(i[a]=c)}function hw(e){return e.__data__}function pw(e,t){if(!arguments.length)return Array.from(this,hw);var n=t?fw:dw,r=this._parents,i=this._groups;typeof e!="function"&&(e=uw(e));for(var s=i.length,o=new Array(s),a=new Array(s),c=new Array(s),u=0;u<s;++u){var f=r[u],h=i[u],g=h.length,m=gw(e.call(f,f&&f.__data__,u,r)),S=m.length,w=a[u]=new Array(S),N=o[u]=new Array(S),d=c[u]=new Array(g);n(f,h,w,N,d,m,t);for(var p=0,x=0,y,C;p<S;++p)if(y=w[p]){for(p>=x&&(x=p+1);!(C=N[x])&&++x<S;);y._next=C||null}}return o=new en(o,r),o._enter=a,o._exit=c,o}function gw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function mw(){return new en(this._exit||this._groups.map(xm),this._parents)}function yw(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function xw(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),c=0;c<o;++c)for(var u=n[c],f=r[c],h=u.length,g=a[c]=new Array(h),m,S=0;S<h;++S)(m=u[S]||f[S])&&(g[S]=m);for(;c<i;++c)a[c]=n[c];return new en(a,this._parents)}function vw(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function ww(e){e||(e=Sw);function t(h,g){return h&&g?e(h.__data__,g.__data__):!h-!g}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,c=i[s]=new Array(a),u,f=0;f<a;++f)(u=o[f])&&(c[f]=u);c.sort(t)}return new en(i,this._parents).order()}function Sw(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function kw(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function bw(){return Array.from(this)}function Cw(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function jw(){let e=0;for(const t of this)++e;return e}function Ew(){return!this.node()}function _w(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&e.call(a,a.__data__,s,i);return this}function Nw(e){return function(){this.removeAttribute(e)}}function Aw(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Dw(e,t){return function(){this.setAttribute(e,t)}}function Mw(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function zw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Rw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Pw(e,t){var n=fa(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Aw:Nw:typeof t=="function"?n.local?Rw:zw:n.local?Mw:Dw)(n,t))}function vm(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Tw(e){return function(){this.style.removeProperty(e)}}function Iw(e,t,n){return function(){this.style.setProperty(e,t,n)}}function $w(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Lw(e,t,n){return arguments.length>1?this.each((t==null?Tw:typeof t=="function"?$w:Iw)(e,t,n??"")):Ki(this.node(),e)}function Ki(e,t){return e.style.getPropertyValue(t)||vm(e).getComputedStyle(e,null).getPropertyValue(t)}function Ow(e){return function(){delete this[e]}}function Bw(e,t){return function(){this[e]=t}}function Fw(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Hw(e,t){return arguments.length>1?this.each((t==null?Ow:typeof t=="function"?Fw:Bw)(e,t)):this.node()[e]}function wm(e){return e.trim().split(/^|\s+/)}function xd(e){return e.classList||new Sm(e)}function Sm(e){this._node=e,this._names=wm(e.getAttribute("class")||"")}Sm.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function km(e,t){for(var n=xd(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function bm(e,t){for(var n=xd(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Ww(e){return function(){km(this,e)}}function Uw(e){return function(){bm(this,e)}}function Vw(e,t){return function(){(t.apply(this,arguments)?km:bm)(this,e)}}function Yw(e,t){var n=wm(e+"");if(arguments.length<2){for(var r=xd(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Vw:t?Ww:Uw)(n,t))}function Gw(){this.textContent=""}function Kw(e){return function(){this.textContent=e}}function Xw(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Qw(e){return arguments.length?this.each(e==null?Gw:(typeof e=="function"?Xw:Kw)(e)):this.node().textContent}function Jw(){this.innerHTML=""}function Zw(e){return function(){this.innerHTML=e}}function qw(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function eS(e){return arguments.length?this.each(e==null?Jw:(typeof e=="function"?qw:Zw)(e)):this.node().innerHTML}function tS(){this.nextSibling&&this.parentNode.appendChild(this)}function nS(){return this.each(tS)}function rS(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function iS(){return this.each(rS)}function sS(e){var t=typeof e=="function"?e:pm(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function oS(){return null}function lS(e,t){var n=typeof e=="function"?e:pm(e),r=t==null?oS:typeof t=="function"?t:yd(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function aS(){var e=this.parentNode;e&&e.removeChild(this)}function cS(){return this.each(aS)}function uS(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function dS(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fS(e){return this.select(e?dS:uS)}function hS(e){return arguments.length?this.property("__data__",e):this.node().__data__}function pS(e){return function(t){e.call(this,t,this.__data__)}}function gS(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function mS(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function yS(e,t,n){return function(){var r=this.__on,i,s=pS(t);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function xS(e,t,n){var r=gS(e+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,f;c<u;++c)for(i=0,f=a[c];i<s;++i)if((o=r[i]).type===f.type&&o.name===f.name)return f.value}return}for(a=t?yS:mS,i=0;i<s;++i)this.each(a(r[i],t,n));return this}function Cm(e,t,n){var r=vm(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function vS(e,t){return function(){return Cm(this,e,t)}}function wS(e,t){return function(){return Cm(this,e,t.apply(this,arguments))}}function SS(e,t){return this.each((typeof t=="function"?wS:vS)(e,t))}function*kS(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var jm=[null];function en(e,t){this._groups=e,this._parents=t}function mo(){return new en([[document.documentElement]],jm)}function bS(){return this}en.prototype=mo.prototype={constructor:en,select:X1,selectAll:q1,selectChild:rw,selectChildren:lw,filter:aw,data:pw,enter:cw,exit:mw,join:yw,merge:xw,selection:bS,order:vw,sort:ww,call:kw,nodes:bw,node:Cw,size:jw,empty:Ew,each:_w,attr:Pw,style:Lw,property:Hw,classed:Yw,text:Qw,html:eS,raise:nS,lower:iS,append:sS,insert:lS,remove:cS,clone:fS,datum:hS,on:xS,dispatch:SS,[Symbol.iterator]:kS};function ln(e){return typeof e=="string"?new en([[document.querySelector(e)]],[document.documentElement]):new en([[e]],jm)}function CS(e){let t;for(;t=e.sourceEvent;)e=t;return e}function vn(e,t){if(e=CS(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const jS={passive:!1},no={capture:!0,passive:!1};function Xa(e){e.stopImmediatePropagation()}function Ii(e){e.preventDefault(),e.stopImmediatePropagation()}function Em(e){var t=e.document.documentElement,n=ln(e).on("dragstart.drag",Ii,no);"onselectstart"in t?n.on("selectstart.drag",Ii,no):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function _m(e,t){var n=e.document.documentElement,r=ln(e).on("dragstart.drag",null);t&&(r.on("click.drag",Ii,no),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Io=e=>()=>e;function lu(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:c,dy:u,dispatch:f}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:f}})}lu.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function ES(e){return!e.ctrlKey&&!e.button}function _S(){return this.parentNode}function NS(e,t){return t??{x:e.x,y:e.y}}function AS(){return navigator.maxTouchPoints||"ontouchstart"in this}function DS(){var e=ES,t=_S,n=NS,r=AS,i={},s=da("start","drag","end"),o=0,a,c,u,f,h=0;function g(y){y.on("mousedown.drag",m).filter(r).on("touchstart.drag",N).on("touchmove.drag",d,jS).on("touchend.drag touchcancel.drag",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(y,C){if(!(f||!e.call(this,y,C))){var A=x(this,t.call(this,y,C),y,C,"mouse");A&&(ln(y.view).on("mousemove.drag",S,no).on("mouseup.drag",w,no),Em(y.view),Xa(y),u=!1,a=y.clientX,c=y.clientY,A("start",y))}}function S(y){if(Ii(y),!u){var C=y.clientX-a,A=y.clientY-c;u=C*C+A*A>h}i.mouse("drag",y)}function w(y){ln(y.view).on("mousemove.drag mouseup.drag",null),_m(y.view,u),Ii(y),i.mouse("end",y)}function N(y,C){if(e.call(this,y,C)){var A=y.changedTouches,D=t.call(this,y,C),R=A.length,P,F;for(P=0;P<R;++P)(F=x(this,D,y,C,A[P].identifier,A[P]))&&(Xa(y),F("start",y,A[P]))}}function d(y){var C=y.changedTouches,A=C.length,D,R;for(D=0;D<A;++D)(R=i[C[D].identifier])&&(Ii(y),R("drag",y,C[D]))}function p(y){var C=y.changedTouches,A=C.length,D,R;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),D=0;D<A;++D)(R=i[C[D].identifier])&&(Xa(y),R("end",y,C[D]))}function x(y,C,A,D,R,P){var F=s.copy(),G=vn(P||A,C),J,B,v;if((v=n.call(y,new lu("beforestart",{sourceEvent:A,target:g,identifier:R,active:o,x:G[0],y:G[1],dx:0,dy:0,dispatch:F}),D))!=null)return J=v.x-G[0]||0,B=v.y-G[1]||0,function j(E,L,_){var b=G,M;switch(E){case"start":i[R]=j,M=o++;break;case"end":delete i[R],--o;case"drag":G=vn(_||L,C),M=o;break}F.call(E,y,new lu(E,{sourceEvent:L,subject:v,target:g,identifier:R,active:M,x:G[0]+J,y:G[1]+B,dx:G[0]-b[0],dy:G[1]-b[1],dispatch:F}),D)}}return g.filter=function(y){return arguments.length?(e=typeof y=="function"?y:Io(!!y),g):e},g.container=function(y){return arguments.length?(t=typeof y=="function"?y:Io(y),g):t},g.subject=function(y){return arguments.length?(n=typeof y=="function"?y:Io(y),g):n},g.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:Io(!!y),g):r},g.on=function(){var y=s.on.apply(s,arguments);return y===s?g:y},g.clickDistance=function(y){return arguments.length?(h=(y=+y)*y,g):Math.sqrt(h)},g}function vd(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Nm(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function yo(){}var ro=.7,Ll=1/ro,$i="\\s*([+-]?\\d+)\\s*",io="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",MS=/^#([0-9a-f]{3,8})$/,zS=new RegExp(`^rgb\\(${$i},${$i},${$i}\\)$`),RS=new RegExp(`^rgb\\(${Fn},${Fn},${Fn}\\)$`),PS=new RegExp(`^rgba\\(${$i},${$i},${$i},${io}\\)$`),TS=new RegExp(`^rgba\\(${Fn},${Fn},${Fn},${io}\\)$`),IS=new RegExp(`^hsl\\(${io},${Fn},${Fn}\\)$`),$S=new RegExp(`^hsla\\(${io},${Fn},${Fn},${io}\\)$`),qf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vd(yo,so,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:eh,formatHex:eh,formatHex8:LS,formatHsl:OS,formatRgb:th,toString:th});function eh(){return this.rgb().formatHex()}function LS(){return this.rgb().formatHex8()}function OS(){return Am(this).formatHsl()}function th(){return this.rgb().formatRgb()}function so(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=MS.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?nh(t):n===3?new Ut(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$o(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$o(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=zS.exec(e))?new Ut(t[1],t[2],t[3],1):(t=RS.exec(e))?new Ut(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=PS.exec(e))?$o(t[1],t[2],t[3],t[4]):(t=TS.exec(e))?$o(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=IS.exec(e))?sh(t[1],t[2]/100,t[3]/100,1):(t=$S.exec(e))?sh(t[1],t[2]/100,t[3]/100,t[4]):qf.hasOwnProperty(e)?nh(qf[e]):e==="transparent"?new Ut(NaN,NaN,NaN,0):null}function nh(e){return new Ut(e>>16&255,e>>8&255,e&255,1)}function $o(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ut(e,t,n,r)}function BS(e){return e instanceof yo||(e=so(e)),e?(e=e.rgb(),new Ut(e.r,e.g,e.b,e.opacity)):new Ut}function au(e,t,n,r){return arguments.length===1?BS(e):new Ut(e,t,n,r??1)}function Ut(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}vd(Ut,au,Nm(yo,{brighter(e){return e=e==null?Ll:Math.pow(Ll,e),new Ut(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ro:Math.pow(ro,e),new Ut(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ut(Yr(this.r),Yr(this.g),Yr(this.b),Ol(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rh,formatHex:rh,formatHex8:FS,formatRgb:ih,toString:ih}));function rh(){return`#${Hr(this.r)}${Hr(this.g)}${Hr(this.b)}`}function FS(){return`#${Hr(this.r)}${Hr(this.g)}${Hr(this.b)}${Hr((isNaN(this.opacity)?1:this.opacity)*255)}`}function ih(){const e=Ol(this.opacity);return`${e===1?"rgb(":"rgba("}${Yr(this.r)}, ${Yr(this.g)}, ${Yr(this.b)}${e===1?")":`, ${e})`}`}function Ol(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Yr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Hr(e){return e=Yr(e),(e<16?"0":"")+e.toString(16)}function sh(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Sn(e,t,n,r)}function Am(e){if(e instanceof Sn)return new Sn(e.h,e.s,e.l,e.opacity);if(e instanceof yo||(e=so(e)),!e)return new Sn;if(e instanceof Sn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,c=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=c<.5?s+i:2-s-i,o*=60):a=c>0&&c<1?0:o,new Sn(o,a,c,e.opacity)}function HS(e,t,n,r){return arguments.length===1?Am(e):new Sn(e,t,n,r??1)}function Sn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}vd(Sn,HS,Nm(yo,{brighter(e){return e=e==null?Ll:Math.pow(Ll,e),new Sn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ro:Math.pow(ro,e),new Sn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Ut(Qa(e>=240?e-240:e+120,i,r),Qa(e,i,r),Qa(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Sn(oh(this.h),Lo(this.s),Lo(this.l),Ol(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ol(this.opacity);return`${e===1?"hsl(":"hsla("}${oh(this.h)}, ${Lo(this.s)*100}%, ${Lo(this.l)*100}%${e===1?")":`, ${e})`}`}}));function oh(e){return e=(e||0)%360,e<0?e+360:e}function Lo(e){return Math.max(0,Math.min(1,e||0))}function Qa(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Dm=e=>()=>e;function WS(e,t){return function(n){return e+n*t}}function US(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function VS(e){return(e=+e)==1?Mm:function(t,n){return n-t?US(t,n,e):Dm(isNaN(t)?n:t)}}function Mm(e,t){var n=t-e;return n?WS(e,n):Dm(isNaN(e)?t:e)}const lh=function e(t){var n=VS(t);function r(i,s){var o=n((i=au(i)).r,(s=au(s)).r),a=n(i.g,s.g),c=n(i.b,s.b),u=Mm(i.opacity,s.opacity);return function(f){return i.r=o(f),i.g=a(f),i.b=c(f),i.opacity=u(f),i+""}}return r.gamma=e,r}(1);function ur(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var cu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ja=new RegExp(cu.source,"g");function YS(e){return function(){return e}}function GS(e){return function(t){return e(t)+""}}function KS(e,t){var n=cu.lastIndex=Ja.lastIndex=0,r,i,s,o=-1,a=[],c=[];for(e=e+"",t=t+"";(r=cu.exec(e))&&(i=Ja.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,c.push({i:o,x:ur(r,i)})),n=Ja.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?GS(c[0].x):YS(t):(t=c.length,function(u){for(var f=0,h;f<t;++f)a[(h=c[f]).i]=h.x(u);return a.join("")})}var ah=180/Math.PI,uu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function zm(e,t,n,r,i,s){var o,a,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*ah,skewX:Math.atan(c)*ah,scaleX:o,scaleY:a}}var Oo;function XS(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?uu:zm(t.a,t.b,t.c,t.d,t.e,t.f)}function QS(e){return e==null||(Oo||(Oo=document.createElementNS("http://www.w3.org/2000/svg","g")),Oo.setAttribute("transform",e),!(e=Oo.transform.baseVal.consolidate()))?uu:(e=e.matrix,zm(e.a,e.b,e.c,e.d,e.e,e.f))}function Rm(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,f,h,g,m,S){if(u!==h||f!==g){var w=m.push("translate(",null,t,null,n);S.push({i:w-4,x:ur(u,h)},{i:w-2,x:ur(f,g)})}else(h||g)&&m.push("translate("+h+t+g+n)}function o(u,f,h,g){u!==f?(u-f>180?f+=360:f-u>180&&(u+=360),g.push({i:h.push(i(h)+"rotate(",null,r)-2,x:ur(u,f)})):f&&h.push(i(h)+"rotate("+f+r)}function a(u,f,h,g){u!==f?g.push({i:h.push(i(h)+"skewX(",null,r)-2,x:ur(u,f)}):f&&h.push(i(h)+"skewX("+f+r)}function c(u,f,h,g,m,S){if(u!==h||f!==g){var w=m.push(i(m)+"scale(",null,",",null,")");S.push({i:w-4,x:ur(u,h)},{i:w-2,x:ur(f,g)})}else(h!==1||g!==1)&&m.push(i(m)+"scale("+h+","+g+")")}return function(u,f){var h=[],g=[];return u=e(u),f=e(f),s(u.translateX,u.translateY,f.translateX,f.translateY,h,g),o(u.rotate,f.rotate,h,g),a(u.skewX,f.skewX,h,g),c(u.scaleX,u.scaleY,f.scaleX,f.scaleY,h,g),u=f=null,function(m){for(var S=-1,w=g.length,N;++S<w;)h[(N=g[S]).i]=N.x(m);return h.join("")}}}var JS=Rm(XS,"px, ","px)","deg)"),ZS=Rm(QS,", ",")",")"),qS=1e-12;function ch(e){return((e=Math.exp(e))+1/e)/2}function ek(e){return((e=Math.exp(e))-1/e)/2}function tk(e){return((e=Math.exp(2*e))-1)/(e+1)}const nk=function e(t,n,r){function i(s,o){var a=s[0],c=s[1],u=s[2],f=o[0],h=o[1],g=o[2],m=f-a,S=h-c,w=m*m+S*S,N,d;if(w<qS)d=Math.log(g/u)/t,N=function(D){return[a+D*m,c+D*S,u*Math.exp(t*D*d)]};else{var p=Math.sqrt(w),x=(g*g-u*u+r*w)/(2*u*n*p),y=(g*g-u*u-r*w)/(2*g*n*p),C=Math.log(Math.sqrt(x*x+1)-x),A=Math.log(Math.sqrt(y*y+1)-y);d=(A-C)/t,N=function(D){var R=D*d,P=ch(C),F=u/(n*p)*(P*tk(t*R+C)-ek(C));return[a+F*m,c+F*S,u*P/ch(t*R+C)]}}return N.duration=d*1e3*t/Math.SQRT2,N}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,c=a*a;return e(o,a,c)},i}(Math.SQRT2,2,4);var Xi=0,bs=0,ds=0,Pm=1e3,Bl,Cs,Fl=0,ei=0,ha=0,oo=typeof performance=="object"&&performance.now?performance:Date,Tm=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function wd(){return ei||(Tm(rk),ei=oo.now()+ha)}function rk(){ei=0}function Hl(){this._call=this._time=this._next=null}Hl.prototype=Im.prototype={constructor:Hl,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?wd():+n)+(t==null?0:+t),!this._next&&Cs!==this&&(Cs?Cs._next=this:Bl=this,Cs=this),this._call=e,this._time=n,du()},stop:function(){this._call&&(this._call=null,this._time=1/0,du())}};function Im(e,t,n){var r=new Hl;return r.restart(e,t,n),r}function ik(){wd(),++Xi;for(var e=Bl,t;e;)(t=ei-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Xi}function uh(){ei=(Fl=oo.now())+ha,Xi=bs=0;try{ik()}finally{Xi=0,ok(),ei=0}}function sk(){var e=oo.now(),t=e-Fl;t>Pm&&(ha-=t,Fl=e)}function ok(){for(var e,t=Bl,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Bl=n);Cs=e,du(r)}function du(e){if(!Xi){bs&&(bs=clearTimeout(bs));var t=e-ei;t>24?(e<1/0&&(bs=setTimeout(uh,e-oo.now()-ha)),ds&&(ds=clearInterval(ds))):(ds||(Fl=oo.now(),ds=setInterval(sk,Pm)),Xi=1,Tm(uh))}}function dh(e,t,n){var r=new Hl;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var lk=da("start","end","cancel","interrupt"),ak=[],$m=0,fh=1,fu=2,cl=3,hh=4,hu=5,ul=6;function pa(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;ck(e,n,{name:t,index:r,group:i,on:lk,tween:ak,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:$m})}function Sd(e,t){var n=En(e,t);if(n.state>$m)throw new Error("too late; already scheduled");return n}function Hn(e,t){var n=En(e,t);if(n.state>cl)throw new Error("too late; already running");return n}function En(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function ck(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Im(s,0,n.time);function s(u){n.state=fh,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var f,h,g,m;if(n.state!==fh)return c();for(f in r)if(m=r[f],m.name===n.name){if(m.state===cl)return dh(o);m.state===hh?(m.state=ul,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[f]):+f<t&&(m.state=ul,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[f])}if(dh(function(){n.state===cl&&(n.state=hh,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=fu,n.on.call("start",e,e.__data__,n.index,n.group),n.state===fu){for(n.state=cl,i=new Array(g=n.tween.length),f=0,h=-1;f<g;++f)(m=n.tween[f].value.call(e,e.__data__,n.index,n.group))&&(i[++h]=m);i.length=h+1}}function a(u){for(var f=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=hu,1),h=-1,g=i.length;++h<g;)i[h].call(e,f);n.state===hu&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=ul,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function dl(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>fu&&r.state<hu,r.state=ul,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function uk(e){return this.each(function(){dl(this,e)})}function dk(e,t){var n,r;return function(){var i=Hn(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function fk(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Hn(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:t,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===t){i[c]=a;break}c===u&&i.push(a)}s.tween=i}}function hk(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=En(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?dk:fk)(n,e,t))}function kd(e,t,n){var r=e._id;return e.each(function(){var i=Hn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return En(i,r).value[t]}}function Lm(e,t){var n;return(typeof t=="number"?ur:t instanceof so?lh:(n=so(t))?(t=n,lh):KS)(e,t)}function pk(e){return function(){this.removeAttribute(e)}}function gk(e){return function(){this.removeAttributeNS(e.space,e.local)}}function mk(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function yk(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function xk(e,t,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a)))}}function vk(e,t,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a)))}}function wk(e,t){var n=fa(e),r=n==="transform"?ZS:Lm;return this.attrTween(e,typeof t=="function"?(n.local?vk:xk)(n,r,kd(this,"attr."+e,t)):t==null?(n.local?gk:pk)(n):(n.local?yk:mk)(n,r,t))}function Sk(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function kk(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function bk(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&kk(e,s)),n}return i._value=t,i}function Ck(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Sk(e,s)),n}return i._value=t,i}function jk(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=fa(e);return this.tween(n,(r.local?bk:Ck)(r,t))}function Ek(e,t){return function(){Sd(this,e).delay=+t.apply(this,arguments)}}function _k(e,t){return t=+t,function(){Sd(this,e).delay=t}}function Nk(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ek:_k)(t,e)):En(this.node(),t).delay}function Ak(e,t){return function(){Hn(this,e).duration=+t.apply(this,arguments)}}function Dk(e,t){return t=+t,function(){Hn(this,e).duration=t}}function Mk(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ak:Dk)(t,e)):En(this.node(),t).duration}function zk(e,t){if(typeof t!="function")throw new Error;return function(){Hn(this,e).ease=t}}function Rk(e){var t=this._id;return arguments.length?this.each(zk(t,e)):En(this.node(),t).ease}function Pk(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Hn(this,e).ease=n}}function Tk(e){if(typeof e!="function")throw new Error;return this.each(Pk(this._id,e))}function Ik(e){typeof e!="function"&&(e=mm(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],c,u=0;u<o;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&a.push(c);return new nr(r,this._parents,this._name,this._id)}function $k(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var c=t[a],u=n[a],f=c.length,h=o[a]=new Array(f),g,m=0;m<f;++m)(g=c[m]||u[m])&&(h[m]=g);for(;a<r;++a)o[a]=t[a];return new nr(o,this._parents,this._name,this._id)}function Lk(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Ok(e,t,n){var r,i,s=Lk(t)?Sd:Hn;return function(){var o=s(this,e),a=o.on;a!==r&&(i=(r=a).copy()).on(t,n),o.on=i}}function Bk(e,t){var n=this._id;return arguments.length<2?En(this.node(),n).on.on(e):this.each(Ok(n,e,t))}function Fk(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Hk(){return this.on("end.remove",Fk(this._id))}function Wk(e){var t=this._name,n=this._id;typeof e!="function"&&(e=yd(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],c=a.length,u=s[o]=new Array(c),f,h,g=0;g<c;++g)(f=a[g])&&(h=e.call(f,f.__data__,g,a))&&("__data__"in f&&(h.__data__=f.__data__),u[g]=h,pa(u[g],t,n,g,u,En(f,n)));return new nr(s,this._parents,t,n)}function Uk(e){var t=this._name,n=this._id;typeof e!="function"&&(e=gm(e));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var c=r[a],u=c.length,f,h=0;h<u;++h)if(f=c[h]){for(var g=e.call(f,f.__data__,h,c),m,S=En(f,n),w=0,N=g.length;w<N;++w)(m=g[w])&&pa(m,t,n,w,g,S);s.push(g),o.push(f)}return new nr(s,o,t,n)}var Vk=mo.prototype.constructor;function Yk(){return new Vk(this._groups,this._parents)}function Gk(e,t){var n,r,i;return function(){var s=Ki(this,e),o=(this.style.removeProperty(e),Ki(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function Om(e){return function(){this.style.removeProperty(e)}}function Kk(e,t,n){var r,i=n+"",s;return function(){var o=Ki(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function Xk(e,t,n){var r,i,s;return function(){var o=Ki(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Ki(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a))}}function Qk(e,t){var n,r,i,s="style."+t,o="end."+s,a;return function(){var c=Hn(this,e),u=c.on,f=c.value[s]==null?a||(a=Om(t)):void 0;(u!==n||i!==f)&&(r=(n=u).copy()).on(o,i=f),c.on=r}}function Jk(e,t,n){var r=(e+="")=="transform"?JS:Lm;return t==null?this.styleTween(e,Gk(e,r)).on("end.style."+e,Om(e)):typeof t=="function"?this.styleTween(e,Xk(e,r,kd(this,"style."+e,t))).each(Qk(this._id,e)):this.styleTween(e,Kk(e,r,t),n).on("end.style."+e,null)}function Zk(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function qk(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&Zk(e,o,n)),r}return s._value=t,s}function e2(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,qk(e,t,n??""))}function t2(e){return function(){this.textContent=e}}function n2(e){return function(){var t=e(this);this.textContent=t??""}}function r2(e){return this.tween("text",typeof e=="function"?n2(kd(this,"text",e)):t2(e==null?"":e+""))}function i2(e){return function(t){this.textContent=e.call(this,t)}}function s2(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&i2(i)),t}return r._value=e,r}function o2(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,s2(e))}function l2(){for(var e=this._name,t=this._id,n=Bm(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,u=0;u<a;++u)if(c=o[u]){var f=En(c,t);pa(c,e,n,u,o,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new nr(r,this._parents,e,n)}function a2(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var u=Hn(this,r),f=u.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),i===0&&s()})}var c2=0;function nr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Bm(){return++c2}var Wn=mo.prototype;nr.prototype={constructor:nr,select:Wk,selectAll:Uk,selectChild:Wn.selectChild,selectChildren:Wn.selectChildren,filter:Ik,merge:$k,selection:Yk,transition:l2,call:Wn.call,nodes:Wn.nodes,node:Wn.node,size:Wn.size,empty:Wn.empty,each:Wn.each,on:Bk,attr:wk,attrTween:jk,style:Jk,styleTween:e2,text:r2,textTween:o2,remove:Hk,tween:hk,delay:Nk,duration:Mk,ease:Rk,easeVarying:Tk,end:a2,[Symbol.iterator]:Wn[Symbol.iterator]};function u2(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var d2={time:null,delay:0,duration:250,ease:u2};function f2(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function h2(e){var t,n;e instanceof nr?(t=e._id,e=e._name):(t=Bm(),(n=d2).time=wd(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,u=0;u<a;++u)(c=o[u])&&pa(c,e,t,u,o,n||f2(c,t));return new nr(r,this._parents,e,t)}mo.prototype.interrupt=uk;mo.prototype.transition=h2;const Bo=e=>()=>e;function p2(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Xn(e,t,n){this.k=e,this.x=t,this.y=n}Xn.prototype={constructor:Xn,scale:function(e){return e===1?this:new Xn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Xn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Jn=new Xn(1,0,0);Xn.prototype;function Za(e){e.stopImmediatePropagation()}function fs(e){e.preventDefault(),e.stopImmediatePropagation()}function g2(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function m2(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ph(){return this.__zoom||Jn}function y2(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function x2(){return navigator.maxTouchPoints||"ontouchstart"in this}function v2(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function Fm(){var e=g2,t=m2,n=v2,r=y2,i=x2,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,c=nk,u=da("start","zoom","end"),f,h,g,m=500,S=150,w=0,N=10;function d(v){v.property("__zoom",ph).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",F).filter(i).on("touchstart.zoom",G).on("touchmove.zoom",J).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}d.transform=function(v,j,E,L){var _=v.selection?v.selection():v;_.property("__zoom",ph),v!==_?C(v,j,E,L):_.interrupt().each(function(){A(this,arguments).event(L).start().zoom(null,typeof j=="function"?j.apply(this,arguments):j).end()})},d.scaleBy=function(v,j,E,L){d.scaleTo(v,function(){var _=this.__zoom.k,b=typeof j=="function"?j.apply(this,arguments):j;return _*b},E,L)},d.scaleTo=function(v,j,E,L){d.transform(v,function(){var _=t.apply(this,arguments),b=this.__zoom,M=E==null?y(_):typeof E=="function"?E.apply(this,arguments):E,W=b.invert(M),H=typeof j=="function"?j.apply(this,arguments):j;return n(x(p(b,H),M,W),_,o)},E,L)},d.translateBy=function(v,j,E,L){d.transform(v,function(){return n(this.__zoom.translate(typeof j=="function"?j.apply(this,arguments):j,typeof E=="function"?E.apply(this,arguments):E),t.apply(this,arguments),o)},null,L)},d.translateTo=function(v,j,E,L,_){d.transform(v,function(){var b=t.apply(this,arguments),M=this.__zoom,W=L==null?y(b):typeof L=="function"?L.apply(this,arguments):L;return n(Jn.translate(W[0],W[1]).scale(M.k).translate(typeof j=="function"?-j.apply(this,arguments):-j,typeof E=="function"?-E.apply(this,arguments):-E),b,o)},L,_)};function p(v,j){return j=Math.max(s[0],Math.min(s[1],j)),j===v.k?v:new Xn(j,v.x,v.y)}function x(v,j,E){var L=j[0]-E[0]*v.k,_=j[1]-E[1]*v.k;return L===v.x&&_===v.y?v:new Xn(v.k,L,_)}function y(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function C(v,j,E,L){v.on("start.zoom",function(){A(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){A(this,arguments).event(L).end()}).tween("zoom",function(){var _=this,b=arguments,M=A(_,b).event(L),W=t.apply(_,b),H=E==null?y(W):typeof E=="function"?E.apply(_,b):E,re=Math.max(W[1][0]-W[0][0],W[1][1]-W[0][1]),oe=_.__zoom,ge=typeof j=="function"?j.apply(_,b):j,we=c(oe.invert(H).concat(re/oe.k),ge.invert(H).concat(re/ge.k));return function(z){if(z===1)z=ge;else{var ie=we(z),le=re/ie[2];z=new Xn(le,H[0]-ie[0]*le,H[1]-ie[1]*le)}M.zoom(null,z)}})}function A(v,j,E){return!E&&v.__zooming||new D(v,j)}function D(v,j){this.that=v,this.args=j,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,j),this.taps=0}D.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,j){return this.mouse&&v!=="mouse"&&(this.mouse[1]=j.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=j.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=j.invert(this.touch1[0])),this.that.__zoom=j,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var j=ln(this.that).datum();u.call(v,this.that,new p2(v,{sourceEvent:this.sourceEvent,target:d,transform:this.that.__zoom,dispatch:u}),j)}};function R(v,...j){if(!e.apply(this,arguments))return;var E=A(this,j).event(v),L=this.__zoom,_=Math.max(s[0],Math.min(s[1],L.k*Math.pow(2,r.apply(this,arguments)))),b=vn(v);if(E.wheel)(E.mouse[0][0]!==b[0]||E.mouse[0][1]!==b[1])&&(E.mouse[1]=L.invert(E.mouse[0]=b)),clearTimeout(E.wheel);else{if(L.k===_)return;E.mouse=[b,L.invert(b)],dl(this),E.start()}fs(v),E.wheel=setTimeout(M,S),E.zoom("mouse",n(x(p(L,_),E.mouse[0],E.mouse[1]),E.extent,o));function M(){E.wheel=null,E.end()}}function P(v,...j){if(g||!e.apply(this,arguments))return;var E=v.currentTarget,L=A(this,j,!0).event(v),_=ln(v.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",re,!0),b=vn(v,E),M=v.clientX,W=v.clientY;Em(v.view),Za(v),L.mouse=[b,this.__zoom.invert(b)],dl(this),L.start();function H(oe){if(fs(oe),!L.moved){var ge=oe.clientX-M,we=oe.clientY-W;L.moved=ge*ge+we*we>w}L.event(oe).zoom("mouse",n(x(L.that.__zoom,L.mouse[0]=vn(oe,E),L.mouse[1]),L.extent,o))}function re(oe){_.on("mousemove.zoom mouseup.zoom",null),_m(oe.view,L.moved),fs(oe),L.event(oe).end()}}function F(v,...j){if(e.apply(this,arguments)){var E=this.__zoom,L=vn(v.changedTouches?v.changedTouches[0]:v,this),_=E.invert(L),b=E.k*(v.shiftKey?.5:2),M=n(x(p(E,b),L,_),t.apply(this,j),o);fs(v),a>0?ln(this).transition().duration(a).call(C,M,L,v):ln(this).call(d.transform,M,L,v)}}function G(v,...j){if(e.apply(this,arguments)){var E=v.touches,L=E.length,_=A(this,j,v.changedTouches.length===L).event(v),b,M,W,H;for(Za(v),M=0;M<L;++M)W=E[M],H=vn(W,this),H=[H,this.__zoom.invert(H),W.identifier],_.touch0?!_.touch1&&_.touch0[2]!==H[2]&&(_.touch1=H,_.taps=0):(_.touch0=H,b=!0,_.taps=1+!!f);f&&(f=clearTimeout(f)),b&&(_.taps<2&&(h=H[0],f=setTimeout(function(){f=null},m)),dl(this),_.start())}}function J(v,...j){if(this.__zooming){var E=A(this,j).event(v),L=v.changedTouches,_=L.length,b,M,W,H;for(fs(v),b=0;b<_;++b)M=L[b],W=vn(M,this),E.touch0&&E.touch0[2]===M.identifier?E.touch0[0]=W:E.touch1&&E.touch1[2]===M.identifier&&(E.touch1[0]=W);if(M=E.that.__zoom,E.touch1){var re=E.touch0[0],oe=E.touch0[1],ge=E.touch1[0],we=E.touch1[1],z=(z=ge[0]-re[0])*z+(z=ge[1]-re[1])*z,ie=(ie=we[0]-oe[0])*ie+(ie=we[1]-oe[1])*ie;M=p(M,Math.sqrt(z/ie)),W=[(re[0]+ge[0])/2,(re[1]+ge[1])/2],H=[(oe[0]+we[0])/2,(oe[1]+we[1])/2]}else if(E.touch0)W=E.touch0[0],H=E.touch0[1];else return;E.zoom("touch",n(x(M,W,H),E.extent,o))}}function B(v,...j){if(this.__zooming){var E=A(this,j).event(v),L=v.changedTouches,_=L.length,b,M;for(Za(v),g&&clearTimeout(g),g=setTimeout(function(){g=null},m),b=0;b<_;++b)M=L[b],E.touch0&&E.touch0[2]===M.identifier?delete E.touch0:E.touch1&&E.touch1[2]===M.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&(M=vn(M,this),Math.hypot(h[0]-M[0],h[1]-M[1])<N)){var W=ln(this).on("dblclick.zoom");W&&W.apply(this,arguments)}}}return d.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:Bo(+v),d):r},d.filter=function(v){return arguments.length?(e=typeof v=="function"?v:Bo(!!v),d):e},d.touchable=function(v){return arguments.length?(i=typeof v=="function"?v:Bo(!!v),d):i},d.extent=function(v){return arguments.length?(t=typeof v=="function"?v:Bo([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),d):t},d.scaleExtent=function(v){return arguments.length?(s[0]=+v[0],s[1]=+v[1],d):[s[0],s[1]]},d.translateExtent=function(v){return arguments.length?(o[0][0]=+v[0][0],o[1][0]=+v[1][0],o[0][1]=+v[0][1],o[1][1]=+v[1][1],d):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},d.constrain=function(v){return arguments.length?(n=v,d):n},d.duration=function(v){return arguments.length?(a=+v,d):a},d.interpolate=function(v){return arguments.length?(c=v,d):c},d.on=function(){var v=u.on.apply(u,arguments);return v===u?d:v},d.clickDistance=function(v){return arguments.length?(w=(v=+v)*v,d):Math.sqrt(w)},d.tapDistance=function(v){return arguments.length?(N=+v,d):N},d}const ga=k.createContext(null),w2=ga.Provider,rr={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Hm=rr.error001();function lt(e,t){const n=k.useContext(ga);if(n===null)throw new Error(Hm);return hm(n,e,t)}const St=()=>{const e=k.useContext(ga);if(e===null)throw new Error(Hm);return k.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},S2=e=>e.userSelectionActive?"none":"all";function bd({position:e,children:t,className:n,style:r,...i}){const s=lt(S2),o=`${e}`.split("-");return V.createElement("div",{className:Mt(["react-flow__panel",n,...o]),style:{...r,pointerEvents:s},...i},t)}function k2({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:V.createElement(bd,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},V.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const b2=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...f})=>{const h=k.useRef(null),[g,m]=k.useState({x:0,y:0,width:0,height:0}),S=Mt(["react-flow__edge-textwrapper",u]);return k.useEffect(()=>{if(h.current){const w=h.current.getBBox();m({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),typeof n>"u"||!n?null:V.createElement("g",{transform:`translate(${e-g.width/2} ${t-g.height/2})`,className:S,visibility:g.width?"visible":"hidden",...f},i&&V.createElement("rect",{width:g.width+2*o[0],x:-o[0],y:-o[1],height:g.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),V.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:h,style:r},n),c)};var C2=k.memo(b2);const Cd=e=>({width:e.offsetWidth,height:e.offsetHeight}),Qi=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),jd=(e={x:0,y:0},t)=>({x:Qi(e.x,t[0][0],t[1][0]),y:Qi(e.y,t[0][1],t[1][1])}),gh=(e,t,n)=>e<t?Qi(Math.abs(e-t),1,50)/50:e>n?-Qi(Math.abs(e-n),1,50)/50:0,Wm=(e,t)=>{const n=gh(e.x,35,t.width-35)*20,r=gh(e.y,35,t.height-35)*20;return[n,r]},Um=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Vm=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),lo=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Ym=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),mh=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),j2=(e,t)=>Ym(Vm(lo(e),lo(t))),pu=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},E2=e=>cn(e.width)&&cn(e.height)&&cn(e.x)&&cn(e.y),cn=e=>!isNaN(e)&&isFinite(e),gt=Symbol.for("internals"),Gm=["Enter"," ","Escape"],_2=(e,t)=>{},N2=e=>"nativeEvent"in e;function gu(e){var i,s;const t=N2(e)?e.nativeEvent:e,n=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const Km=e=>"clientX"in e,Er=(e,t)=>{var s,o;const n=Km(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},Wl=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},xo=({id:e,path:t,labelX:n,labelY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:f,markerEnd:h,markerStart:g,interactionWidth:m=20})=>V.createElement(V.Fragment,null,V.createElement("path",{id:e,style:f,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:h,markerStart:g}),m&&V.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),i&&cn(n)&&cn(r)?V.createElement(C2,{x:n,y:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);xo.displayName="BaseEdge";function hs(e,t,n){return n===void 0?n:r=>{const i=t().edges.find(s=>s.id===e);i&&n(r,{...i})}}function Xm({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,s=n<e?n+i:n-i,o=Math.abs(r-t)/2,a=r<t?r+o:r-o;return[s,a,i,o]}function Qm({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const c=e*.125+i*.375+o*.375+n*.125,u=t*.125+s*.375+a*.375+r*.125,f=Math.abs(c-e),h=Math.abs(u-t);return[c,u,f,h]}var ti;(function(e){e.Strict="strict",e.Loose="loose"})(ti||(ti={}));var Wr;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Wr||(Wr={}));var ao;(function(e){e.Partial="partial",e.Full="full"})(ao||(ao={}));var gr;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(gr||(gr={}));var Ul;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Ul||(Ul={}));var ke;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ke||(ke={}));function yh({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===ke.Left||e===ke.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function Jm({sourceX:e,sourceY:t,sourcePosition:n=ke.Bottom,targetX:r,targetY:i,targetPosition:s=ke.Top}){const[o,a]=yh({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,u]=yh({pos:s,x1:r,y1:i,x2:e,y2:t}),[f,h,g,m]=Qm({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${o},${a} ${c},${u} ${r},${i}`,f,h,g,m]}const Ed=k.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=ke.Bottom,targetPosition:s=ke.Top,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:g,markerEnd:m,markerStart:S,interactionWidth:w})=>{const[N,d,p]=Jm({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:s});return V.createElement(xo,{path:N,labelX:d,labelY:p,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:g,markerEnd:m,markerStart:S,interactionWidth:w})});Ed.displayName="SimpleBezierEdge";const xh={[ke.Left]:{x:-1,y:0},[ke.Right]:{x:1,y:0},[ke.Top]:{x:0,y:-1},[ke.Bottom]:{x:0,y:1}},A2=({source:e,sourcePosition:t=ke.Bottom,target:n})=>t===ke.Left||t===ke.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},vh=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function D2({source:e,sourcePosition:t=ke.Bottom,target:n,targetPosition:r=ke.Top,center:i,offset:s}){const o=xh[t],a=xh[r],c={x:e.x+o.x*s,y:e.y+o.y*s},u={x:n.x+a.x*s,y:n.y+a.y*s},f=A2({source:c,sourcePosition:t,target:u}),h=f.x!==0?"x":"y",g=f[h];let m=[],S,w;const N={x:0,y:0},d={x:0,y:0},[p,x,y,C]=Xm({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[h]*a[h]===-1){S=i.x??p,w=i.y??x;const D=[{x:S,y:c.y},{x:S,y:u.y}],R=[{x:c.x,y:w},{x:u.x,y:w}];o[h]===g?m=h==="x"?D:R:m=h==="x"?R:D}else{const D=[{x:c.x,y:u.y}],R=[{x:u.x,y:c.y}];if(h==="x"?m=o.x===g?R:D:m=o.y===g?D:R,t===r){const B=Math.abs(e[h]-n[h]);if(B<=s){const v=Math.min(s-1,s-B);o[h]===g?N[h]=(c[h]>e[h]?-1:1)*v:d[h]=(u[h]>n[h]?-1:1)*v}}if(t!==r){const B=h==="x"?"y":"x",v=o[h]===a[B],j=c[B]>u[B],E=c[B]<u[B];(o[h]===1&&(!v&&j||v&&E)||o[h]!==1&&(!v&&E||v&&j))&&(m=h==="x"?D:R)}const P={x:c.x+N.x,y:c.y+N.y},F={x:u.x+d.x,y:u.y+d.y},G=Math.max(Math.abs(P.x-m[0].x),Math.abs(F.x-m[0].x)),J=Math.max(Math.abs(P.y-m[0].y),Math.abs(F.y-m[0].y));G>=J?(S=(P.x+F.x)/2,w=m[0].y):(S=m[0].x,w=(P.y+F.y)/2)}return[[e,{x:c.x+N.x,y:c.y+N.y},...m,{x:u.x+d.x,y:u.y+d.y},n],S,w,y,C]}function M2(e,t,n,r){const i=Math.min(vh(e,t)/2,vh(t,n)/2,r),{x:s,y:o}=t;if(e.x===s&&s===n.x||e.y===o&&o===n.y)return`L${s} ${o}`;if(e.y===o){const u=e.x<n.x?-1:1,f=e.y<n.y?1:-1;return`L ${s+i*u},${o}Q ${s},${o} ${s},${o+i*f}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*a},${o}`}function mu({sourceX:e,sourceY:t,sourcePosition:n=ke.Bottom,targetX:r,targetY:i,targetPosition:s=ke.Top,borderRadius:o=5,centerX:a,centerY:c,offset:u=20}){const[f,h,g,m,S]=D2({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:c},offset:u});return[f.reduce((N,d,p)=>{let x="";return p>0&&p<f.length-1?x=M2(f[p-1],d,f[p+1],o):x=`${p===0?"M":"L"}${d.x} ${d.y}`,N+=x,N},""),h,g,m,S]}const ma=k.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:f,sourcePosition:h=ke.Bottom,targetPosition:g=ke.Top,markerEnd:m,markerStart:S,pathOptions:w,interactionWidth:N})=>{const[d,p,x]=mu({sourceX:e,sourceY:t,sourcePosition:h,targetX:n,targetY:r,targetPosition:g,borderRadius:w==null?void 0:w.borderRadius,offset:w==null?void 0:w.offset});return V.createElement(xo,{path:d,labelX:p,labelY:x,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:f,markerEnd:m,markerStart:S,interactionWidth:N})});ma.displayName="SmoothStepEdge";const _d=k.memo(e=>{var t;return V.createElement(ma,{...e,pathOptions:k.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});_d.displayName="StepEdge";function z2({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,s,o,a]=Xm({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,s,o,a]}const Nd=k.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:f,markerEnd:h,markerStart:g,interactionWidth:m})=>{const[S,w,N]=z2({sourceX:e,sourceY:t,targetX:n,targetY:r});return V.createElement(xo,{path:S,labelX:w,labelY:N,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:f,markerEnd:h,markerStart:g,interactionWidth:m})});Nd.displayName="StraightEdge";function Fo(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function wh({pos:e,x1:t,y1:n,x2:r,y2:i,c:s}){switch(e){case ke.Left:return[t-Fo(t-r,s),n];case ke.Right:return[t+Fo(r-t,s),n];case ke.Top:return[t,n-Fo(n-i,s)];case ke.Bottom:return[t,n+Fo(i-n,s)]}}function Zm({sourceX:e,sourceY:t,sourcePosition:n=ke.Bottom,targetX:r,targetY:i,targetPosition:s=ke.Top,curvature:o=.25}){const[a,c]=wh({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[u,f]=wh({pos:s,x1:r,y1:i,x2:e,y2:t,c:o}),[h,g,m,S]=Qm({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:f});return[`M${e},${t} C${a},${c} ${u},${f} ${r},${i}`,h,g,m,S]}const Vl=k.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=ke.Bottom,targetPosition:s=ke.Top,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:g,markerEnd:m,markerStart:S,pathOptions:w,interactionWidth:N})=>{const[d,p,x]=Zm({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:s,curvature:w==null?void 0:w.curvature});return V.createElement(xo,{path:d,labelX:p,labelY:x,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:g,markerEnd:m,markerStart:S,interactionWidth:N})});Vl.displayName="BezierEdge";const Ad=k.createContext(null),R2=Ad.Provider;Ad.Consumer;const P2=()=>k.useContext(Ad),T2=e=>"id"in e&&"source"in e&&"target"in e,I2=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,yu=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,$2=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Dd=(e,t)=>{if(!e.source||!e.target)return t;let n;return T2(e)?n={...e}:n={...e,id:I2(e)},$2(n,t)?t:t.concat(n)},xu=({x:e,y:t},[n,r,i],s,[o,a])=>{const c={x:(e-n)/i,y:(t-r)/i};return s?{x:o*Math.round(c.x/o),y:a*Math.round(c.y/a)}:c},qm=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),Gr=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],i={x:e.position.x-n,y:e.position.y-r};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:i}},ya=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const{x:s,y:o}=Gr(i,t).positionAbsolute;return Vm(r,lo({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ym(n)},ey=(e,t,[n,r,i]=[0,0,1],s=!1,o=!1,a=[0,0])=>{const c={x:(t.x-n)/i,y:(t.y-r)/i,width:t.width/i,height:t.height/i},u=[];return e.forEach(f=>{const{width:h,height:g,selectable:m=!0,hidden:S=!1}=f;if(o&&!m||S)return!1;const{positionAbsolute:w}=Gr(f,a),N={x:w.x,y:w.y,width:h||0,height:g||0},d=pu(c,N),p=typeof h>"u"||typeof g>"u"||h===null||g===null,x=s&&d>0,y=(h||0)*(g||0);(p||x||d>=y||f.dragging)&&u.push(f)}),u},ty=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},ny=(e,t,n,r,i,s=.1)=>{const o=t/(e.width*(1+s)),a=n/(e.height*(1+s)),c=Math.min(o,a),u=Qi(c,r,i),f=e.x+e.width/2,h=e.y+e.height/2,g=t/2-f*u,m=n/2-h*u;return{x:g,y:m,zoom:u}},Tr=(e,t=0)=>e.transition().duration(t);function Sh(e,t,n,r){return(t[n]||[]).reduce((i,s)=>{var o,a;return`${e.id}-${s.id}-${n}`!==r&&i.push({id:s.id||null,type:n,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+s.y+s.height/2}),i},[])}function L2(e,t,n,r,i,s){const{x:o,y:a}=Er(e),u=t.elementsFromPoint(o,a).find(S=>S.classList.contains("react-flow__handle"));if(u){const S=u.getAttribute("data-nodeid");if(S){const w=Md(void 0,u),N=u.getAttribute("data-handleid"),d=s({nodeId:S,id:N,type:w});if(d){const p=i.find(x=>x.nodeId===S&&x.type===w&&x.id===N);return{handle:{id:N,type:w,nodeId:S,x:(p==null?void 0:p.x)||n.x,y:(p==null?void 0:p.y)||n.y},validHandleResult:d}}}}let f=[],h=1/0;if(i.forEach(S=>{const w=Math.sqrt((S.x-n.x)**2+(S.y-n.y)**2);if(w<=r){const N=s(S);w<=h&&(w<h?f=[{handle:S,validHandleResult:N}]:w===h&&f.push({handle:S,validHandleResult:N}),h=w)}}),!f.length)return{handle:null,validHandleResult:ry()};if(f.length===1)return f[0];const g=f.some(({validHandleResult:S})=>S.isValid),m=f.some(({handle:S})=>S.type==="target");return f.find(({handle:S,validHandleResult:w})=>m?S.type==="target":g?w.isValid:!0)||f[0]}const O2={source:null,target:null,sourceHandle:null,targetHandle:null},ry=()=>({handleDomNode:null,isValid:!1,connection:O2,endHandle:null});function iy(e,t,n,r,i,s,o){const a=i==="target",c=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...ry(),handleDomNode:c};if(c){const f=Md(void 0,c),h=c.getAttribute("data-nodeid"),g=c.getAttribute("data-handleid"),m=c.classList.contains("connectable"),S=c.classList.contains("connectableend"),w={source:a?h:n,sourceHandle:a?g:r,target:a?n:h,targetHandle:a?r:g};u.connection=w,m&&S&&(t===ti.Strict?a&&f==="source"||!a&&f==="target":h!==n||g!==r)&&(u.endHandle={nodeId:h,handleId:g,type:f},u.isValid=s(w))}return u}function B2({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((i,s)=>{if(s[gt]){const{handleBounds:o}=s[gt];let a=[],c=[];o&&(a=Sh(s,o,"source",`${t}-${n}-${r}`),c=Sh(s,o,"target",`${t}-${n}-${r}`)),i.push(...a,...c)}return i},[])}function Md(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function qa(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function F2(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function sy({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:i,getState:s,setState:o,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const f=Um(e.target),{connectionMode:h,domNode:g,autoPanOnConnect:m,connectionRadius:S,onConnectStart:w,panBy:N,getNodes:d,cancelConnection:p}=s();let x=0,y;const{x:C,y:A}=Er(e),D=f==null?void 0:f.elementFromPoint(C,A),R=Md(c,D),P=g==null?void 0:g.getBoundingClientRect();if(!P||!R)return;let F,G=Er(e,P),J=!1,B=null,v=!1,j=null;const E=B2({nodes:d(),nodeId:n,handleId:t,handleType:R}),L=()=>{if(!m)return;const[M,W]=Wm(G,P);N({x:M,y:W}),x=requestAnimationFrame(L)};o({connectionPosition:G,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:R,connectionStartHandle:{nodeId:n,handleId:t,type:R},connectionEndHandle:null}),w==null||w(e,{nodeId:n,handleId:t,handleType:R});function _(M){const{transform:W}=s();G=Er(M,P);const{handle:H,validHandleResult:re}=L2(M,f,xu(G,W,!1,[1,1]),S,E,oe=>iy(oe,h,n,t,i?"target":"source",a,f));if(y=H,J||(L(),J=!0),j=re.handleDomNode,B=re.connection,v=re.isValid,o({connectionPosition:y&&v?qm({x:y.x,y:y.y},W):G,connectionStatus:F2(!!y,v),connectionEndHandle:re.endHandle}),!y&&!v&&!j)return qa(F);B.source!==B.target&&j&&(qa(F),F=j,j.classList.add("connecting","react-flow__handle-connecting"),j.classList.toggle("valid",v),j.classList.toggle("react-flow__handle-valid",v))}function b(M){var W,H;(y||j)&&B&&v&&(r==null||r(B)),(H=(W=s()).onConnectEnd)==null||H.call(W,M),c&&(u==null||u(M)),qa(F),p(),cancelAnimationFrame(x),J=!1,v=!1,B=null,j=null,f.removeEventListener("mousemove",_),f.removeEventListener("mouseup",b),f.removeEventListener("touchmove",_),f.removeEventListener("touchend",b)}f.addEventListener("mousemove",_),f.addEventListener("mouseup",b),f.addEventListener("touchmove",_),f.addEventListener("touchend",b)}const kh=()=>!0,H2=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),W2=(e,t,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=r;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n}},oy=k.forwardRef(({type:e="source",position:t=ke.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:c,className:u,onMouseDown:f,onTouchStart:h,...g},m)=>{var P,F;const S=o||null,w=e==="target",N=St(),d=P2(),{connectOnClick:p,noPanClassName:x}=lt(H2,jt),{connecting:y,clickConnecting:C}=lt(W2(d,S,e),jt);d||(F=(P=N.getState()).onError)==null||F.call(P,"010",rr.error010());const A=G=>{const{defaultEdgeOptions:J,onConnect:B,hasDefaultEdges:v}=N.getState(),j={...J,...G};if(v){const{edges:E,setEdges:L}=N.getState();L(Dd(j,E))}B==null||B(j),a==null||a(j)},D=G=>{if(!d)return;const J=Km(G);i&&(J&&G.button===0||!J)&&sy({event:G,handleId:S,nodeId:d,onConnect:A,isTarget:w,getState:N.getState,setState:N.setState,isValidConnection:n||N.getState().isValidConnection||kh}),J?f==null||f(G):h==null||h(G)},R=G=>{const{onClickConnectStart:J,onClickConnectEnd:B,connectionClickStartHandle:v,connectionMode:j,isValidConnection:E}=N.getState();if(!d||!v&&!i)return;if(!v){J==null||J(G,{nodeId:d,handleId:S,handleType:e}),N.setState({connectionClickStartHandle:{nodeId:d,type:e,handleId:S}});return}const L=Um(G.target),_=n||E||kh,{connection:b,isValid:M}=iy({nodeId:d,id:S,type:e},j,v.nodeId,v.handleId||null,v.type,_,L);M&&A(b),B==null||B(G),N.setState({connectionClickStartHandle:null})};return V.createElement("div",{"data-handleid":S,"data-nodeid":d,"data-handlepos":t,"data-id":`${d}-${S}-${e}`,className:Mt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",x,u,{source:!w,target:w,connectable:r,connectablestart:i,connectableend:s,connecting:C,connectionindicator:r&&(i&&!y||s&&y)}]),onMouseDown:D,onTouchStart:D,onClick:p?R:void 0,ref:m,...g},c)});oy.displayName="Handle";var yt=k.memo(oy);const ly=({data:e,isConnectable:t,targetPosition:n=ke.Top,sourcePosition:r=ke.Bottom})=>V.createElement(V.Fragment,null,V.createElement(yt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,V.createElement(yt,{type:"source",position:r,isConnectable:t}));ly.displayName="DefaultNode";var vu=k.memo(ly);const ay=({data:e,isConnectable:t,sourcePosition:n=ke.Bottom})=>V.createElement(V.Fragment,null,e==null?void 0:e.label,V.createElement(yt,{type:"source",position:n,isConnectable:t}));ay.displayName="InputNode";var cy=k.memo(ay);const uy=({data:e,isConnectable:t,targetPosition:n=ke.Top})=>V.createElement(V.Fragment,null,V.createElement(yt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);uy.displayName="OutputNode";var dy=k.memo(uy);const zd=()=>null;zd.displayName="GroupNode";const U2=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Ho=e=>e.id;function V2(e,t){return jt(e.selectedNodes.map(Ho),t.selectedNodes.map(Ho))&&jt(e.selectedEdges.map(Ho),t.selectedEdges.map(Ho))}const fy=k.memo(({onSelectionChange:e})=>{const t=St(),{selectedNodes:n,selectedEdges:r}=lt(U2,V2);return k.useEffect(()=>{const i={nodes:n,edges:r};e==null||e(i),t.getState().onSelectionChange.forEach(s=>s(i))},[n,r,e]),null});fy.displayName="SelectionListener";const Y2=e=>!!e.onSelectionChange;function G2({onSelectionChange:e}){const t=lt(Y2);return e||t?V.createElement(fy,{onSelectionChange:e}):null}const K2=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function ui(e,t){k.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Je(e,t,n){k.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const X2=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:f,nodesFocusable:h,edgesFocusable:g,edgesUpdatable:m,elevateNodesOnSelect:S,minZoom:w,maxZoom:N,nodeExtent:d,onNodesChange:p,onEdgesChange:x,elementsSelectable:y,connectionMode:C,snapGrid:A,snapToGrid:D,translateExtent:R,connectOnClick:P,defaultEdgeOptions:F,fitView:G,fitViewOptions:J,onNodesDelete:B,onEdgesDelete:v,onNodeDrag:j,onNodeDragStart:E,onNodeDragStop:L,onSelectionDrag:_,onSelectionDragStart:b,onSelectionDragStop:M,noPanClassName:W,nodeOrigin:H,rfId:re,autoPanOnConnect:oe,autoPanOnNodeDrag:ge,onError:we,connectionRadius:z,isValidConnection:ie,nodeDragThreshold:le})=>{const{setNodes:he,setEdges:Te,setDefaultNodesAndEdges:Q,setMinZoom:Ae,setMaxZoom:ve,setTranslateExtent:Se,setNodeExtent:Ve,reset:Qe}=lt(K2,jt),me=St();return k.useEffect(()=>{const st=r==null?void 0:r.map(I=>({...I,...F}));return Q(n,st),()=>{Qe()}},[]),Je("defaultEdgeOptions",F,me.setState),Je("connectionMode",C,me.setState),Je("onConnect",i,me.setState),Je("onConnectStart",s,me.setState),Je("onConnectEnd",o,me.setState),Je("onClickConnectStart",a,me.setState),Je("onClickConnectEnd",c,me.setState),Je("nodesDraggable",u,me.setState),Je("nodesConnectable",f,me.setState),Je("nodesFocusable",h,me.setState),Je("edgesFocusable",g,me.setState),Je("edgesUpdatable",m,me.setState),Je("elementsSelectable",y,me.setState),Je("elevateNodesOnSelect",S,me.setState),Je("snapToGrid",D,me.setState),Je("snapGrid",A,me.setState),Je("onNodesChange",p,me.setState),Je("onEdgesChange",x,me.setState),Je("connectOnClick",P,me.setState),Je("fitViewOnInit",G,me.setState),Je("fitViewOnInitOptions",J,me.setState),Je("onNodesDelete",B,me.setState),Je("onEdgesDelete",v,me.setState),Je("onNodeDrag",j,me.setState),Je("onNodeDragStart",E,me.setState),Je("onNodeDragStop",L,me.setState),Je("onSelectionDrag",_,me.setState),Je("onSelectionDragStart",b,me.setState),Je("onSelectionDragStop",M,me.setState),Je("noPanClassName",W,me.setState),Je("nodeOrigin",H,me.setState),Je("rfId",re,me.setState),Je("autoPanOnConnect",oe,me.setState),Je("autoPanOnNodeDrag",ge,me.setState),Je("onError",we,me.setState),Je("connectionRadius",z,me.setState),Je("isValidConnection",ie,me.setState),Je("nodeDragThreshold",le,me.setState),ui(e,he),ui(t,Te),ui(w,Ae),ui(N,ve),ui(R,Se),ui(d,Ve),null},bh={display:"none"},Q2={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},hy="react-flow__node-desc",py="react-flow__edge-desc",J2="react-flow__aria-live",Z2=e=>e.ariaLiveMessage;function q2({rfId:e}){const t=lt(Z2);return V.createElement("div",{id:`${J2}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Q2},t)}function eb({rfId:e,disableKeyboardA11y:t}){return V.createElement(V.Fragment,null,V.createElement("div",{id:`${hy}-${e}`,style:bh},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),V.createElement("div",{id:`${py}-${e}`,style:bh},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&V.createElement(q2,{rfId:e}))}var co=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=k.useState(!1),i=k.useRef(!1),s=k.useRef(new Set([])),[o,a]=k.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(h=>typeof h=="string").map(h=>h.split("+")),f=u.reduce((h,g)=>h.concat(...g),[]);return[u,f]}return[[],[]]},[e]);return k.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const f=m=>{if(i.current=m.ctrlKey||m.metaKey||m.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&gu(m))return!1;const w=jh(m.code,a);s.current.add(m[w]),Ch(o,s.current,!1)&&(m.preventDefault(),r(!0))},h=m=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&gu(m))return!1;const w=jh(m.code,a);Ch(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(m[w]),m.key==="Meta"&&s.current.clear(),i.current=!1},g=()=>{s.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",f),u==null||u.addEventListener("keyup",h),window.addEventListener("blur",g),()=>{u==null||u.removeEventListener("keydown",f),u==null||u.removeEventListener("keyup",h),window.removeEventListener("blur",g)}}},[e,r]),n};function Ch(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function jh(e,t){return t.includes(e)?"code":"key"}function gy(e,t,n,r){var a,c;const i=e.parentNode||e.parentId;if(!i)return n;const s=t.get(i),o=Gr(s,r);return gy(s,t,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((a=s[gt])==null?void 0:a.z)??0)>(n.z??0)?((c=s[gt])==null?void 0:c.z)??0:n.z??0},r)}function my(e,t,n){e.forEach(r=>{var s;const i=r.parentNode||r.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:o,y:a,z:c}=gy(r,e,{...r.position,z:((s=r[gt])==null?void 0:s.z)??0},t);r.positionAbsolute={x:o,y:a},r[gt].z=c,n!=null&&n[r.id]&&(r[gt].isParent=!0)}})}function ec(e,t,n,r){const i=new Map,s={},o=r?1e3:0;return e.forEach(a=>{var m;const c=(cn(a.zIndex)?a.zIndex:0)+(a.selected?o:0),u=t.get(a.id),f={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},h=a.parentNode||a.parentId;h&&(s[h]=!0);const g=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(f,gt,{enumerable:!1,value:{handleBounds:g||(m=u==null?void 0:u[gt])==null?void 0:m.handleBounds,z:c}}),i.set(a.id,f)}),my(i,n,s),i}function yy(e,t={}){const{getNodes:n,width:r,height:i,minZoom:s,maxZoom:o,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:f,nodeOrigin:h}=e(),g=t.initial&&!u&&f;if(a&&c&&(g||!t.initial)){const S=n().filter(N=>{var p;const d=t.includeHiddenNodes?N.width&&N.height:!N.hidden;return(p=t.nodes)!=null&&p.length?d&&t.nodes.some(x=>x.id===N.id):d}),w=S.every(N=>N.width&&N.height);if(S.length>0&&w){const N=ya(S,h),{x:d,y:p,zoom:x}=ny(N,r,i,t.minZoom??s,t.maxZoom??o,t.padding??.1),y=Jn.translate(d,p).scale(x);return typeof t.duration=="number"&&t.duration>0?a.transform(Tr(c,t.duration),y):a.transform(c,y),!0}}return!1}function tb(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[gt]:r[gt],selected:n.selected})}),new Map(t)}function nb(e,t){return t.map(n=>{const r=e.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function Wo({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=n();e!=null&&e.length&&(c&&r({nodeInternals:tb(e,i)}),o==null||o(e)),t!=null&&t.length&&(u&&r({edges:nb(t,s)}),a==null||a(t))}const di=()=>{},rb={zoomIn:di,zoomOut:di,zoomTo:di,getZoom:()=>1,setViewport:di,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:di,fitBounds:di,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},ib=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),sb=()=>{const e=St(),{d3Zoom:t,d3Selection:n}=lt(ib,jt);return k.useMemo(()=>n&&t?{zoomIn:i=>t.scaleBy(Tr(n,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(Tr(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>t.scaleTo(Tr(n,s==null?void 0:s.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,s)=>{const[o,a,c]=e.getState().transform,u=Jn.translate(i.x??o,i.y??a).scale(i.zoom??c);t.transform(Tr(n,s==null?void 0:s.duration),u)},getViewport:()=>{const[i,s,o]=e.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>yy(e.getState,i),setCenter:(i,s,o)=>{const{width:a,height:c,maxZoom:u}=e.getState(),f=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:u,h=a/2-i*f,g=c/2-s*f,m=Jn.translate(h,g).scale(f);t.transform(Tr(n,o==null?void 0:o.duration),m)},fitBounds:(i,s)=>{const{width:o,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:f,y:h,zoom:g}=ny(i,o,a,c,u,(s==null?void 0:s.padding)??.1),m=Jn.translate(f,h).scale(g);t.transform(Tr(n,s==null?void 0:s.duration),m)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),xu(i,s,o,a)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:a,domNode:c}=e.getState();if(!c)return i;const{x:u,y:f}=c.getBoundingClientRect(),h={x:i.x-u,y:i.y-f};return xu(h,s,o,a)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=e.getState();if(!o)return i;const{x:a,y:c}=o.getBoundingClientRect(),u=qm(i,s);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:rb,[t,n])};function _n(){const e=sb(),t=St(),n=k.useCallback(()=>t.getState().getNodes().map(w=>({...w})),[]),r=k.useCallback(w=>t.getState().nodeInternals.get(w),[]),i=k.useCallback(()=>{const{edges:w=[]}=t.getState();return w.map(N=>({...N}))},[]),s=k.useCallback(w=>{const{edges:N=[]}=t.getState();return N.find(d=>d.id===w)},[]),o=k.useCallback(w=>{const{getNodes:N,setNodes:d,hasDefaultNodes:p,onNodesChange:x}=t.getState(),y=N(),C=typeof w=="function"?w(y):w;if(p)d(C);else if(x){const A=C.length===0?y.map(D=>({type:"remove",id:D.id})):C.map(D=>({item:D,type:"reset"}));x(A)}},[]),a=k.useCallback(w=>{const{edges:N=[],setEdges:d,hasDefaultEdges:p,onEdgesChange:x}=t.getState(),y=typeof w=="function"?w(N):w;if(p)d(y);else if(x){const C=y.length===0?N.map(A=>({type:"remove",id:A.id})):y.map(A=>({item:A,type:"reset"}));x(C)}},[]),c=k.useCallback(w=>{const N=Array.isArray(w)?w:[w],{getNodes:d,setNodes:p,hasDefaultNodes:x,onNodesChange:y}=t.getState();if(x){const A=[...d(),...N];p(A)}else if(y){const C=N.map(A=>({item:A,type:"add"}));y(C)}},[]),u=k.useCallback(w=>{const N=Array.isArray(w)?w:[w],{edges:d=[],setEdges:p,hasDefaultEdges:x,onEdgesChange:y}=t.getState();if(x)p([...d,...N]);else if(y){const C=N.map(A=>({item:A,type:"add"}));y(C)}},[]),f=k.useCallback(()=>{const{getNodes:w,edges:N=[],transform:d}=t.getState(),[p,x,y]=d;return{nodes:w().map(C=>({...C})),edges:N.map(C=>({...C})),viewport:{x:p,y:x,zoom:y}}},[]),h=k.useCallback(({nodes:w,edges:N})=>{const{nodeInternals:d,getNodes:p,edges:x,hasDefaultNodes:y,hasDefaultEdges:C,onNodesDelete:A,onEdgesDelete:D,onNodesChange:R,onEdgesChange:P}=t.getState(),F=(w||[]).map(j=>j.id),G=(N||[]).map(j=>j.id),J=p().reduce((j,E)=>{const L=E.parentNode||E.parentId,_=!F.includes(E.id)&&L&&j.find(M=>M.id===L);return(typeof E.deletable=="boolean"?E.deletable:!0)&&(F.includes(E.id)||_)&&j.push(E),j},[]),B=x.filter(j=>typeof j.deletable=="boolean"?j.deletable:!0),v=B.filter(j=>G.includes(j.id));if(J||v){const j=ty(J,B),E=[...v,...j],L=E.reduce((_,b)=>(_.includes(b.id)||_.push(b.id),_),[]);if((C||y)&&(C&&t.setState({edges:x.filter(_=>!L.includes(_.id))}),y&&(J.forEach(_=>{d.delete(_.id)}),t.setState({nodeInternals:new Map(d)}))),L.length>0&&(D==null||D(E),P&&P(L.map(_=>({id:_,type:"remove"})))),J.length>0&&(A==null||A(J),R)){const _=J.map(b=>({id:b.id,type:"remove"}));R(_)}}},[]),g=k.useCallback(w=>{const N=E2(w),d=N?null:t.getState().nodeInternals.get(w.id);return!N&&!d?[null,null,N]:[N?w:mh(d),d,N]},[]),m=k.useCallback((w,N=!0,d)=>{const[p,x,y]=g(w);return p?(d||t.getState().getNodes()).filter(C=>{if(!y&&(C.id===x.id||!C.positionAbsolute))return!1;const A=mh(C),D=pu(A,p);return N&&D>0||D>=p.width*p.height}):[]},[]),S=k.useCallback((w,N,d=!0)=>{const[p]=g(w);if(!p)return!1;const x=pu(p,N);return d&&x>0||x>=p.width*p.height},[]);return k.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:i,getEdge:s,setNodes:o,setEdges:a,addNodes:c,addEdges:u,toObject:f,deleteElements:h,getIntersectingNodes:m,isNodeIntersecting:S}),[e,n,r,i,s,o,a,c,u,f,h,m,S])}const ob={actInsideInputWithModifier:!1};var lb=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=St(),{deleteElements:r}=_n(),i=co(e,ob),s=co(t);k.useEffect(()=>{if(i){const{edges:o,getNodes:a}=n.getState(),c=a().filter(f=>f.selected),u=o.filter(f=>f.selected);r({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[i]),k.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function ab(e){const t=St();k.useEffect(()=>{let n;const r=()=>{var s,o;if(!e.current)return;const i=Cd(e.current);(i.height===0||i.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",rr.error004())),t.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Rd={position:"absolute",width:"100%",height:"100%",top:0,left:0},cb=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Uo=e=>({x:e.x,y:e.y,zoom:e.k}),fi=(e,t)=>e.target.closest(`.${t}`),Eh=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),_h=e=>{const t=e.ctrlKey&&Wl()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},ub=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),db=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=Wr.Free,zoomOnDoubleClick:u=!0,elementsSelectable:f,panOnDrag:h=!0,defaultViewport:g,translateExtent:m,minZoom:S,maxZoom:w,zoomActivationKeyCode:N,preventScrolling:d=!0,children:p,noWheelClassName:x,noPanClassName:y})=>{const C=k.useRef(),A=St(),D=k.useRef(!1),R=k.useRef(!1),P=k.useRef(null),F=k.useRef({x:0,y:0,zoom:0}),{d3Zoom:G,d3Selection:J,d3ZoomHandler:B,userSelectionActive:v}=lt(ub,jt),j=co(N),E=k.useRef(0),L=k.useRef(!1),_=k.useRef();return ab(P),k.useEffect(()=>{if(P.current){const b=P.current.getBoundingClientRect(),M=Fm().scaleExtent([S,w]).translateExtent(m),W=ln(P.current).call(M),H=Jn.translate(g.x,g.y).scale(Qi(g.zoom,S,w)),re=[[0,0],[b.width,b.height]],oe=M.constrain()(H,re,m);M.transform(W,oe),M.wheelDelta(_h),A.setState({d3Zoom:M,d3Selection:W,d3ZoomHandler:W.on("wheel.zoom"),transform:[oe.x,oe.y,oe.k],domNode:P.current.closest(".react-flow")})}},[]),k.useEffect(()=>{J&&G&&(o&&!j&&!v?J.on("wheel.zoom",b=>{if(fi(b,x))return!1;b.preventDefault(),b.stopImmediatePropagation();const M=J.property("__zoom").k||1;if(b.ctrlKey&&s){const ie=vn(b),le=_h(b),he=M*Math.pow(2,le);G.scaleTo(J,he,ie,b);return}const W=b.deltaMode===1?20:1;let H=c===Wr.Vertical?0:b.deltaX*W,re=c===Wr.Horizontal?0:b.deltaY*W;!Wl()&&b.shiftKey&&c!==Wr.Vertical&&(H=b.deltaY*W,re=0),G.translateBy(J,-(H/M)*a,-(re/M)*a,{internal:!0});const oe=Uo(J.property("__zoom")),{onViewportChangeStart:ge,onViewportChange:we,onViewportChangeEnd:z}=A.getState();clearTimeout(_.current),L.current||(L.current=!0,t==null||t(b,oe),ge==null||ge(oe)),L.current&&(e==null||e(b,oe),we==null||we(oe),_.current=setTimeout(()=>{n==null||n(b,oe),z==null||z(oe),L.current=!1},150))},{passive:!1}):typeof B<"u"&&J.on("wheel.zoom",function(b,M){if(!d&&b.type==="wheel"&&!b.ctrlKey||fi(b,x))return null;b.preventDefault(),B.call(this,b,M)},{passive:!1}))},[v,o,c,J,G,B,j,s,d,x,t,e,n]),k.useEffect(()=>{G&&G.on("start",b=>{var H,re;if(!b.sourceEvent||b.sourceEvent.internal)return null;E.current=(H=b.sourceEvent)==null?void 0:H.button;const{onViewportChangeStart:M}=A.getState(),W=Uo(b.transform);D.current=!0,F.current=W,((re=b.sourceEvent)==null?void 0:re.type)==="mousedown"&&A.setState({paneDragging:!0}),M==null||M(W),t==null||t(b.sourceEvent,W)})},[G,t]),k.useEffect(()=>{G&&(v&&!D.current?G.on("zoom",null):v||G.on("zoom",b=>{var W;const{onViewportChange:M}=A.getState();if(A.setState({transform:[b.transform.x,b.transform.y,b.transform.k]}),R.current=!!(r&&Eh(h,E.current??0)),(e||M)&&!((W=b.sourceEvent)!=null&&W.internal)){const H=Uo(b.transform);M==null||M(H),e==null||e(b.sourceEvent,H)}}))},[v,G,e,h,r]),k.useEffect(()=>{G&&G.on("end",b=>{if(!b.sourceEvent||b.sourceEvent.internal)return null;const{onViewportChangeEnd:M}=A.getState();if(D.current=!1,A.setState({paneDragging:!1}),r&&Eh(h,E.current??0)&&!R.current&&r(b.sourceEvent),R.current=!1,(n||M)&&cb(F.current,b.transform)){const W=Uo(b.transform);F.current=W,clearTimeout(C.current),C.current=setTimeout(()=>{M==null||M(W),n==null||n(b.sourceEvent,W)},o?150:0)}})},[G,o,h,n,r]),k.useEffect(()=>{G&&G.filter(b=>{const M=j||i,W=s&&b.ctrlKey;if((h===!0||Array.isArray(h)&&h.includes(1))&&b.button===1&&b.type==="mousedown"&&(fi(b,"react-flow__node")||fi(b,"react-flow__edge")))return!0;if(!h&&!M&&!o&&!u&&!s||v||!u&&b.type==="dblclick"||fi(b,x)&&b.type==="wheel"||fi(b,y)&&(b.type!=="wheel"||o&&b.type==="wheel"&&!j)||!s&&b.ctrlKey&&b.type==="wheel"||!M&&!o&&!W&&b.type==="wheel"||!h&&(b.type==="mousedown"||b.type==="touchstart")||Array.isArray(h)&&!h.includes(b.button)&&b.type==="mousedown")return!1;const H=Array.isArray(h)&&h.includes(b.button)||!b.button||b.button<=1;return(!b.ctrlKey||b.type==="wheel")&&H})},[v,G,i,s,o,u,h,f,j]),V.createElement("div",{className:"react-flow__renderer",ref:P,style:Rd},p)},fb=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function hb(){const{userSelectionActive:e,userSelectionRect:t}=lt(fb,jt);return e&&t?V.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Nh(e,t){const n=t.parentNode||t.parentId,r=e.find(i=>i.id===n);if(r){const i=t.position.x+t.width-r.width,s=t.position.y+t.height-r.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),s>0&&(r.style.height+=s),t.position.x<0){const o=Math.abs(t.position.x);r.position.x=r.position.x-o,r.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);r.position.y=r.position.y-o,r.style.height+=o,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function xy(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,i)=>{const s=e.filter(a=>a.id===i.id);if(s.length===0)return r.push(i),r;const o={...i};for(const a of s)if(a)switch(a.type){case"select":{o.selected=a.selected;break}case"position":{typeof a.position<"u"&&(o.position=a.position),typeof a.positionAbsolute<"u"&&(o.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(o.dragging=a.dragging),o.expandParent&&Nh(r,o);break}case"dimensions":{typeof a.dimensions<"u"&&(o.width=a.dimensions.width,o.height=a.dimensions.height),typeof a.updateStyle<"u"&&(o.style={...o.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(o.resizing=a.resizing),o.expandParent&&Nh(r,o);break}case"remove":return r}return r.push(o),r},n)}function vy(e,t){return xy(e,t)}function pb(e,t){return xy(e,t)}const dr=(e,t)=>({id:e,type:"select",selected:t});function Ni(e,t){return e.reduce((n,r)=>{const i=t.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(dr(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(dr(r.id,!1))),n},[])}const tc=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},gb=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),wy=k.memo(({isSelecting:e,selectionMode:t=ao.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:f,children:h})=>{const g=k.useRef(null),m=St(),S=k.useRef(0),w=k.useRef(0),N=k.useRef(),{userSelectionActive:d,elementsSelectable:p,dragging:x}=lt(gb,jt),y=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),S.current=0,w.current=0},C=B=>{s==null||s(B),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},A=B=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){B.preventDefault();return}o==null||o(B)},D=a?B=>a(B):void 0,R=B=>{const{resetSelectedElements:v,domNode:j}=m.getState();if(N.current=j==null?void 0:j.getBoundingClientRect(),!p||!e||B.button!==0||B.target!==g.current||!N.current)return;const{x:E,y:L}=Er(B,N.current);v(),m.setState({userSelectionRect:{width:0,height:0,startX:E,startY:L,x:E,y:L}}),r==null||r(B)},P=B=>{const{userSelectionRect:v,nodeInternals:j,edges:E,transform:L,onNodesChange:_,onEdgesChange:b,nodeOrigin:M,getNodes:W}=m.getState();if(!e||!N.current||!v)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const H=Er(B,N.current),re=v.startX??0,oe=v.startY??0,ge={...v,x:H.x<re?H.x:re,y:H.y<oe?H.y:oe,width:Math.abs(H.x-re),height:Math.abs(H.y-oe)},we=W(),z=ey(j,ge,L,t===ao.Partial,!0,M),ie=ty(z,E).map(he=>he.id),le=z.map(he=>he.id);if(S.current!==le.length){S.current=le.length;const he=Ni(we,le);he.length&&(_==null||_(he))}if(w.current!==ie.length){w.current=ie.length;const he=Ni(E,ie);he.length&&(b==null||b(he))}m.setState({userSelectionRect:ge})},F=B=>{if(B.button!==0)return;const{userSelectionRect:v}=m.getState();!d&&v&&B.target===g.current&&(C==null||C(B)),m.setState({nodesSelectionActive:S.current>0}),y(),i==null||i(B)},G=B=>{d&&(m.setState({nodesSelectionActive:S.current>0}),i==null||i(B)),y()},J=p&&(e||d);return V.createElement("div",{className:Mt(["react-flow__pane",{dragging:x,selection:e}]),onClick:J?void 0:tc(C,g),onContextMenu:tc(A,g),onWheel:tc(D,g),onMouseEnter:J?void 0:c,onMouseDown:J?R:void 0,onMouseMove:J?P:u,onMouseUp:J?F:void 0,onMouseLeave:J?G:f,ref:g,style:Rd},h,V.createElement(hb,null))});wy.displayName="Pane";function Sy(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:Sy(r,t):!1}function Ah(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function mb(e,t,n,r){return Array.from(e.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!Sy(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function yb(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function ky(e,t,n,r,i=[0,0],s){const o=yb(e,e.extent||r);let a=o;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const h=n.get(c),{x:g,y:m}=Gr(h,i).positionAbsolute;a=h&&cn(g)&&cn(m)&&cn(h.width)&&cn(h.height)?[[g+e.width*i[0],m+e.height*i[1]],[g+h.width-e.width+e.width*i[0],m+h.height-e.height+e.height*i[1]]]:a}else s==null||s("005",rr.error005()),a=o;else if(e.extent&&c&&e.extent!=="parent"){const h=n.get(c),{x:g,y:m}=Gr(h,i).positionAbsolute;a=[[e.extent[0][0]+g,e.extent[0][1]+m],[e.extent[1][0]+g,e.extent[1][1]+m]]}let u={x:0,y:0};if(c){const h=n.get(c);u=Gr(h,i).positionAbsolute}const f=a&&a!=="parent"?jd(t,a):t;return{position:{x:f.x-u.x,y:f.y-u.y},positionAbsolute:f}}function nc({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?r.find(i=>i.id===e):r[0],r]}const Dh=(e,t,n,r)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const s=Array.from(i),o=t.getBoundingClientRect(),a={x:o.width*r[0],y:o.height*r[1]};return s.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-o.left-a.x)/n,y:(u.top-o.top-a.y)/n,...Cd(c)}})};function ps(e,t,n){return n===void 0?n:r=>{const i=t().nodeInternals.get(e);i&&n(r,{...i})}}function wu({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c==null||c("012",rr.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&o)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var f;return(f=r==null?void 0:r.current)==null?void 0:f.blur()})):i([e])}function xb(){const e=St();return k.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:s}=e.getState(),o=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(o-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:s?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:s?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function rc(e){return(t,n,r)=>e==null?void 0:e(t,r)}function by({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const a=St(),[c,u]=k.useState(!1),f=k.useRef([]),h=k.useRef({x:null,y:null}),g=k.useRef(0),m=k.useRef(null),S=k.useRef({x:0,y:0}),w=k.useRef(null),N=k.useRef(!1),d=k.useRef(!1),p=k.useRef(!1),x=xb();return k.useEffect(()=>{if(e!=null&&e.current){const y=ln(e.current),C=({x:R,y:P})=>{const{nodeInternals:F,onNodeDrag:G,onSelectionDrag:J,updateNodePositions:B,nodeExtent:v,snapGrid:j,snapToGrid:E,nodeOrigin:L,onError:_}=a.getState();h.current={x:R,y:P};let b=!1,M={x:0,y:0,x2:0,y2:0};if(f.current.length>1&&v){const H=ya(f.current,L);M=lo(H)}if(f.current=f.current.map(H=>{const re={x:R-H.distance.x,y:P-H.distance.y};E&&(re.x=j[0]*Math.round(re.x/j[0]),re.y=j[1]*Math.round(re.y/j[1]));const oe=[[v[0][0],v[0][1]],[v[1][0],v[1][1]]];f.current.length>1&&v&&!H.extent&&(oe[0][0]=H.positionAbsolute.x-M.x+v[0][0],oe[1][0]=H.positionAbsolute.x+(H.width??0)-M.x2+v[1][0],oe[0][1]=H.positionAbsolute.y-M.y+v[0][1],oe[1][1]=H.positionAbsolute.y+(H.height??0)-M.y2+v[1][1]);const ge=ky(H,re,F,oe,L,_);return b=b||H.position.x!==ge.position.x||H.position.y!==ge.position.y,H.position=ge.position,H.positionAbsolute=ge.positionAbsolute,H}),!b)return;B(f.current,!0,!0),u(!0);const W=i?G:rc(J);if(W&&w.current){const[H,re]=nc({nodeId:i,dragItems:f.current,nodeInternals:F});W(w.current,H,re)}},A=()=>{if(!m.current)return;const[R,P]=Wm(S.current,m.current);if(R!==0||P!==0){const{transform:F,panBy:G}=a.getState();h.current.x=(h.current.x??0)-R/F[2],h.current.y=(h.current.y??0)-P/F[2],G({x:R,y:P})&&C(h.current)}g.current=requestAnimationFrame(A)},D=R=>{var L;const{nodeInternals:P,multiSelectionActive:F,nodesDraggable:G,unselectNodesAndEdges:J,onNodeDragStart:B,onSelectionDragStart:v}=a.getState();d.current=!0;const j=i?B:rc(v);(!o||!s)&&!F&&i&&((L=P.get(i))!=null&&L.selected||J()),i&&s&&o&&wu({id:i,store:a,nodeRef:e});const E=x(R);if(h.current=E,f.current=mb(P,G,E,i),j&&f.current){const[_,b]=nc({nodeId:i,dragItems:f.current,nodeInternals:P});j(R.sourceEvent,_,b)}};if(t)y.on(".drag",null);else{const R=DS().on("start",P=>{const{domNode:F,nodeDragThreshold:G}=a.getState();G===0&&D(P),p.current=!1;const J=x(P);h.current=J,m.current=(F==null?void 0:F.getBoundingClientRect())||null,S.current=Er(P.sourceEvent,m.current)}).on("drag",P=>{var B,v;const F=x(P),{autoPanOnNodeDrag:G,nodeDragThreshold:J}=a.getState();if(P.sourceEvent.type==="touchmove"&&P.sourceEvent.touches.length>1&&(p.current=!0),!p.current){if(!N.current&&d.current&&G&&(N.current=!0,A()),!d.current){const j=F.xSnapped-(((B=h==null?void 0:h.current)==null?void 0:B.x)??0),E=F.ySnapped-(((v=h==null?void 0:h.current)==null?void 0:v.y)??0);Math.sqrt(j*j+E*E)>J&&D(P)}(h.current.x!==F.xSnapped||h.current.y!==F.ySnapped)&&f.current&&d.current&&(w.current=P.sourceEvent,S.current=Er(P.sourceEvent,m.current),C(F))}}).on("end",P=>{if(!(!d.current||p.current)&&(u(!1),N.current=!1,d.current=!1,cancelAnimationFrame(g.current),f.current)){const{updateNodePositions:F,nodeInternals:G,onNodeDragStop:J,onSelectionDragStop:B}=a.getState(),v=i?J:rc(B);if(F(f.current,!1,!1),v){const[j,E]=nc({nodeId:i,dragItems:f.current,nodeInternals:G});v(P.sourceEvent,j,E)}}}).filter(P=>{const F=P.target;return!P.button&&(!n||!Ah(F,`.${n}`,e))&&(!r||Ah(F,r,e))});return y.call(R),()=>{y.on(".drag",null)}}}},[e,t,n,r,s,a,i,o,x]),c}function Cy(){const e=St();return k.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:f}=e.getState(),h=o().filter(p=>p.selected&&(p.draggable||f&&typeof p.draggable>"u")),g=a?c[0]:5,m=a?c[1]:5,S=n.isShiftPressed?4:1,w=n.x*g*S,N=n.y*m*S,d=h.map(p=>{if(p.positionAbsolute){const x={x:p.positionAbsolute.x+w,y:p.positionAbsolute.y+N};a&&(x.x=c[0]*Math.round(x.x/c[0]),x.y=c[1]*Math.round(x.y/c[1]));const{positionAbsolute:y,position:C}=ky(p,x,r,i,void 0,u);p.position=C,p.positionAbsolute=y}return p});s(d,!0,!1)},[])}const Li={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var gs=e=>{const t=({id:n,type:r,data:i,xPos:s,yPos:o,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:f,onMouseEnter:h,onMouseMove:g,onMouseLeave:m,onContextMenu:S,onDoubleClick:w,style:N,className:d,isDraggable:p,isSelectable:x,isConnectable:y,isFocusable:C,selectNodesOnDrag:A,sourcePosition:D,targetPosition:R,hidden:P,resizeObserver:F,dragHandle:G,zIndex:J,isParent:B,noDragClassName:v,noPanClassName:j,initialized:E,disableKeyboardA11y:L,ariaLabel:_,rfId:b,hasHandleBounds:M})=>{const W=St(),H=k.useRef(null),re=k.useRef(null),oe=k.useRef(D),ge=k.useRef(R),we=k.useRef(r),z=x||p||f||h||g||m,ie=Cy(),le=ps(n,W.getState,h),he=ps(n,W.getState,g),Te=ps(n,W.getState,m),Q=ps(n,W.getState,S),Ae=ps(n,W.getState,w),ve=Qe=>{const{nodeDragThreshold:me}=W.getState();if(x&&(!A||!p||me>0)&&wu({id:n,store:W,nodeRef:H}),f){const st=W.getState().nodeInternals.get(n);st&&f(Qe,{...st})}},Se=Qe=>{if(!gu(Qe)&&!L)if(Gm.includes(Qe.key)&&x){const me=Qe.key==="Escape";wu({id:n,store:W,unselect:me,nodeRef:H})}else p&&u&&Object.prototype.hasOwnProperty.call(Li,Qe.key)&&(W.setState({ariaLiveMessage:`Moved selected node ${Qe.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),ie({x:Li[Qe.key].x,y:Li[Qe.key].y,isShiftPressed:Qe.shiftKey}))};k.useEffect(()=>()=>{re.current&&(F==null||F.unobserve(re.current),re.current=null)},[]),k.useEffect(()=>{if(H.current&&!P){const Qe=H.current;(!E||!M||re.current!==Qe)&&(re.current&&(F==null||F.unobserve(re.current)),F==null||F.observe(Qe),re.current=Qe)}},[P,E,M]),k.useEffect(()=>{const Qe=we.current!==r,me=oe.current!==D,st=ge.current!==R;H.current&&(Qe||me||st)&&(Qe&&(we.current=r),me&&(oe.current=D),st&&(ge.current=R),W.getState().updateNodeDimensions([{id:n,nodeElement:H.current,forceUpdate:!0}]))},[n,r,D,R]);const Ve=by({nodeRef:H,disabled:P||!p,noDragClassName:v,handleSelector:G,nodeId:n,isSelectable:x,selectNodesOnDrag:A});return P?null:V.createElement("div",{className:Mt(["react-flow__node",`react-flow__node-${r}`,{[j]:p},d,{selected:u,selectable:x,parent:B,dragging:Ve}]),ref:H,style:{zIndex:J,transform:`translate(${a}px,${c}px)`,pointerEvents:z?"all":"none",visibility:E?"visible":"hidden",...N},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:le,onMouseMove:he,onMouseLeave:Te,onContextMenu:Q,onClick:ve,onDoubleClick:Ae,onKeyDown:C?Se:void 0,tabIndex:C?0:void 0,role:C?"button":void 0,"aria-describedby":L?void 0:`${hy}-${b}`,"aria-label":_},V.createElement(R2,{value:n},V.createElement(e,{id:n,data:i,type:r,xPos:s,yPos:o,selected:u,isConnectable:y,sourcePosition:D,targetPosition:R,dragging:Ve,dragHandle:G,zIndex:J})))};return t.displayName="NodeWrapper",k.memo(t)};const vb=e=>{const t=e.getNodes().filter(n=>n.selected);return{...ya(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function wb({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=St(),{width:i,height:s,x:o,y:a,transformString:c,userSelectionActive:u}=lt(vb,jt),f=Cy(),h=k.useRef(null);if(k.useEffect(()=>{var S;n||(S=h.current)==null||S.focus({preventScroll:!0})},[n]),by({nodeRef:h}),u||!i||!s)return null;const g=e?S=>{const w=r.getState().getNodes().filter(N=>N.selected);e(S,w)}:void 0,m=S=>{Object.prototype.hasOwnProperty.call(Li,S.key)&&f({x:Li[S.key].x,y:Li[S.key].y,isShiftPressed:S.shiftKey})};return V.createElement("div",{className:Mt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},V.createElement("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:i,height:s,top:a,left:o}}))}var Sb=k.memo(wb);const kb=e=>e.nodesSelectionActive,jy=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:f,selectionKeyCode:h,selectionOnDrag:g,selectionMode:m,onSelectionStart:S,onSelectionEnd:w,multiSelectionKeyCode:N,panActivationKeyCode:d,zoomActivationKeyCode:p,elementsSelectable:x,zoomOnScroll:y,zoomOnPinch:C,panOnScroll:A,panOnScrollSpeed:D,panOnScrollMode:R,zoomOnDoubleClick:P,panOnDrag:F,defaultViewport:G,translateExtent:J,minZoom:B,maxZoom:v,preventScrolling:j,onSelectionContextMenu:E,noWheelClassName:L,noPanClassName:_,disableKeyboardA11y:b})=>{const M=lt(kb),W=co(h),H=co(d),re=H||F,oe=H||A,ge=W||g&&re!==!0;return lb({deleteKeyCode:a,multiSelectionKeyCode:N}),V.createElement(db,{onMove:c,onMoveStart:u,onMoveEnd:f,onPaneContextMenu:s,elementsSelectable:x,zoomOnScroll:y,zoomOnPinch:C,panOnScroll:oe,panOnScrollSpeed:D,panOnScrollMode:R,zoomOnDoubleClick:P,panOnDrag:!W&&re,defaultViewport:G,translateExtent:J,minZoom:B,maxZoom:v,zoomActivationKeyCode:p,preventScrolling:j,noWheelClassName:L,noPanClassName:_},V.createElement(wy,{onSelectionStart:S,onSelectionEnd:w,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:re,isSelecting:!!ge,selectionMode:m},e,M&&V.createElement(Sb,{onSelectionContextMenu:E,noPanClassName:_,disableKeyboardA11y:b})))};jy.displayName="FlowRenderer";var bb=k.memo(jy);function Cb(e){return lt(k.useCallback(n=>e?ey(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function jb(e){const t={input:gs(e.input||cy),default:gs(e.default||vu),output:gs(e.output||dy),group:gs(e.group||zd)},n={},r=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=gs(e[s]||vu),i),n);return{...t,...r}}const Eb=({x:e,y:t,width:n,height:r,origin:i})=>!n||!r?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-n*i[0],y:t-r*i[1]},_b=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Ey=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:s,onError:o}=lt(_b,jt),a=Cb(e.onlyRenderVisibleElements),c=k.useRef(),u=k.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const f=new ResizeObserver(h=>{const g=h.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));s(g)});return c.current=f,f},[]);return k.useEffect(()=>()=>{var f;(f=c==null?void 0:c.current)==null||f.disconnect()},[]),V.createElement("div",{className:"react-flow__nodes",style:Rd},a.map(f=>{var C,A,D;let h=f.type||"default";e.nodeTypes[h]||(o==null||o("003",rr.error003(h)),h="default");const g=e.nodeTypes[h]||e.nodeTypes.default,m=!!(f.draggable||t&&typeof f.draggable>"u"),S=!!(f.selectable||i&&typeof f.selectable>"u"),w=!!(f.connectable||n&&typeof f.connectable>"u"),N=!!(f.focusable||r&&typeof f.focusable>"u"),d=e.nodeExtent?jd(f.positionAbsolute,e.nodeExtent):f.positionAbsolute,p=(d==null?void 0:d.x)??0,x=(d==null?void 0:d.y)??0,y=Eb({x:p,y:x,width:f.width??0,height:f.height??0,origin:e.nodeOrigin});return V.createElement(g,{key:f.id,id:f.id,className:f.className,style:f.style,type:h,data:f.data,sourcePosition:f.sourcePosition||ke.Bottom,targetPosition:f.targetPosition||ke.Top,hidden:f.hidden,xPos:p,yPos:x,xPosOrigin:y.x,yPosOrigin:y.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!f.selected,isDraggable:m,isSelectable:S,isConnectable:w,isFocusable:N,resizeObserver:u,dragHandle:f.dragHandle,zIndex:((C=f[gt])==null?void 0:C.z)??0,isParent:!!((A=f[gt])!=null&&A.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!f.width&&!!f.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:f.ariaLabel,hasHandleBounds:!!((D=f[gt])!=null&&D.handleBounds)})}))};Ey.displayName="NodeRenderer";var Nb=k.memo(Ey);const Ab=(e,t,n)=>n===ke.Left?e-t:n===ke.Right?e+t:e,Db=(e,t,n)=>n===ke.Top?e-t:n===ke.Bottom?e+t:e,Mh="react-flow__edgeupdater",zh=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a})=>V.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Mt([Mh,`${Mh}-${a}`]),cx:Ab(t,r,e),cy:Db(n,r,e),r,stroke:"transparent",fill:"transparent"}),Mb=()=>!0;var hi=e=>{const t=({id:n,className:r,type:i,data:s,onClick:o,onEdgeDoubleClick:a,selected:c,animated:u,label:f,labelStyle:h,labelShowBg:g,labelBgStyle:m,labelBgPadding:S,labelBgBorderRadius:w,style:N,source:d,target:p,sourceX:x,sourceY:y,targetX:C,targetY:A,sourcePosition:D,targetPosition:R,elementsSelectable:P,hidden:F,sourceHandleId:G,targetHandleId:J,onContextMenu:B,onMouseEnter:v,onMouseMove:j,onMouseLeave:E,reconnectRadius:L,onReconnect:_,onReconnectStart:b,onReconnectEnd:M,markerEnd:W,markerStart:H,rfId:re,ariaLabel:oe,isFocusable:ge,isReconnectable:we,pathOptions:z,interactionWidth:ie,disableKeyboardA11y:le})=>{const he=k.useRef(null),[Te,Q]=k.useState(!1),[Ae,ve]=k.useState(!1),Se=St(),Ve=k.useMemo(()=>`url('#${yu(H,re)}')`,[H,re]),Qe=k.useMemo(()=>`url('#${yu(W,re)}')`,[W,re]);if(F)return null;const me=te=>{var Xe;const{edges:Ce,addSelectedEdges:Le,unselectNodesAndEdges:Oe,multiSelectionActive:je}=Se.getState(),Ke=Ce.find(nt=>nt.id===n);Ke&&(P&&(Se.setState({nodesSelectionActive:!1}),Ke.selected&&je?(Oe({nodes:[],edges:[Ke]}),(Xe=he.current)==null||Xe.blur()):Le([n])),o&&o(te,Ke))},st=hs(n,Se.getState,a),I=hs(n,Se.getState,B),Y=hs(n,Se.getState,v),U=hs(n,Se.getState,j),O=hs(n,Se.getState,E),ee=(te,Ce)=>{if(te.button!==0)return;const{edges:Le,isValidConnection:Oe}=Se.getState(),je=Ce?p:d,Ke=(Ce?J:G)||null,Xe=Ce?"target":"source",nt=Oe||Mb,kt=Ce,T=Le.find(ue=>ue.id===n);ve(!0),b==null||b(te,T,Xe);const X=ue=>{ve(!1),M==null||M(ue,T,Xe)};sy({event:te,handleId:Ke,nodeId:je,onConnect:ue=>_==null?void 0:_(T,ue),isTarget:kt,getState:Se.getState,setState:Se.setState,isValidConnection:nt,edgeUpdaterType:Xe,onReconnectEnd:X})},q=te=>ee(te,!0),fe=te=>ee(te,!1),Z=()=>Q(!0),ae=()=>Q(!1),de=!P&&!o,Ue=te=>{var Ce;if(!le&&Gm.includes(te.key)&&P){const{unselectNodesAndEdges:Le,addSelectedEdges:Oe,edges:je}=Se.getState();te.key==="Escape"?((Ce=he.current)==null||Ce.blur(),Le({edges:[je.find(Xe=>Xe.id===n)]})):Oe([n])}};return V.createElement("g",{className:Mt(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:c,animated:u,inactive:de,updating:Te}]),onClick:me,onDoubleClick:st,onContextMenu:I,onMouseEnter:Y,onMouseMove:U,onMouseLeave:O,onKeyDown:ge?Ue:void 0,tabIndex:ge?0:void 0,role:ge?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":oe===null?void 0:oe||`Edge from ${d} to ${p}`,"aria-describedby":ge?`${py}-${re}`:void 0,ref:he},!Ae&&V.createElement(e,{id:n,source:d,target:p,selected:c,animated:u,label:f,labelStyle:h,labelShowBg:g,labelBgStyle:m,labelBgPadding:S,labelBgBorderRadius:w,data:s,style:N,sourceX:x,sourceY:y,targetX:C,targetY:A,sourcePosition:D,targetPosition:R,sourceHandleId:G,targetHandleId:J,markerStart:Ve,markerEnd:Qe,pathOptions:z,interactionWidth:ie}),we&&V.createElement(V.Fragment,null,(we==="source"||we===!0)&&V.createElement(zh,{position:D,centerX:x,centerY:y,radius:L,onMouseDown:q,onMouseEnter:Z,onMouseOut:ae,type:"source"}),(we==="target"||we===!0)&&V.createElement(zh,{position:R,centerX:C,centerY:A,radius:L,onMouseDown:fe,onMouseEnter:Z,onMouseOut:ae,type:"target"})))};return t.displayName="EdgeWrapper",k.memo(t)};function zb(e){const t={default:hi(e.default||Vl),straight:hi(e.bezier||Nd),step:hi(e.step||_d),smoothstep:hi(e.step||ma),simplebezier:hi(e.simplebezier||Ed)},n={},r=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=hi(e[s]||Vl),i),n);return{...t,...r}}function Rh(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,i=((n==null?void 0:n.y)||0)+t.y,s=(n==null?void 0:n.width)||t.width,o=(n==null?void 0:n.height)||t.height;switch(e){case ke.Top:return{x:r+s/2,y:i};case ke.Right:return{x:r+s,y:i+o/2};case ke.Bottom:return{x:r+s/2,y:i+o};case ke.Left:return{x:r,y:i+o/2}}}function Ph(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const Rb=(e,t,n,r,i,s)=>{const o=Rh(n,e,t),a=Rh(s,r,i);return{sourceX:o.x,sourceY:o.y,targetX:a.x,targetY:a.y}};function Pb({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:s,width:o,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+s)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const f=lo({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:a/c[2]}),h=Math.max(0,Math.min(f.x2,u.x2)-Math.max(f.x,u.x)),g=Math.max(0,Math.min(f.y2,u.y2)-Math.max(f.y,u.y));return Math.ceil(h*g)>0}function Th(e){var r,i,s,o,a;const t=((r=e==null?void 0:e[gt])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const Tb=[{level:0,isMaxLevel:!0,edges:[]}];function Ib(e,t,n=!1){let r=-1;const i=e.reduce((o,a)=>{var f,h;const c=cn(a.zIndex);let u=c?a.zIndex:0;if(n){const g=t.get(a.target),m=t.get(a.source),S=a.selected||(g==null?void 0:g.selected)||(m==null?void 0:m.selected),w=Math.max(((f=m==null?void 0:m[gt])==null?void 0:f.z)||0,((h=g==null?void 0:g[gt])==null?void 0:h.z)||0,1e3);u=(c?a.zIndex:0)+(S?w:0)}return o[u]?o[u].push(a):o[u]=[a],r=u>r?u:r,o},{}),s=Object.entries(i).map(([o,a])=>{const c=+o;return{edges:a,level:c,isMaxLevel:c===r}});return s.length===0?Tb:s}function $b(e,t,n){const r=lt(k.useCallback(i=>e?i.edges.filter(s=>{const o=t.get(s.source),a=t.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&Pb({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:a.width,targetHeight:a.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return Ib(r,t,n)}const Lb=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Ob=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Ih={[Ul.Arrow]:Lb,[Ul.ArrowClosed]:Ob};function Bb(e){const t=St();return k.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Ih,e)?Ih[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",rr.error009(e)),null)},[e])}const Fb=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const c=Bb(t);return c?V.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0"},V.createElement(c,{color:n,strokeWidth:o})):null},Hb=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const a=yu(o,t);r.includes(a)||(i.push({id:a,color:o.color||e,...o}),r.push(a))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},_y=({defaultColor:e,rfId:t})=>{const n=lt(k.useCallback(Hb({defaultColor:e,rfId:t}),[e,t]),(r,i)=>!(r.length!==i.length||r.some((s,o)=>s.id!==i[o].id)));return V.createElement("defs",null,n.map(r=>V.createElement(Fb,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};_y.displayName="MarkerDefinitions";var Wb=k.memo(_y);const Ub=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Ny=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:f,onEdgeDoubleClick:h,onReconnect:g,onReconnectStart:m,onReconnectEnd:S,reconnectRadius:w,children:N,disableKeyboardA11y:d})=>{const{edgesFocusable:p,edgesUpdatable:x,elementsSelectable:y,width:C,height:A,connectionMode:D,nodeInternals:R,onError:P}=lt(Ub,jt),F=$b(t,R,n);return C?V.createElement(V.Fragment,null,F.map(({level:G,edges:J,isMaxLevel:B})=>V.createElement("svg",{key:G,style:{zIndex:G},width:C,height:A,className:"react-flow__edges react-flow__container"},B&&V.createElement(Wb,{defaultColor:e,rfId:r}),V.createElement("g",null,J.map(v=>{const[j,E,L]=Th(R.get(v.source)),[_,b,M]=Th(R.get(v.target));if(!L||!M)return null;let W=v.type||"default";i[W]||(P==null||P("011",rr.error011(W)),W="default");const H=i[W]||i.default,re=D===ti.Strict?b.target:(b.target??[]).concat(b.source??[]),oe=Ph(E.source,v.sourceHandle),ge=Ph(re,v.targetHandle),we=(oe==null?void 0:oe.position)||ke.Bottom,z=(ge==null?void 0:ge.position)||ke.Top,ie=!!(v.focusable||p&&typeof v.focusable>"u"),le=v.reconnectable||v.updatable,he=typeof g<"u"&&(le||x&&typeof le>"u");if(!oe||!ge)return P==null||P("008",rr.error008(oe,v)),null;const{sourceX:Te,sourceY:Q,targetX:Ae,targetY:ve}=Rb(j,oe,we,_,ge,z);return V.createElement(H,{key:v.id,id:v.id,className:Mt([v.className,s]),type:W,data:v.data,selected:!!v.selected,animated:!!v.animated,hidden:!!v.hidden,label:v.label,labelStyle:v.labelStyle,labelShowBg:v.labelShowBg,labelBgStyle:v.labelBgStyle,labelBgPadding:v.labelBgPadding,labelBgBorderRadius:v.labelBgBorderRadius,style:v.style,source:v.source,target:v.target,sourceHandleId:v.sourceHandle,targetHandleId:v.targetHandle,markerEnd:v.markerEnd,markerStart:v.markerStart,sourceX:Te,sourceY:Q,targetX:Ae,targetY:ve,sourcePosition:we,targetPosition:z,elementsSelectable:y,onContextMenu:o,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:f,onEdgeDoubleClick:h,onReconnect:g,onReconnectStart:m,onReconnectEnd:S,reconnectRadius:w,rfId:r,ariaLabel:v.ariaLabel,isFocusable:ie,isReconnectable:he,pathOptions:"pathOptions"in v?v.pathOptions:void 0,interactionWidth:v.interactionWidth,disableKeyboardA11y:d})})))),N):null};Ny.displayName="EdgeRenderer";var Vb=k.memo(Ny);const Yb=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Gb({children:e}){const t=lt(Yb);return V.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function Kb(e){const t=_n(),n=k.useRef(!1);k.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Xb={[ke.Left]:ke.Right,[ke.Right]:ke.Left,[ke.Top]:ke.Bottom,[ke.Bottom]:ke.Top},Ay=({nodeId:e,handleType:t,style:n,type:r=gr.Bezier,CustomComponent:i,connectionStatus:s})=>{var A,D,R;const{fromNode:o,handleId:a,toX:c,toY:u,connectionMode:f}=lt(k.useCallback(P=>({fromNode:P.nodeInternals.get(e),handleId:P.connectionHandleId,toX:(P.connectionPosition.x-P.transform[0])/P.transform[2],toY:(P.connectionPosition.y-P.transform[1])/P.transform[2],connectionMode:P.connectionMode}),[e]),jt),h=(A=o==null?void 0:o[gt])==null?void 0:A.handleBounds;let g=h==null?void 0:h[t];if(f===ti.Loose&&(g=g||(h==null?void 0:h[t==="source"?"target":"source"])),!o||!g)return null;const m=a?g.find(P=>P.id===a):g[0],S=m?m.x+m.width/2:(o.width??0)/2,w=m?m.y+m.height/2:o.height??0,N=(((D=o.positionAbsolute)==null?void 0:D.x)??0)+S,d=(((R=o.positionAbsolute)==null?void 0:R.y)??0)+w,p=m==null?void 0:m.position,x=p?Xb[p]:null;if(!p||!x)return null;if(i)return V.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:m,fromX:N,fromY:d,toX:c,toY:u,fromPosition:p,toPosition:x,connectionStatus:s});let y="";const C={sourceX:N,sourceY:d,sourcePosition:p,targetX:c,targetY:u,targetPosition:x};return r===gr.Bezier?[y]=Zm(C):r===gr.Step?[y]=mu({...C,borderRadius:0}):r===gr.SmoothStep?[y]=mu(C):r===gr.SimpleBezier?[y]=Jm(C):y=`M${N},${d} ${c},${u}`,V.createElement("path",{d:y,fill:"none",className:"react-flow__connection-path",style:n})};Ay.displayName="ConnectionLine";const Qb=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Jb({containerStyle:e,style:t,type:n,component:r}){const{nodeId:i,handleType:s,nodesConnectable:o,width:a,height:c,connectionStatus:u}=lt(Qb,jt);return!(i&&s&&a&&o)?null:V.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},V.createElement("g",{className:Mt(["react-flow__connection",u])},V.createElement(Ay,{nodeId:i,handleType:s,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function $h(e,t){return k.useRef(null),St(),k.useMemo(()=>t(e),[e])}const Dy=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:f,onNodeMouseMove:h,onNodeMouseLeave:g,onNodeContextMenu:m,onSelectionContextMenu:S,onSelectionStart:w,onSelectionEnd:N,connectionLineType:d,connectionLineStyle:p,connectionLineComponent:x,connectionLineContainerStyle:y,selectionKeyCode:C,selectionOnDrag:A,selectionMode:D,multiSelectionKeyCode:R,panActivationKeyCode:P,zoomActivationKeyCode:F,deleteKeyCode:G,onlyRenderVisibleElements:J,elementsSelectable:B,selectNodesOnDrag:v,defaultViewport:j,translateExtent:E,minZoom:L,maxZoom:_,preventScrolling:b,defaultMarkerColor:M,zoomOnScroll:W,zoomOnPinch:H,panOnScroll:re,panOnScrollSpeed:oe,panOnScrollMode:ge,zoomOnDoubleClick:we,panOnDrag:z,onPaneClick:ie,onPaneMouseEnter:le,onPaneMouseMove:he,onPaneMouseLeave:Te,onPaneScroll:Q,onPaneContextMenu:Ae,onEdgeContextMenu:ve,onEdgeMouseEnter:Se,onEdgeMouseMove:Ve,onEdgeMouseLeave:Qe,onReconnect:me,onReconnectStart:st,onReconnectEnd:I,reconnectRadius:Y,noDragClassName:U,noWheelClassName:O,noPanClassName:ee,elevateEdgesOnSelect:q,disableKeyboardA11y:fe,nodeOrigin:Z,nodeExtent:ae,rfId:de})=>{const Ue=$h(e,jb),te=$h(t,zb);return Kb(s),V.createElement(bb,{onPaneClick:ie,onPaneMouseEnter:le,onPaneMouseMove:he,onPaneMouseLeave:Te,onPaneContextMenu:Ae,onPaneScroll:Q,deleteKeyCode:G,selectionKeyCode:C,selectionOnDrag:A,selectionMode:D,onSelectionStart:w,onSelectionEnd:N,multiSelectionKeyCode:R,panActivationKeyCode:P,zoomActivationKeyCode:F,elementsSelectable:B,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:W,zoomOnPinch:H,zoomOnDoubleClick:we,panOnScroll:re,panOnScrollSpeed:oe,panOnScrollMode:ge,panOnDrag:z,defaultViewport:j,translateExtent:E,minZoom:L,maxZoom:_,onSelectionContextMenu:S,preventScrolling:b,noDragClassName:U,noWheelClassName:O,noPanClassName:ee,disableKeyboardA11y:fe},V.createElement(Gb,null,V.createElement(Vb,{edgeTypes:te,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:J,onEdgeContextMenu:ve,onEdgeMouseEnter:Se,onEdgeMouseMove:Ve,onEdgeMouseLeave:Qe,onReconnect:me,onReconnectStart:st,onReconnectEnd:I,reconnectRadius:Y,defaultMarkerColor:M,noPanClassName:ee,elevateEdgesOnSelect:!!q,disableKeyboardA11y:fe,rfId:de},V.createElement(Jb,{style:p,type:d,component:x,containerStyle:y})),V.createElement("div",{className:"react-flow__edgelabel-renderer"}),V.createElement(Nb,{nodeTypes:Ue,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:f,onNodeMouseMove:h,onNodeMouseLeave:g,onNodeContextMenu:m,selectNodesOnDrag:v,onlyRenderVisibleElements:J,noPanClassName:ee,noDragClassName:U,disableKeyboardA11y:fe,nodeOrigin:Z,nodeExtent:ae,rfId:de})))};Dy.displayName="GraphView";var Zb=k.memo(Dy);const Su=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],or={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Su,nodeExtent:Su,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ti.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:_2,isValidConnection:void 0},qb=()=>H1((e,t)=>({...or,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:s}=t();e({nodeInternals:ec(n,r,i,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",s=typeof r<"u",o=i?ec(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:s?r:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),f=c==null?void 0:c.querySelector(".react-flow__viewport");if(!f)return;const h=window.getComputedStyle(f),{m22:g}=new window.DOMMatrixReadOnly(h.transform),m=n.reduce((w,N)=>{const d=i.get(N.id);if(d!=null&&d.hidden)i.set(d.id,{...d,[gt]:{...d[gt],handleBounds:void 0}});else if(d){const p=Cd(N.nodeElement);!!(p.width&&p.height&&(d.width!==p.width||d.height!==p.height||N.forceUpdate))&&(i.set(d.id,{...d,[gt]:{...d[gt],handleBounds:{source:Dh(".source",N.nodeElement,g,u),target:Dh(".target",N.nodeElement,g,u)}},...p}),w.push({id:d.id,type:"dimensions",dimensions:p}))}return w},[]);my(i,u);const S=o||s&&!o&&yy(t,{initial:!0,...a});e({nodeInternals:new Map(i),fitViewOnInitDone:S}),(m==null?void 0:m.length)>0&&(r==null||r(m))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:s}=t(),o=n.map(a=>{const c={id:a.id,type:"position",dragging:i};return r&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});s(o)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:a,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(s){const u=vy(n,a()),f=ec(u,i,o,c);e({nodeInternals:f})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=t();let o,a=null;r?o=n.map(c=>dr(c,!0)):(o=Ni(s(),n),a=Ni(i,[])),Wo({changedNodes:o,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=t();let o,a=null;r?o=n.map(c=>dr(c,!0)):(o=Ni(i,n),a=Ni(s(),[])),Wo({changedNodes:a,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:s}=t(),o=n||s(),a=r||i,c=o.map(f=>(f.selected=!1,dr(f.id,!1))),u=a.map(f=>dr(f.id,!1));Wo({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=t();r==null||r.scaleExtent([n,i]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=t();r==null||r.scaleExtent([i,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),s=r().filter(a=>a.selected).map(a=>dr(a.id,!1)),o=n.filter(a=>a.selected).map(a=>dr(a.id,!1));Wo({changedNodes:s,changedEdges:o,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(i=>{i.positionAbsolute=jd(i.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:s,d3Zoom:o,d3Selection:a,translateExtent:c}=t();if(!o||!a||!n.x&&!n.y)return!1;const u=Jn.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),f=[[0,0],[i,s]],h=o==null?void 0:o.constrain()(u,f,c);return o.transform(a,h),r[0]!==h.x||r[1]!==h.y||r[2]!==h.k},cancelConnection:()=>e({connectionNodeId:or.connectionNodeId,connectionHandleId:or.connectionHandleId,connectionHandleType:or.connectionHandleType,connectionStatus:or.connectionStatus,connectionStartHandle:or.connectionStartHandle,connectionEndHandle:or.connectionEndHandle}),reset:()=>e({...or})}),Object.is),My=({children:e})=>{const t=k.useRef(null);return t.current||(t.current=qb()),V.createElement(w2,{value:t.current},e)};My.displayName="ReactFlowProvider";const zy=({children:e})=>k.useContext(ga)?V.createElement(V.Fragment,null,e):V.createElement(My,null,e);zy.displayName="ReactFlowWrapper";const eC={input:cy,default:vu,output:dy,group:zd},tC={default:Vl,straight:Nd,step:_d,smoothstep:ma,simplebezier:Ed},nC=[0,0],rC=[15,15],iC={x:0,y:0,zoom:1},sC={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Pd=k.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s=eC,edgeTypes:o=tC,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:f,onMoveStart:h,onMoveEnd:g,onConnect:m,onConnectStart:S,onConnectEnd:w,onClickConnectStart:N,onClickConnectEnd:d,onNodeMouseEnter:p,onNodeMouseMove:x,onNodeMouseLeave:y,onNodeContextMenu:C,onNodeDoubleClick:A,onNodeDragStart:D,onNodeDrag:R,onNodeDragStop:P,onNodesDelete:F,onEdgesDelete:G,onSelectionChange:J,onSelectionDragStart:B,onSelectionDrag:v,onSelectionDragStop:j,onSelectionContextMenu:E,onSelectionStart:L,onSelectionEnd:_,connectionMode:b=ti.Strict,connectionLineType:M=gr.Bezier,connectionLineStyle:W,connectionLineComponent:H,connectionLineContainerStyle:re,deleteKeyCode:oe="Backspace",selectionKeyCode:ge="Shift",selectionOnDrag:we=!1,selectionMode:z=ao.Full,panActivationKeyCode:ie="Space",multiSelectionKeyCode:le=Wl()?"Meta":"Control",zoomActivationKeyCode:he=Wl()?"Meta":"Control",snapToGrid:Te=!1,snapGrid:Q=rC,onlyRenderVisibleElements:Ae=!1,selectNodesOnDrag:ve=!0,nodesDraggable:Se,nodesConnectable:Ve,nodesFocusable:Qe,nodeOrigin:me=nC,edgesFocusable:st,edgesUpdatable:I,elementsSelectable:Y,defaultViewport:U=iC,minZoom:O=.5,maxZoom:ee=2,translateExtent:q=Su,preventScrolling:fe=!0,nodeExtent:Z,defaultMarkerColor:ae="#b1b1b7",zoomOnScroll:de=!0,zoomOnPinch:Ue=!0,panOnScroll:te=!1,panOnScrollSpeed:Ce=.5,panOnScrollMode:Le=Wr.Free,zoomOnDoubleClick:Oe=!0,panOnDrag:je=!0,onPaneClick:Ke,onPaneMouseEnter:Xe,onPaneMouseMove:nt,onPaneMouseLeave:kt,onPaneScroll:T,onPaneContextMenu:X,children:pe,onEdgeContextMenu:ue,onEdgeDoubleClick:De,onEdgeMouseEnter:Re,onEdgeMouseMove:Pe,onEdgeMouseLeave:Ie,onEdgeUpdate:et,onEdgeUpdateStart:Be,onEdgeUpdateEnd:$,onReconnect:se,onReconnectStart:ye,onReconnectEnd:K,reconnectRadius:ce=10,edgeUpdaterRadius:xe=10,onNodesChange:$e,onEdgesChange:Me,noDragClassName:He="nodrag",noWheelClassName:ze="nowheel",noPanClassName:Fe="nopan",fitView:Ee=!1,fitViewOptions:Ye,connectOnClick:_e=!0,attributionPosition:Ge,proOptions:rt,defaultEdgeOptions:rn,elevateNodesOnSelect:hn=!0,elevateEdgesOnSelect:We=!1,disableKeyboardA11y:pn=!1,autoPanOnConnect:ii=!0,autoPanOnNodeDrag:ns=!0,connectionRadius:Td=20,isValidConnection:Xy,onError:Qy,style:Jy,id:Id,nodeDragThreshold:Zy,...qy},e0)=>{const xa=Id||"1";return V.createElement("div",{...qy,style:{...Jy,...sC},ref:e0,className:Mt(["react-flow",i]),"data-testid":"rf__wrapper",id:Id},V.createElement(zy,null,V.createElement(Zb,{onInit:u,onMove:f,onMoveStart:h,onMoveEnd:g,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:p,onNodeMouseMove:x,onNodeMouseLeave:y,onNodeContextMenu:C,onNodeDoubleClick:A,nodeTypes:s,edgeTypes:o,connectionLineType:M,connectionLineStyle:W,connectionLineComponent:H,connectionLineContainerStyle:re,selectionKeyCode:ge,selectionOnDrag:we,selectionMode:z,deleteKeyCode:oe,multiSelectionKeyCode:le,panActivationKeyCode:ie,zoomActivationKeyCode:he,onlyRenderVisibleElements:Ae,selectNodesOnDrag:ve,defaultViewport:U,translateExtent:q,minZoom:O,maxZoom:ee,preventScrolling:fe,zoomOnScroll:de,zoomOnPinch:Ue,zoomOnDoubleClick:Oe,panOnScroll:te,panOnScrollSpeed:Ce,panOnScrollMode:Le,panOnDrag:je,onPaneClick:Ke,onPaneMouseEnter:Xe,onPaneMouseMove:nt,onPaneMouseLeave:kt,onPaneScroll:T,onPaneContextMenu:X,onSelectionContextMenu:E,onSelectionStart:L,onSelectionEnd:_,onEdgeContextMenu:ue,onEdgeDoubleClick:De,onEdgeMouseEnter:Re,onEdgeMouseMove:Pe,onEdgeMouseLeave:Ie,onReconnect:se??et,onReconnectStart:ye??Be,onReconnectEnd:K??$,reconnectRadius:ce??xe,defaultMarkerColor:ae,noDragClassName:He,noWheelClassName:ze,noPanClassName:Fe,elevateEdgesOnSelect:We,rfId:xa,disableKeyboardA11y:pn,nodeOrigin:me,nodeExtent:Z}),V.createElement(X2,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:S,onConnectEnd:w,onClickConnectStart:N,onClickConnectEnd:d,nodesDraggable:Se,nodesConnectable:Ve,nodesFocusable:Qe,edgesFocusable:st,edgesUpdatable:I,elementsSelectable:Y,elevateNodesOnSelect:hn,minZoom:O,maxZoom:ee,nodeExtent:Z,onNodesChange:$e,onEdgesChange:Me,snapToGrid:Te,snapGrid:Q,connectionMode:b,translateExtent:q,connectOnClick:_e,defaultEdgeOptions:rn,fitView:Ee,fitViewOptions:Ye,onNodesDelete:F,onEdgesDelete:G,onNodeDragStart:D,onNodeDrag:R,onNodeDragStop:P,onSelectionDrag:v,onSelectionDragStart:B,onSelectionDragStop:j,noPanClassName:Fe,nodeOrigin:me,rfId:xa,autoPanOnConnect:ii,autoPanOnNodeDrag:ns,onError:Qy,connectionRadius:Td,isValidConnection:Xy,nodeDragThreshold:Zy}),V.createElement(G2,{onSelectionChange:J}),pe,V.createElement(k2,{proOptions:rt,position:Ge}),V.createElement(eb,{rfId:xa,disableKeyboardA11y:pn})))});Pd.displayName="ReactFlow";function Ry(e){return t=>{const[n,r]=k.useState(t),i=k.useCallback(s=>r(o=>e(s,o)),[]);return[n,r,i]}}const Py=Ry(vy),Ty=Ry(pb),Iy=({id:e,x:t,y:n,width:r,height:i,style:s,color:o,strokeColor:a,strokeWidth:c,className:u,borderRadius:f,shapeRendering:h,onClick:g,selected:m})=>{const{background:S,backgroundColor:w}=s||{},N=o||S||w;return V.createElement("rect",{className:Mt(["react-flow__minimap-node",{selected:m},u]),x:t,y:n,rx:f,ry:f,width:r,height:i,fill:N,stroke:a,strokeWidth:c,shapeRendering:h,onClick:g?d=>g(d,e):void 0})};Iy.displayName="MiniMapNode";var oC=k.memo(Iy);const lC=e=>e.nodeOrigin,aC=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),ic=e=>e instanceof Function?e:()=>e;function cC({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i=2,nodeComponent:s=oC,onClick:o}){const a=lt(aC,jt),c=lt(lC),u=ic(t),f=ic(e),h=ic(n),g=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return V.createElement(V.Fragment,null,a.map(m=>{const{x:S,y:w}=Gr(m,c).positionAbsolute;return V.createElement(s,{key:m.id,x:S,y:w,width:m.width,height:m.height,style:m.style,selected:m.selected,className:h(m),color:u(m),borderRadius:r,strokeColor:f(m),strokeWidth:i,shapeRendering:g,onClick:o,id:m.id})}))}var uC=k.memo(cC);const dC=200,fC=150,hC=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?j2(ya(t,e.nodeOrigin),n):n,rfId:e.rfId}},pC="react-flow__minimap-desc";function $y({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:f=1,position:h="bottom-right",onClick:g,onNodeClick:m,pannable:S=!1,zoomable:w=!1,ariaLabel:N="React Flow mini map",inversePan:d=!1,zoomStep:p=10,offsetScale:x=5}){const y=St(),C=k.useRef(null),{boundingRect:A,viewBB:D,rfId:R}=lt(hC,jt),P=(e==null?void 0:e.width)??dC,F=(e==null?void 0:e.height)??fC,G=A.width/P,J=A.height/F,B=Math.max(G,J),v=B*P,j=B*F,E=x*B,L=A.x-(v-A.width)/2-E,_=A.y-(j-A.height)/2-E,b=v+E*2,M=j+E*2,W=`${pC}-${R}`,H=k.useRef(0);H.current=B,k.useEffect(()=>{if(C.current){const ge=ln(C.current),we=le=>{const{transform:he,d3Selection:Te,d3Zoom:Q}=y.getState();if(le.sourceEvent.type!=="wheel"||!Te||!Q)return;const Ae=-le.sourceEvent.deltaY*(le.sourceEvent.deltaMode===1?.05:le.sourceEvent.deltaMode?1:.002)*p,ve=he[2]*Math.pow(2,Ae);Q.scaleTo(Te,ve)},z=le=>{const{transform:he,d3Selection:Te,d3Zoom:Q,translateExtent:Ae,width:ve,height:Se}=y.getState();if(le.sourceEvent.type!=="mousemove"||!Te||!Q)return;const Ve=H.current*Math.max(1,he[2])*(d?-1:1),Qe={x:he[0]-le.sourceEvent.movementX*Ve,y:he[1]-le.sourceEvent.movementY*Ve},me=[[0,0],[ve,Se]],st=Jn.translate(Qe.x,Qe.y).scale(he[2]),I=Q.constrain()(st,me,Ae);Q.transform(Te,I)},ie=Fm().on("zoom",S?z:null).on("zoom.wheel",w?we:null);return ge.call(ie),()=>{ge.on("zoom",null)}}},[S,w,d,p]);const re=g?ge=>{const we=vn(ge);g(ge,{x:we[0],y:we[1]})}:void 0,oe=m?(ge,we)=>{const z=y.getState().nodeInternals.get(we);m(ge,z)}:void 0;return V.createElement(bd,{position:h,style:e,className:Mt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},V.createElement("svg",{width:P,height:F,viewBox:`${L} ${_} ${b} ${M}`,role:"img","aria-labelledby":W,ref:C,onClick:re},N&&V.createElement("title",{id:W},N),V.createElement(uC,{onClick:oe,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:a}),V.createElement("path",{className:"react-flow__minimap-mask",d:`M${L-E},${_-E}h${b+E*2}v${M+E*2}h${-b-E*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:f,pointerEvents:"none"})))}$y.displayName="MiniMap";var Ly=k.memo($y);function gC(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},V.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function mC(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},V.createElement("path",{d:"M0 0h32v4.2H0z"}))}function yC(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},V.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function xC(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},V.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function vC(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},V.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const js=({children:e,className:t,...n})=>V.createElement("button",{type:"button",className:Mt(["react-flow__controls-button",t]),...n},e);js.displayName="ControlButton";const wC=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Oy=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:c,className:u,children:f,position:h="bottom-left"})=>{const g=St(),[m,S]=k.useState(!1),{isInteractive:w,minZoomReached:N,maxZoomReached:d}=lt(wC,jt),{zoomIn:p,zoomOut:x,fitView:y}=_n();if(k.useEffect(()=>{S(!0)},[]),!m)return null;const C=()=>{p(),s==null||s()},A=()=>{x(),o==null||o()},D=()=>{y(i),a==null||a()},R=()=>{g.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),c==null||c(!w)};return V.createElement(bd,{className:Mt(["react-flow__controls",u]),position:h,style:e,"data-testid":"rf__controls"},t&&V.createElement(V.Fragment,null,V.createElement(js,{onClick:C,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:d},V.createElement(gC,null)),V.createElement(js,{onClick:A,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:N},V.createElement(mC,null))),n&&V.createElement(js,{className:"react-flow__controls-fitview",onClick:D,title:"fit view","aria-label":"fit view"},V.createElement(yC,null)),r&&V.createElement(js,{className:"react-flow__controls-interactive",onClick:R,title:"toggle interactivity","aria-label":"toggle interactivity"},w?V.createElement(vC,null):V.createElement(xC,null)),f)};Oy.displayName="Controls";var By=k.memo(Oy),Cn;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Cn||(Cn={}));function SC({color:e,dimensions:t,lineWidth:n}){return V.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function kC({color:e,radius:t}){return V.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const bC={[Cn.Dots]:"#91919a",[Cn.Lines]:"#eee",[Cn.Cross]:"#e2e2e2"},CC={[Cn.Dots]:1,[Cn.Lines]:1,[Cn.Cross]:6},jC=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Fy({id:e,variant:t=Cn.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=2,color:o,style:a,className:c}){const u=k.useRef(null),{transform:f,patternId:h}=lt(jC,jt),g=o||bC[t],m=r||CC[t],S=t===Cn.Dots,w=t===Cn.Cross,N=Array.isArray(n)?n:[n,n],d=[N[0]*f[2]||1,N[1]*f[2]||1],p=m*f[2],x=w?[p,p]:d,y=S?[p/s,p/s]:[x[0]/s,x[1]/s];return V.createElement("svg",{className:Mt(["react-flow__background",c]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},V.createElement("pattern",{id:h+e,x:f[0]%d[0],y:f[1]%d[1],width:d[0],height:d[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${y[0]},-${y[1]})`},S?V.createElement(kC,{color:g,radius:p/s}):V.createElement(SC,{dimensions:x,color:g,lineWidth:i})),V.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${h+e})`}))}Fy.displayName="Background";var Hy=k.memo(Fy);function sc(e){return l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:12,color:"#475569",marginBottom:6},children:e.label}),l.jsx("input",{type:"range",min:e.min,max:e.max,value:e.value,onChange:t=>e.onChange(Number(t.target.value)),style:{width:"100%"}})]})}const Ai={width:"100%",padding:"8px 10px",borderRadius:8,border:"1px solid #cbd5e1"},Ln={display:"flex",alignItems:"center",gap:8},Wy={padding:"2px 8px",borderRadius:999,border:"1px solid #e2e8f0",background:"#f8fafc",fontSize:12},Vo={border:"1px solid #e2e8f0",borderRadius:12,background:"white"},lr={padding:"8px 10px",borderRadius:8,border:"1px solid #cbd5e1",background:"white",cursor:"pointer"},$r={color:"#64748b",fontSize:12},es={position:"absolute",top:4,right:4,width:22,height:22,borderRadius:999,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",color:"#334155",lineHeight:"20px",textAlign:"center",zIndex:10},gi={d4:2.5,d6:3.5,d8:4.5,d10:5.5,d12:6.5};function EC(e){const t=new Set(["4","6","8","10","12"]);return e.toLowerCase().split("+").map(n=>n.trim()).filter(Boolean).map(n=>{const r=n.split("d"),i=parseInt(r[0],10)||0,s=r[1]||"6",o=t.has(s)?`d${s}`:"d6";return{n:i,die:o}})}function oc(e,t){const n={d4:.75,d6:.6667,d8:.625,d10:.6,d12:.5833},r=EC(e);let i=0;return r.forEach(({n:s,die:o})=>{const a=gi[o]??0,c=t!=null&&t.greatWeaponFighting?n[o]??0:0;i+=s*(a+c)}),i}function Lh(e){return e>=17?6:e>=13?5:e>=9?4:e>=5?3:2}function Oh(e){return e>=20?4:e>=11?3:e>=5?2:1}function Bh(e){return Math.floor((e-10)/2)}function _C(e,t,n){return Math.max(t,Math.min(n,e))}function Fh(e,t){return t==="adv"?1-(1-e)**2:t==="dis"?e**2:e}const NC=[{id:"defense",name:"Defense (+1 AC)",tag:"defense"},{id:"dueling",name:"Dueling (+2 dmg with 1H melee)",tag:"melee-1h"},{id:"great-weapon",name:"Great Weapon Fighting (reroll 1-2)",tag:"melee-2h"},{id:"archery",name:"Archery (+2 to hit)",tag:"ranged"},{id:"two-weapon",name:"Two-Weapon Fighting (add mod to offhand)",tag:"twf"}],Oi=[{id:"longsword",name:"Longsword",dice:"1d8",versatile:"1d10",type:"slashing",properties:["versatile"],handed:"1h",finesse:!1,ranged:!1,tags:[]},{id:"greatsword",name:"Greatsword",dice:"2d6",type:"slashing",properties:["heavy","two-handed"],handed:"2h",finesse:!1,ranged:!1,tags:["gwm"]},{id:"rapier",name:"Rapier",dice:"1d8",type:"piercing",properties:["finesse"],handed:"1h",finesse:!0,ranged:!1,tags:[]},{id:"shortsword",name:"Shortsword",dice:"1d6",type:"piercing",properties:["finesse","light"],handed:"1h",finesse:!0,ranged:!1,tags:[]},{id:"longbow",name:"Longbow",dice:"1d8",type:"piercing",properties:["heavy","two-handed","ammunition"],handed:"2h",finesse:!1,ranged:!0,tags:["ss"]},{id:"handaxe",name:"Handaxe",dice:"1d6",type:"slashing",properties:["light","thrown"],handed:"1h",finesse:!1,ranged:!1,tags:[]},{id:"glaive",name:"Glaive",dice:"1d10",type:"slashing",properties:["heavy","reach","two-handed"],handed:"2h",finesse:!1,ranged:!1,tags:["gwm","pam"]},{id:"halberd",name:"Halberd",dice:"1d10",type:"slashing",properties:["heavy","reach","two-handed"],handed:"2h",finesse:!1,ranged:!1,tags:["gwm","pam"]},{id:"spear",name:"Spear",dice:"1d6",versatile:"1d8",type:"piercing",properties:["thrown","versatile"],handed:"1h",finesse:!1,ranged:!1,tags:["pam"]},{id:"hcrossbow",name:"Heavy Crossbow",dice:"1d10",type:"piercing",properties:["heavy","ammunition","loading","two-handed"],handed:"2h",finesse:!1,ranged:!0,tags:["ss","cbe"]}];function ts(e){return l.jsxs("div",{style:{minWidth:260,background:"#f3f4f6",border:"1px solid #e2e8f0",borderRadius:12},children:[l.jsx("div",{style:{padding:10,borderBottom:"1px solid #e2e8f0",fontWeight:600,fontSize:13},children:e.title}),l.jsx("div",{style:{padding:10,display:"grid",gap:8},children:e.children})]})}function AC({id:e,data:t}){const{deleteElements:n}=_n(),r=k.useCallback(i=>{i.stopPropagation(),i.preventDefault(),n({nodes:[{id:e}]})},[n,e]);return l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{className:"nodrag nopan",style:es,onPointerDown:i=>{i.stopPropagation(),i.preventDefault()},onMouseDown:i=>{i.stopPropagation(),i.preventDefault()},onClick:r,title:"Delete",children:""}),l.jsx(yt,{type:"target",position:ke.Left}),l.jsxs(ts,{title:"Fighter: Fighting Style",children:[l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Style"}),l.jsx("select",{value:t.styleId,onChange:i=>t.onChange({styleId:i.target.value}),style:Ai,children:NC.map(i=>l.jsx("option",{value:i.id,children:i.name},i.id))})]}),t.styleId&&l.jsxs("div",{style:{fontSize:12,color:"#64748b"},children:[l.jsx("strong",{children:t.styleId})," active"]})]}),l.jsx(yt,{type:"source",position:ke.Right})]})}const DC=({id:e,data:t})=>{const{deleteElements:n}=_n(),r=k.useCallback(s=>{s.stopPropagation(),s.preventDefault(),n({nodes:[{id:e}]})},[n,e]),i=Oi.find(s=>s.id===t.weaponId)??Oi[0];return l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{className:"nodrag nopan",style:es,onPointerDown:s=>{s.stopPropagation(),s.preventDefault()},onMouseDown:s=>{s.stopPropagation(),s.preventDefault()},onClick:r,title:"Delete",children:""}),l.jsx(yt,{type:"target",position:ke.Left}),l.jsxs(ts,{title:"Weapon",children:[l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Preset"}),l.jsx("select",{value:i.id,onChange:s=>t.onChange({weaponId:s.target.value}),style:Ai,children:Oi.map(s=>l.jsx("option",{value:s.id,children:s.name},s.id))})]}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:6,fontSize:12},children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Dice:"})," ",i.dice,i.versatile?` (${i.versatile} vers.)`:""]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Type:"})," ",i.type]}),l.jsx("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",gap:6},children:i.properties.map(s=>l.jsx("span",{style:Wy,children:s},s))})]})]}),l.jsx(yt,{type:"source",position:ke.Right})]})};function MC({id:e,data:t}){const{deleteElements:n}=_n(),r=k.useCallback(i=>{i.stopPropagation(),i.preventDefault(),n({nodes:[{id:e}]})},[n,e]);return l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{className:"nodrag nopan",style:es,onPointerDown:i=>{i.stopPropagation(),i.preventDefault()},onMouseDown:i=>{i.stopPropagation(),i.preventDefault()},onClick:r,title:"Delete",children:""}),l.jsx(yt,{type:"target",position:ke.Left}),l.jsxs(ts,{title:"Feats",children:[l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.gwm,onChange:i=>t.onChange({gwm:i.target.checked})})," Great Weapon Master"]}),l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.ss,onChange:i=>t.onChange({ss:i.target.checked})})," Sharpshooter"]}),l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.pam,onChange:i=>t.onChange({pam:i.target.checked})})," Polearm Master"]}),l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.cbe,onChange:i=>t.onChange({cbe:i.target.checked})})," Crossbow Expert"]})]}),l.jsx(yt,{type:"source",position:ke.Right})]})}function zC({id:e,data:t}){const{deleteElements:n}=_n(),r=k.useCallback(a=>{a.stopPropagation(),a.preventDefault(),n({nodes:[{id:e}]})},[n,e]),i=t.level??5,s=Math.ceil(i/2),o=i>=16?4:i>=9?3:(i>=3,2);return l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{className:"nodrag nopan",style:es,onPointerDown:a=>{a.stopPropagation(),a.preventDefault()},onMouseDown:a=>{a.stopPropagation(),a.preventDefault()},onClick:r,title:"Delete",children:""}),l.jsx(yt,{type:"target",position:ke.Left}),l.jsxs(ts,{title:"Class Features",children:[l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.sneak,onChange:a=>t.onChange({sneak:a.target.checked})})," Rogue Sneak Attack"]}),t.sneak&&l.jsxs("div",{style:$r,children:["Approx: ",s,"d6 once/turn on hit"]}),l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.rage,onChange:a=>t.onChange({rage:a.target.checked})})," Barbarian Rage"]}),t.rage&&l.jsxs("div",{style:$r,children:["+",o," melee damage per hit"]}),l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.smite,onChange:a=>t.onChange({smite:a.target.checked})})," Paladin Divine Smite"]}),t.smite&&l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[l.jsxs("label",{style:{fontSize:12,color:"#475569"},children:["Smite Dice (d8)",l.jsx("input",{type:"range",min:0,max:5,step:1,value:t.smiteDice??2,onChange:a=>t.onChange({smiteDice:Number(a.target.value)}),style:{width:"100%"}})]}),l.jsxs("label",{style:{fontSize:12,color:"#475569"},children:["Smites/Round",l.jsx("input",{type:"range",min:0,max:2,step:1,value:t.smitesPerRound??1,onChange:a=>t.onChange({smitesPerRound:Number(a.target.value)}),style:{width:"100%"}})]})]})]}),l.jsx(yt,{type:"source",position:ke.Right})]})}function RC({id:e,data:t}){const{deleteElements:n}=_n(),r=k.useCallback(i=>{i.stopPropagation(),i.preventDefault(),n({nodes:[{id:e}]})},[n,e]);return l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{className:"nodrag nopan",style:es,onPointerDown:i=>{i.stopPropagation(),i.preventDefault()},onMouseDown:i=>{i.stopPropagation(),i.preventDefault()},onClick:r,title:"Delete",children:""}),l.jsx(yt,{type:"target",position:ke.Left}),l.jsxs(ts,{title:"Buffs & Rider Damage",children:[l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.bless,onChange:i=>t.onChange({bless:i.target.checked})})," Bless ( +2.5 to hit)"]}),l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:!!t.d6onhit,onChange:i=>t.onChange({d6onhit:i.target.checked})})," Hex / Hunter's Mark (+1d6 on hit)"]})]}),l.jsx(yt,{type:"source",position:ke.Right})]})}function PC({id:e,data:t}){var s;const{deleteElements:n}=_n(),r=k.useCallback(o=>{o.stopPropagation(),o.preventDefault(),n({nodes:[{id:e}]})},[n,e]),{summary:i}=t;return l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{className:"nodrag nopan",style:es,onPointerDown:o=>{o.stopPropagation(),o.preventDefault()},onMouseDown:o=>{o.stopPropagation(),o.preventDefault()},onClick:r,title:"Delete",children:""}),l.jsx(yt,{type:"target",position:ke.Left}),l.jsx(ts,{title:"DPR Output",children:i?l.jsxs("div",{style:{fontSize:14,display:"grid",gap:4},children:[l.jsxs("div",{children:[l.jsx("span",{style:$r,children:"To-hit:"})," ",l.jsxs("strong",{children:["+",i.toHit]})]}),l.jsxs("div",{children:[l.jsx("span",{style:$r,children:"Mode:"})," ",l.jsx("strong",{children:i.advMode})]}),l.jsxs("div",{children:[l.jsxs("span",{style:$r,children:["Hit chance vs AC ",i.targetAC,":"]})," ",l.jsxs("strong",{children:[Math.round(i.pHit*100),"%"]})]}),l.jsxs("div",{children:[l.jsx("span",{style:$r,children:"Crit chance:"})," ",l.jsxs("strong",{children:[Math.round(i.pCrit*100),"%"]})]}),l.jsxs("div",{children:[l.jsx("span",{style:$r,children:"Attacks/round:"})," ",l.jsx("strong",{children:i.attacks})]}),l.jsx("div",{style:{borderTop:"1px solid #e2e8f0",margin:"8px 0"}}),l.jsxs("div",{style:{fontSize:18},children:["DPR: ",l.jsx("strong",{children:i.dpr.toFixed(2)})]}),(s=i.notes)!=null&&s.length?l.jsx("ul",{style:{marginTop:6,color:"#475569",paddingLeft:18},children:i.notes.map((o,a)=>l.jsx("li",{style:{fontSize:12},children:o},a))}):null]}):l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Connect a Fighting Style / Weapon / Feats / Features / Buffs to compute DPR."})}),l.jsx(yt,{type:"source",position:ke.Right})]})}const TC={fighterStyle:AC,weapon:DC,feats:MC,features:zC,buffs:RC,output:PC};function IC(e){var H,re,oe,ge,we,z,ie,le,he,Te;const[t,n]=k.useState(5),[r,i]=k.useState(16),[s,o]=k.useState(14),[a,c]=k.useState(16),[u,f]=k.useState("normal"),[h,g]=k.useState(!1),[m,S]=k.useState("none"),[w,N]=k.useState("none");V.useEffect(()=>{var Ae;const Q=(Ae=e.derived)==null?void 0:Ae.totalLevel;typeof Q=="number"&&Q>0&&n(Q)},[(H=e.derived)==null?void 0:H.totalLevel]),V.useEffect(()=>{var Q,Ae,ve,Se;(Ae=(Q=e.character)==null?void 0:Q.abilities)!=null&&Ae.str&&i(e.character.abilities.str),(Se=(ve=e.character)==null?void 0:ve.abilities)!=null&&Se.dex&&o(e.character.abilities.dex)},[(oe=(re=e.character)==null?void 0:re.abilities)==null?void 0:oe.str,(we=(ge=e.character)==null?void 0:ge.abilities)==null?void 0:we.dex]);const d=((z=e.derived)==null?void 0:z.totalLevel)??t,p=k.useMemo(()=>Lh(d),[d]),x=k.useMemo(()=>Oh(d),[d]),y=k.useMemo(()=>[{id:"style-1",type:"fighterStyle",position:{x:80,y:200},data:{styleId:"dueling"}},{id:"wpn-1",type:"weapon",position:{x:80,y:20},data:{weaponId:"longsword"}},{id:"feat-1",type:"feats",position:{x:80,y:380},data:{gwm:!1,ss:!1,pam:!1,cbe:!1}},{id:"feat-2",type:"features",position:{x:80,y:560},data:{}},{id:"buff-1",type:"buffs",position:{x:80,y:740},data:{bless:!1,d6onhit:!1}},{id:"out-1",type:"output",position:{x:620,y:240},data:{summary:null}}],[]),[C,A,D]=Py(y),[R,P,F]=Ty([{id:"e1",source:"wpn-1",target:"out-1"},{id:"e2",source:"style-1",target:"out-1"},{id:"e3",source:"feat-1",target:"out-1"},{id:"e4",source:"feat-2",target:"out-1"},{id:"e5",source:"buff-1",target:"out-1"}]),G=k.useRef({past:[],future:[],suppress:!1,lastTs:0}),J=k.useCallback(()=>{if(G.current.suppress)return;const Q=Date.now();if(Q-G.current.lastTs<50)return;G.current.lastTs=Q;const Ae=JSON.parse(JSON.stringify(C)),ve=JSON.parse(JSON.stringify(R));G.current.past.push({nodes:Ae,edges:ve}),G.current.future=[]},[C,R]),B=k.useCallback(()=>{const{past:Q,future:Ae}=G.current;if(Q.length===0)return;const ve={nodes:JSON.parse(JSON.stringify(C)),edges:JSON.parse(JSON.stringify(R))},Se=Q.pop();Ae.push(ve),G.current.suppress=!0,A(Se.nodes),P(Se.edges),G.current.suppress=!1},[C,R,A,P]),v=k.useCallback(()=>{const{past:Q,future:Ae}=G.current;if(Ae.length===0)return;const ve={nodes:JSON.parse(JSON.stringify(C)),edges:JSON.parse(JSON.stringify(R))},Se=Ae.pop();Q.push(ve),G.current.suppress=!0,A(Se.nodes),P(Se.edges),G.current.suppress=!1},[C,R,A,P]);V.useEffect(()=>{const Q=Ae=>{const ve=Ae.ctrlKey||Ae.metaKey,Se=Ae.key.toLowerCase();ve&&Se==="z"&&!Ae.shiftKey?(Ae.preventDefault(),B()):(ve&&Se==="y"||ve&&Se==="z"&&Ae.shiftKey)&&(Ae.preventDefault(),v())};return window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)},[B,v]);const j=k.useCallback(Q=>{J(),D(Q)},[J,D]),E=k.useCallback(Q=>{J(),F(Q)},[J,F]),L=k.useCallback((Q,Ae)=>{J(),A(ve=>ve.map(Se=>Se.id===Q?{...Se,data:{...Se.data,...Ae}}:Se))},[J,A]);V.useEffect(()=>{A(Q=>Q.some(ve=>{var Se;return!((Se=ve.data)!=null&&Se.onChange)})?Q.map(ve=>{var Se;return(Se=ve.data)!=null&&Se.onChange?ve:{...ve,data:{...ve.data,onChange:Ve=>L(ve.id,Ve)}}}):Q)},[L,A]);const _=k.useCallback(Q=>{J(),A(Ae=>Ae.filter(ve=>ve.id!==Q)),P(Ae=>Ae.filter(ve=>ve.source!==Q&&ve.target!==Q))},[A,P]);V.useEffect(()=>()=>{},[_]),V.useEffect(()=>{A(Q=>Q.some(ve=>{var Se;return!((Se=ve.data)!=null&&Se.onDelete)})?Q.map(ve=>{var Se;return(Se=ve.data)!=null&&Se.onDelete?ve:{...ve,data:{...ve.data,onDelete:_}}}):Q)},[_,A]);const b=k.useCallback(Q=>{J(),P(Ae=>Dd(Q,Ae))},[J,P]),M=k.useCallback(()=>{const Q=new Map(C.map(ve=>[ve.id,ve])),Ae=C.map(ve=>{var Ye,_e,Ge,rt,rn,hn;if(ve.type!=="output")return ve;const Se=R.filter(We=>We.target===ve.id),Ve=Se.map(We=>Q.get(We.source)).find(We=>(We==null?void 0:We.type)==="fighterStyle"),Qe=Se.map(We=>Q.get(We.source)).find(We=>(We==null?void 0:We.type)==="weapon"),me=Se.map(We=>Q.get(We.source)).find(We=>(We==null?void 0:We.type)==="feats"),st=Se.map(We=>Q.get(We.source)).find(We=>(We==null?void 0:We.type)==="features"),I=Se.map(We=>Q.get(We.source)).find(We=>(We==null?void 0:We.type)==="buffs");if(!Qe)return{...ve,data:{...ve.data,summary:null}};const Y=(Ye=Ve==null?void 0:Ve.data)==null?void 0:Ye.styleId,U=(me==null?void 0:me.data)||{},O={...(st==null?void 0:st.data)||{}},ee=(I==null?void 0:I.data)||{},q=Oi.find(We=>We.id===Qe.data.weaponId)??Oi[0],fe=((_e=e.derived)==null?void 0:_e.strMod)??Bh(r),Z=((Ge=e.derived)==null?void 0:Ge.dexMod)??Bh(s),ae=q.ranged===!0,de=ae||q.finesse;let Ue=p+(de?Z:fe);const te=[];Y==="archery"&&ae&&(Ue+=2,te.push("Archery: +2 to hit applied.")),Y==="defense"&&te.push("Defense: +1 AC (not factored into DPR)."),ee.bless&&(Ue+=2.5,te.push("Bless: +2.5 to hit EV."));const Ce=(rt=q.tags)==null?void 0:rt.includes("gwm"),Le=(rn=q.tags)==null?void 0:rn.includes("ss");U.gwm&&Ce&&!ae&&(Ue-=5,te.push("GWM: -5 to hit/+10 dmg.")),U.ss&&Le&&ae&&(Ue-=5,te.push("Sharpshooter: -5 to hit/+10 dmg."));const Oe=a,je=_C((21+Ue-Oe)/20,0,1),Ke=.05,Xe=Fh(je,u),nt=Fh(Ke,u),kt=h&&q.versatile?q.versatile:q.dice,T=Y==="great-weapon"&&q.handed==="2h"&&!ae,X=oc(kt,{greatWeaponFighting:T});T&&te.push("Great Weapon Fighting: reroll 1s & 2s estimated.");const pe=de?Z:fe;let ue=0,De=0;Y==="dueling"&&q.handed==="1h"&&!ae&&(ue+=2,te.push("Dueling: +2 damage with 1H melee.")),Y==="two-weapon"&&q.properties.includes("light")&&!ae&&(De+=1,te.push("Two-Weapon Fighting: includes offhand attack (adds mod).")),U.gwm&&Ce&&!ae&&(ue+=10),U.ss&&Le&&ae&&(ue+=10);let Re=0;if(U.pam&&((hn=q.tags)!=null&&hn.includes("pam"))&&!ae){const We=O.rage?d>=16?4:d>=9?3:2:0,pn=ee.d6onhit?gi.d6:0,ii=gi.d4+pe+We+pn,ns=gi.d4;Re=Math.max(Xe-nt,0)*ii+nt*(ii+ns),te.push("Polearm Master: bonus 1d4 attack added.")}U.cbe&&ae&&q.id.includes("crossbow")&&(De+=1,te.push("Crossbow Expert: bonus attack added."));const Pe=ee.d6onhit?gi.d6:0;ee.d6onhit&&te.push("Hex/Hunter's Mark: +1d6 on hit.");const Ie=O.rage?d>=16?4:d>=9?3:2:0;Ie&&!ae&&(ue+=Ie,te.push(`Rage: +${Ie} melee damage per hit.`));let et=0,Be=0;O.smite&&(et=O.smiteDice??2,Be=O.smitesPerRound??1);const $=O.sneak?Math.min(10,Math.ceil(d/2)):0,se=oc(kt,{greatWeaponFighting:T}),ye=X+pe+ue+Pe,K=(Xe-nt)*ye+nt*(ye+se);let ce=x;De&&(ce+=De);const xe=Math.max(Xe-nt,0),$e=1-Math.pow(1-xe,Math.max(1,x)),Me=$?$e*oc(`${$}d6`):0,He=gi.d8,ze=et&&Be?Be*(xe*(et*He)+nt*(et*2*He)):0;let Fe=K*ce+Me+ze+Re,Ee=1;return m!=="none"&&m===q.type&&(Ee*=.5,te.push(`Target resists ${q.type} damage.`)),w!=="none"&&w===q.type&&(Ee*=2,te.push(`Target vulnerable to ${q.type} damage.`)),Fe*=Ee,{...ve,data:{...ve.data,summary:{toHit:Math.round(Ue),advMode:u,targetAC:Oe,pHit:Xe,pCrit:nt,attacks:ce,dpr:Fe,notes:te}}}});G.current.suppress=!0,A(Ae),G.current.suppress=!1},[C,R,d,r,s,a,x,h,u,m,w,A,p,(ie=e.derived)==null?void 0:ie.strMod,(le=e.derived)==null?void 0:le.dexMod]);V.useEffect(()=>{M()},[C.length,JSON.stringify(R),d,r,s,a,h,u,m,w,M]);const W=Q=>{const Ae=`${Q}-${crypto.randomUUID().slice(0,6)}`,ve=40+Math.random()*760,Se={id:Ae,type:Q,position:{x:80,y:ve},data:{onChange:Ve=>L(Ae,Ve),onDelete:_}};Q==="weapon"&&(Se.data.weaponId=Oi[0].id),Q==="fighterStyle"&&(Se.data.styleId="dueling"),Q==="feats"&&Object.assign(Se.data,{gwm:!1,ss:!1,pam:!1,cbe:!1}),Q==="features"&&Object.assign(Se.data,{level:t}),Q==="buffs"&&Object.assign(Se.data,{bless:!1,d6onhit:!1}),Q==="output"&&(Se.data.summary=null),J(),A(Ve=>[...Ve,Se])};return l.jsxs("div",{className:"w-full",style:{display:"grid",gridTemplateColumns:"1fr 360px",gap:12,height:"calc(100vh - 100px)"},children:[l.jsx("div",{style:{height:"100%",border:"1px solid #e2e8f0",borderRadius:12,overflow:"hidden",background:"white"},children:l.jsxs(Pd,{nodes:C,edges:R,onNodesChange:j,onEdgesChange:E,onConnect:b,nodeTypes:TC,fitView:!0,children:[l.jsx(Hy,{}),l.jsx(Ly,{pannable:!0,zoomable:!0}),l.jsx(By,{showInteractive:!1})]})}),l.jsxs("div",{style:{display:"grid",gap:12},children:[l.jsxs("section",{style:Vo,children:[l.jsx("div",{style:{padding:12,borderBottom:"1px solid #e2e8f0",fontWeight:600},children:"History"}),l.jsxs("div",{style:{padding:12,display:"flex",gap:8},children:[l.jsx("button",{onClick:B,style:lr,children:" Undo"}),l.jsx("button",{onClick:v,style:lr,children:" Redo"})]})]}),l.jsxs("section",{style:Vo,children:[l.jsx("div",{style:{padding:12,borderBottom:"1px solid #e2e8f0",fontWeight:600},children:"Global Settings"}),l.jsxs("div",{style:{padding:12,display:"grid",gap:12},children:[l.jsx(sc,{label:`Level: ${d}`,min:1,max:20,value:t,onChange:Q=>n(Q)}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[l.jsx(sc,{label:`STR: ${r} ${((he=e.derived)==null?void 0:he.strMod)!==void 0?`(mod ${e.derived.strMod>=0?"+":""}${e.derived.strMod})`:""}`,min:8,max:20,value:r,onChange:Q=>i(Q)}),l.jsx(sc,{label:`DEX: ${s} ${((Te=e.derived)==null?void 0:Te.dexMod)!==void 0?`(mod ${e.derived.dexMod>=0?"+":""}${e.derived.dexMod})`:""}`,min:8,max:20,value:s,onChange:Q=>o(Q)})]}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:["Target AC",l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[l.jsx("input",{type:"number",value:a,onChange:Q=>c(parseInt(Q.target.value||"0",10)),style:Ai}),l.jsx("span",{style:Wy,children:"vs"})]})]}),l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:["Roll Mode",l.jsxs("select",{value:u,onChange:Q=>f(Q.target.value),style:Ai,children:[l.jsx("option",{value:"normal",children:"Normal"}),l.jsx("option",{value:"adv",children:"Advantage"}),l.jsx("option",{value:"dis",children:"Disadvantage"})]})]})]}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,alignItems:"end"},children:[l.jsxs("label",{style:Ln,children:[l.jsx("input",{type:"checkbox",checked:h,onChange:Q=>g(Q.target.checked)})," Use versatile die"]}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:["Resistance",l.jsxs("select",{value:m,onChange:Q=>S(Q.target.value),style:Ai,children:[l.jsx("option",{value:"none",children:"None"}),l.jsx("option",{value:"slashing",children:"Slashing"}),l.jsx("option",{value:"piercing",children:"Piercing"}),l.jsx("option",{value:"bludgeoning",children:"Bludgeoning"})]})]}),l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:["Vulnerability",l.jsxs("select",{value:w,onChange:Q=>N(Q.target.value),style:Ai,children:[l.jsx("option",{value:"none",children:"None"}),l.jsx("option",{value:"slashing",children:"Slashing"}),l.jsx("option",{value:"piercing",children:"Piercing"}),l.jsx("option",{value:"bludgeoning",children:"Bludgeoning"})]})]})]})]}),l.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Proficiency: ",l.jsxs("strong",{children:["+",Lh(d)]}),"  Base Attacks/Round (Fighter): ",l.jsx("strong",{children:Oh(d)})]})]})]}),l.jsxs("section",{style:Vo,children:[l.jsx("div",{style:{padding:12,borderBottom:"1px solid #e2e8f0",fontWeight:600},children:"Add Nodes"}),l.jsxs("div",{style:{padding:12,display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8},children:[l.jsx("button",{onClick:()=>W("weapon"),style:lr,children:"+ Weapon"}),l.jsx("button",{onClick:()=>W("fighterStyle"),style:lr,children:"+ Style"}),l.jsx("button",{onClick:()=>W("feats"),style:lr,children:"+ Feats"}),l.jsx("button",{onClick:()=>W("features"),style:lr,children:"+ Features"}),l.jsx("button",{onClick:()=>W("buffs"),style:lr,children:"+ Buffs"}),l.jsx("button",{onClick:()=>W("output"),style:lr,children:"+ Output"})]}),l.jsx("div",{style:{padding:"0 12px 12px",fontSize:12,color:"#64748b"},children:"Typical wiring: Weapon  Output; Style/Feats/Features/Buffs  Output. Create multiple outputs to compare builds."})]}),l.jsxs("section",{style:Vo,children:[l.jsx("div",{style:{padding:12,borderBottom:"1px solid #e2e8f0",fontWeight:600},children:"Notes"}),l.jsxs("ul",{style:{padding:12,margin:0,color:"#475569",fontSize:14},children:[l.jsx("li",{children:"Advantage/disadvantage transforms hit and crit probabilities."}),l.jsx("li",{children:"GWM/SS: -5 to hit, +10 damage when weapon qualifies."}),l.jsx("li",{children:"Polearm Master adds a bonus 1d4 attack if using a qualifying weapon."}),l.jsx("li",{children:"Rogue Sneak Attack modeled once/turn with probability of at least one primary hit."}),l.jsx("li",{children:"Divine Smite adds chosen d8s per smite on hit; crit doubles smite dice."}),l.jsx("li",{children:"Rage adds +2/+3/+4 melee damage scaling by level."}),l.jsx("li",{children:"Resist/Vulnerability multiplies final DPR by 0.5x/2x if it matches damage type."})]})]})]})]})}const _t={width:"100%",padding:"8px 10px",borderRadius:8,border:"1px solid #cbd5e1"},$s={padding:"2px 8px",borderRadius:999,border:"1px solid #e2e8f0",background:"#f8fafc",fontSize:12},Yo={border:"1px solid #e2e8f0",borderRadius:12,background:"white"},Ze={padding:"8px 10px",borderRadius:8,border:"1px solid #cbd5e1",background:"white",cursor:"pointer"},An={color:"#64748b",fontSize:12},Yn=["Barbarian","Bard","Cleric","Druid","Fighter","Monk","Paladin","Ranger","Rogue","Sorcerer","Warlock","Wizard"],Hh={Barbarian:3,Bard:3,Cleric:1,Druid:2,Fighter:3,Monk:3,Paladin:3,Ranger:3,Rogue:3,Sorcerer:1,Warlock:1,Wizard:2},Uy=["Human (Base)","Human (Variant)","Elf (Wood)","Elf (High)"],Vy=["Soldier","Acolyte","Sage","Outlander"];function Yy(e){return l.jsxs("div",{style:{minWidth:280,background:"#f3f4f6",border:"1px solid #e2e8f0",borderRadius:12},children:[l.jsx("div",{style:{padding:10,borderBottom:"1px solid #e2e8f0",fontWeight:600,fontSize:13},children:e.title}),l.jsx("div",{style:{padding:10,display:"grid",gap:8},children:e.children})]})}const Yl=["STR","DEX","CON","INT","WIS","CHA"],$C=["Acrobatics","Animal Handling","Arcana","Athletics","Deception","History","Insight","Intimidation","Investigation","Medicine","Nature","Perception","Performance","Persuasion","Religion","Sleight of Hand","Stealth","Survival"],LC=["Archery","Defense","Dueling","Great Weapon Fighting","Protection","Two-Weapon Fighting"],Es={class:"#fde68a",feat:"#86efac",asi:"#93c5fd",note:"#fca5a5"},Gy="application/x-scratch-block",Kr="application/x-scratch-token";function lc(e){return{display:"inline-flex",alignItems:"center",minWidth:72,padding:"4px 8px",borderRadius:8,border:`2px dashed ${e?"#0ea5e9":"#cbd5e1"}`,background:e?"#e0f2fe":"#f8fafc",color:"#0f172a",fontSize:12,gap:6}}function ac(e){return l.jsx("span",{style:{padding:"2px 6px",borderRadius:999,background:"#e2e8f0",fontSize:12},children:e})}function Go(e){return l.jsx("div",{draggable:!0,onDragStart:t=>t.dataTransfer.setData(Gy,JSON.stringify(e.draggableData)),style:{padding:"6px 10px",borderRadius:10,background:e.color,border:"1px solid #e2e8f0",cursor:"grab",userSelect:"none",fontSize:12},title:"Drag into the workspace",children:e.label})}function ms(e){return l.jsx("div",{draggable:!0,onDragStart:t=>t.dataTransfer.setData(Kr,JSON.stringify({type:e.type,value:e.value})),style:{padding:"4px 8px",borderRadius:999,background:"#f8fafc",border:"1px solid #e2e8f0",cursor:"grab",fontSize:12},title:`Drag to a matching ${e.type} hole`,children:e.label})}function OC(e){const[t,n]=k.useState(null),r={background:Es[e.blk.kind],border:"1px solid #e2e8f0",borderRadius:12,padding:10,display:"grid",gap:8},i=l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("strong",{style:{fontSize:12,textTransform:"uppercase",letterSpacing:.3},children:e.blk.kind}),l.jsx("span",{style:{fontSize:12,color:"#475569"},children:"Level"}),l.jsx("input",{type:"number",min:1,max:20,value:e.blk.level,onChange:s=>e.onChange({level:Math.max(1,Math.min(20,parseInt(s.target.value||"1",10)))}),style:{width:64,padding:"4px 6px",borderRadius:8,border:"1px solid #cbd5e1"}})]}),l.jsxs("div",{style:{display:"flex",gap:6},children:[l.jsx("button",{onClick:e.onMoveUp,style:{...Ze,padding:6},title:"Move up",children:""}),l.jsx("button",{onClick:e.onMoveDown,style:{...Ze,padding:6},title:"Move down",children:""}),l.jsx("button",{onClick:e.onRemove,style:{...Ze,padding:6},title:"Remove",children:""})]})]});return l.jsxs("div",{style:r,children:[i,e.blk.kind==="class"&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[l.jsx("span",{style:{fontSize:12,color:"#475569"},children:"Class:"}),l.jsx("span",{onDragOver:s=>{s.preventDefault(),n("class")},onDragLeave:()=>n(null),onDrop:s=>{n(null);const o=s.dataTransfer.getData(Kr);if(o)try{const a=JSON.parse(o);a.type==="class"&&Yn.includes(a.value)&&e.onChange({className:a.value})}catch{}},style:lc(t==="class"),children:e.blk.className?ac(e.blk.className):l.jsx("span",{style:{color:"#64748b"},children:"drop class here"})}),l.jsx("select",{value:e.blk.className||"Fighter",onChange:s=>e.onChange({className:s.target.value}),style:_t,children:Yn.slice().sort((s,o)=>s.localeCompare(o)).map(s=>l.jsx("option",{value:s,children:s},s))})]}),e.blk.kind==="feat"&&l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsx("span",{style:{fontSize:12,color:"#475569"},children:"Feat Name:"}),l.jsx("input",{value:e.blk.featName||"",onChange:s=>e.onChange({featName:s.target.value}),placeholder:"Great Weapon Master",style:_t})]}),e.blk.kind==="asi"&&l.jsx("div",{style:{display:"grid",gap:8},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[l.jsx("span",{style:{fontSize:12,color:"#475569"},children:"Ability +1:"}),l.jsx("span",{onDragOver:s=>{s.preventDefault(),n("a1")},onDragLeave:()=>n(null),onDrop:s=>{n(null);const o=s.dataTransfer.getData(Kr);if(o)try{const a=JSON.parse(o);a.type==="ability"&&Yl.includes(a.value)&&e.onChange({ability1:a.value})}catch{}},style:lc(t==="a1"),children:e.blk.ability1?ac(e.blk.ability1):l.jsx("span",{style:{color:"#64748b"},children:"drop ability"})}),l.jsx("span",{style:{fontSize:12,color:"#475569"},children:"Ability +1:"}),l.jsx("span",{onDragOver:s=>{s.preventDefault(),n("a2")},onDragLeave:()=>n(null),onDrop:s=>{n(null);const o=s.dataTransfer.getData(Kr);if(o)try{const a=JSON.parse(o);a.type==="ability"&&Yl.includes(a.value)&&e.onChange({ability2:a.value})}catch{}},style:lc(t==="a2"),children:e.blk.ability2?ac(e.blk.ability2):l.jsx("span",{style:{color:"#64748b"},children:"drop ability"})})]})}),e.blk.kind==="note"&&l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsx("span",{style:{fontSize:12,color:"#475569"},children:"Notes:"}),l.jsx("textarea",{value:e.blk.text||"",onChange:s=>e.onChange({text:s.target.value}),rows:2,style:{..._t,resize:"vertical"},placeholder:"Why this choice?"})]})]})}function BC({id:e,data:t}){const{deleteElements:n,getNode:r,getEdges:i,setNodes:s,setEdges:o,getNodes:a}=_n(),c=k.useCallback(d=>{d.stopPropagation(),d.preventDefault(),n({nodes:[{id:e}]})},[n,e]),[u,f]=V.useState(null),h=()=>{var d;return(d=t.onChange)==null?void 0:d.call(t,{collapsed:!t.collapsed})},g=k.useMemo(()=>{var p;const d=[];if(d.push(`L${t.level}`),t.type==="class"&&d.push(t.className||"Class"),t.type==="feat"&&(t.featName||t.feats&&t.feats.length)){const x=(((p=t.feats)==null?void 0:p.length)||0)+(t.featName?1:0);d.push(x>1?`${x} feats`:"Feat")}if(t.type==="asi"&&(t.ability1||t.ability2||t.asi)&&d.push(t.asi||Ls(t.ability1,t.ability2)||"ASI"),t.type==="bundle"){const x=t.featureChoices||[],y=new Set(x.map(A=>A.kind)),C=[];y.has("fighting-style")&&C.push("Fighting Style"),y.has("skill-proficiency")&&C.push("Skills"),y.has("other")&&C.push("Other"),d.push(C.length?`Choices: ${C.join(", ")}`:"Choices")}return t.type==="subclass"&&d.push(`Subclass${t.subclass?`: ${t.subclass}`:""}`),(t.notes||"").trim()&&d.push((t.notes||"").trim().slice(0,32)),d.join("  ")},[t.level,t.type,t.className,t.featName,t.asi,t.notes]),m=k.useMemo(()=>{const d=Number(t.level),p=[4,8,12,16,19].includes(d),x=t.className==="Fighter"&&(d===6||d===14),y=t.className==="Rogue"&&d===10;return p||x||y},[t.level,t.className]),S=k.useCallback(d=>{var A,D,R,P;if((d==null?void 0:d.targetHandle)!=="attach")return!0;const p=d!=null&&d.source?r(d.source):null,x=d!=null&&d.target?r(d.target):null,y=!!(p&&p.type==="progressStep"&&(((A=p.data)==null?void 0:A.type)==="asi"||((D=p.data)==null?void 0:D.type)==="bundle"||((R=p.data)==null?void 0:R.type)==="subclass")),C=!!(x&&x.type==="progressStep"&&((P=x.data)==null?void 0:P.type)==="class");return y&&C},[r]),w=k.useMemo(()=>{var p,x,y,C;const d=Array.isArray(t==null?void 0:t.featureChoices)?t.featureChoices.length:0;if((t==null?void 0:t.type)!=="class")return d;try{const A=((i==null?void 0:i())||[]).filter(R=>R.target===e&&(R==null?void 0:R.targetHandle)==="attach");let D=0;for(const R of A){const P=r==null?void 0:r(R.source);!P||P.type!=="progressStep"||(((p=P.data)==null?void 0:p.type)==="bundle"&&Array.isArray((x=P.data)==null?void 0:x.featureChoices)?D+=P.data.featureChoices.length:(((y=P.data)==null?void 0:y.type)==="asi"||((C=P.data)==null?void 0:C.type)==="subclass")&&(D+=1))}return d+D}catch{return d}},[t,i,r,e]),N=t!=null&&t._active?"0 0 0 2px rgba(14,165,233,0.35), 0 6px 20px rgba(14,165,233,0.25)":"0 1px 2px rgba(0,0,0,0.06)";return l.jsxs("div",{style:{position:"relative",boxShadow:N},children:[l.jsxs("details",{className:"nodrag nopan",style:{position:"absolute",top:4,right:4,zIndex:10},children:[l.jsx("summary",{role:"button",style:{listStyle:"none",width:24,height:24,borderRadius:999,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",color:"#0f172a",lineHeight:"22px",textAlign:"center",boxShadow:"0 1px 2px rgba(0,0,0,0.06)"},onPointerDown:d=>{d.stopPropagation()},onMouseDown:d=>{d.stopPropagation()},onClick:d=>{d.stopPropagation()},title:"Node actions",children:""}),l.jsxs("div",{style:{position:"absolute",right:0,top:28,display:"grid",gap:6,background:"white",border:"1px solid #e2e8f0",borderRadius:8,padding:8,boxShadow:"0 8px 24px rgba(0,0,0,0.12)"},onClick:d=>d.stopPropagation(),children:[l.jsx("button",{className:"nodrag nopan",style:Ze,onClick:d=>{d.preventDefault(),c(d);const p=d.currentTarget.closest("details");p&&p.removeAttribute("open")},children:"Delete"}),l.jsx("button",{className:"nodrag nopan",style:Ze,onClick:d=>{d.preventDefault(),h();const p=d.currentTarget.closest("details");p&&p.removeAttribute("open")},children:t.collapsed?"Show":"Hide"}),t.onApply?l.jsx("button",{className:"nodrag nopan",style:Ze,onClick:d=>{var x;d.preventDefault(),(x=t.onApply)==null||x.call(t);const p=d.currentTarget.closest("details");p&&p.removeAttribute("open")},children:"Apply to Builder"}):null,t.onCloneFromSelf?l.jsx("button",{className:"nodrag nopan",style:Ze,onClick:d=>{var x;d.preventDefault(),(x=t.onCloneFromSelf)==null||x.call(t);const p=d.currentTarget.closest("details");p&&p.removeAttribute("open")},children:"Duplicate Branch"}):null]})]}),l.jsx(yt,{type:"target",position:ke.Left}),(t==null?void 0:t.type)==="bundle"||(t==null?void 0:t.type)==="asi"||(t==null?void 0:t.type)==="subclass"?l.jsx(yt,{type:"source",id:"top",position:ke.Top,style:{background:"#0ea5e9",width:10,height:10,border:"2px solid #fff"}}):null,(t==null?void 0:t.type)==="class"?l.jsx(yt,{type:"target",id:"attach",position:ke.Bottom,isValidConnection:S,style:{background:"#0ea5e9",width:10,height:10,border:"2px solid #fff"}}):null,(t==null?void 0:t.type)==="class"?l.jsx("button",{className:"nodrag nopan",onClick:d=>{var p,x,y,C;d.preventDefault(),d.stopPropagation();try{const A=`step-${crypto.randomUUID().slice(0,6)}`,D=((x=(p=r==null?void 0:r(e))==null?void 0:p.position)==null?void 0:x.y)??0,R=((C=(y=r==null?void 0:r(e))==null?void 0:y.position)==null?void 0:C.x)??0,P=t.className?Hh[t.className]:void 0,F=!!(t.className&&P&&Number(t.level)===P),G=!F&&!!m,J={id:A,type:"progressStep",position:{x:R,y:D+100},data:G?{level:t.level,type:"asi",ability1:null,ability2:null,asi:"",collapsed:!1}:F?{level:t.level,type:"subclass",subclass:"",collapsed:!1}:{level:t.level,type:"bundle",featureChoices:[],collapsed:!1}},B={id:`e-${crypto.randomUUID().slice(0,6)}`,source:A,sourceHandle:"top",target:e,targetHandle:"attach"},v=(a==null?void 0:a())||[];s==null||s([...v,J]);const j=(i==null?void 0:i())||[];o==null||o([...j,B])}catch{}},title:t.className&&Hh[t.className]===Number(t.level)?"Attach Subclass":m?"Attach ASI":"Attach Feature Choices",style:{position:"absolute",bottom:-10,left:"50%",transform:"translateX(8px)",width:20,height:20,borderRadius:999,border:"1px solid #e2e8f0",background:"#fff",color:"#0f172a",cursor:"pointer",boxShadow:"0 1px 2px rgba(0,0,0,0.06)"},children:"+"}):null,(t==null?void 0:t.type)==="class"&&w>0?l.jsx("div",{className:"nodrag nopan",style:{position:"absolute",bottom:-4,left:"50%",transform:"translateX(10px)",background:"#0ea5e9",color:"#fff",fontSize:10,lineHeight:"14px",height:16,minWidth:16,padding:"0 4px",borderRadius:999,border:"2px solid #fff",textAlign:"center",boxShadow:"0 1px 2px rgba(0,0,0,0.08)"},title:"Attached feature choices",children:w}):null,l.jsxs(Yy,{title:`Step  ${g}`,children:[l.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[l.jsxs("span",{style:{...$s},children:["Type: ",t.type]}),l.jsxs("span",{style:{...$s},children:["Level: ",t.level]})]})}),!t.collapsed&&l.jsxs(l.Fragment,{children:[l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Character Level"}),l.jsx("input",{type:"number",min:1,max:20,value:t.level,onChange:d=>{var p;return(p=t.onChange)==null?void 0:p.call(t,{level:Math.max(1,Math.min(20,parseInt(d.target.value||"1",10)))})},style:_t})]}),l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Step Type"}),l.jsxs("select",{value:t.type,onChange:d=>{var p;return(p=t.onChange)==null?void 0:p.call(t,{type:d.target.value})},style:_t,children:[l.jsx("option",{value:"class",children:"Class Level"}),l.jsx("option",{value:"feat",children:"Feat"}),l.jsx("option",{value:"asi",children:"ASI"}),l.jsx("option",{value:"bundle",children:"Feature Choices"}),l.jsx("option",{value:"note",children:"Note"})]})]}),t.type==="class"&&l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Class"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[l.jsx("span",{onDragOver:d=>{d.preventDefault(),f("class")},onDragLeave:()=>f(null),onDrop:d=>{var x;f(null);const p=d.dataTransfer.getData("application/x-scratch-token");if(p)try{const y=JSON.parse(p);y.type==="class"&&Yn.includes(y.value)&&((x=t.onChange)==null||x.call(t,{className:y.value}))}catch{}},style:{display:"inline-flex",alignItems:"center",minWidth:72,padding:"4px 8px",borderRadius:8,border:`2px dashed ${u==="class"?"#0ea5e9":"#cbd5e1"}`,background:u==="class"?"#e0f2fe":"#f8fafc",color:"#0f172a",fontSize:12,gap:6},children:t.className?l.jsx("span",{style:{padding:"2px 6px",borderRadius:999,background:"#e2e8f0",fontSize:12},children:t.className}):l.jsx("span",{style:{color:"#64748b"},children:"drop class here"})}),l.jsx("select",{value:t.className||"Fighter",onChange:d=>{var p;return(p=t.onChange)==null?void 0:p.call(t,{className:d.target.value})},style:_t,children:Yn.slice().sort((d,p)=>d.localeCompare(p)).map(d=>l.jsx("option",{value:d,children:d},d))})]})]}),!1,t.type==="feat"&&l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Feats (this level)"}),l.jsx("input",{value:t.featName||"",onChange:d=>{var p;return(p=t.onChange)==null?void 0:p.call(t,{featName:d.target.value})},placeholder:"Great Weapon Master",style:_t}),l.jsxs("div",{style:{display:"grid",gap:6},children:[(t.feats||[]).map((d,p)=>l.jsxs("div",{style:{display:"flex",gap:6},children:[l.jsx("input",{value:d,onChange:x=>{var C;const y=[...t.feats||[]];y[p]=x.target.value,(C=t.onChange)==null||C.call(t,{feats:y})},style:_t}),l.jsx("button",{onClick:()=>{var x;return(x=t.onChange)==null?void 0:x.call(t,{feats:(t.feats||[]).filter((y,C)=>C!==p)})},style:Ze,title:"Remove",children:""})]},`${p}-${d}`)),l.jsx("button",{onClick:()=>{var d;return(d=t.onChange)==null?void 0:d.call(t,{feats:[...t.feats||[],""]})},style:Ze,children:"+ Add Feat"})]})]}),t.type==="asi"&&l.jsxs("div",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"ASI (+1/+1 or +2):"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[l.jsx("span",{onDragOver:d=>{d.preventDefault(),f("a1")},onDragLeave:()=>f(null),onDrop:d=>{var x;f(null);const p=d.dataTransfer.getData("application/x-scratch-token");if(p)try{const y=JSON.parse(p);y.type==="ability"&&((x=t.onChange)==null||x.call(t,{ability1:y.value,asi:Ls(y.value,t.ability2)}))}catch{}},style:{display:"inline-flex",alignItems:"center",minWidth:72,padding:"4px 8px",borderRadius:8,border:`2px dashed ${u==="a1"?"#0ea5e9":"#cbd5e1"}`,background:u==="a1"?"#e0f2fe":"#f8fafc",color:"#0f172a",fontSize:12,gap:6},children:t.ability1?l.jsx("span",{style:{padding:"2px 6px",borderRadius:999,background:"#e2e8f0",fontSize:12},children:t.ability1}):l.jsx("span",{style:{color:"#64748b"},children:"drop ability"})}),l.jsx("span",{onDragOver:d=>{d.preventDefault(),f("a2")},onDragLeave:()=>f(null),onDrop:d=>{var x;f(null);const p=d.dataTransfer.getData("application/x-scratch-token");if(p)try{const y=JSON.parse(p);y.type==="ability"&&Yl.includes(y.value)&&((x=t.onChange)==null||x.call(t,{ability2:y.value,asi:Ls(t.ability1,y.value)}))}catch{}},style:{display:"inline-flex",alignItems:"center",minWidth:72,padding:"4px 8px",borderRadius:8,border:`2px dashed ${u==="a2"?"#0ea5e9":"#cbd5e1"}`,background:u==="a2"?"#e0f2fe":"#f8fafc",color:"#0f172a",fontSize:12,gap:6},children:t.ability2?l.jsx("span",{style:{padding:"2px 6px",borderRadius:999,background:"#e2e8f0",fontSize:12},children:t.ability2}):l.jsx("span",{style:{color:"#64748b"},children:"drop ability"})}),l.jsx("input",{value:t.asi||"",onChange:d=>{var p;return(p=t.onChange)==null?void 0:p.call(t,{asi:d.target.value})},placeholder:"+2 STR or +1 STR / +1 CON",style:_t})]})]}),t.type==="bundle"&&l.jsxs("div",{style:{display:"grid",gap:10,fontSize:12,color:"#475569"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsx("span",{children:"Feature Choices"}),l.jsx("button",{style:Ze,onClick:()=>{var p;const d={id:`ch-${crypto.randomUUID().slice(0,6)}`,kind:"fighting-style",style:void 0};(p=t.onChange)==null||p.call(t,{featureChoices:[...t.featureChoices||[],d]})},children:"+ Add Choice"})]}),l.jsx("div",{style:{display:"grid",gap:8},children:(t.featureChoices||[]).map((d,p)=>l.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:8,padding:8,background:"#f8fafc",display:"grid",gap:8},children:[l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[l.jsx("span",{children:"Kind"}),l.jsxs("select",{value:d.kind,onChange:x=>{var D;const y=x.target.value,C=y==="fighting-style"?{id:d.id,kind:y,style:void 0}:y==="skill-proficiency"?{id:d.id,kind:y,skills:[],count:2}:{id:d.id,kind:y,text:""},A=[...t.featureChoices||[]];A[p]=C,(D=t.onChange)==null||D.call(t,{featureChoices:A})},style:_t,children:[l.jsx("option",{value:"fighting-style",children:"Fighting Style"}),l.jsx("option",{value:"skill-proficiency",children:"Skill Proficiencies"}),l.jsx("option",{value:"other",children:"Other"})]})]}),l.jsx("button",{style:Ze,title:"Remove",onClick:()=>{var x;return(x=t.onChange)==null?void 0:x.call(t,{featureChoices:(t.featureChoices||[]).filter(y=>y.id!==d.id)})},children:""})]}),d.kind==="fighting-style"&&l.jsxs("label",{style:{display:"grid",gap:6},children:[l.jsx("span",{children:"Fighting Style"}),l.jsxs("select",{value:d.style||"",onChange:x=>{var C;const y=[...t.featureChoices||[]];y[p]={...d,style:x.target.value},(C=t.onChange)==null||C.call(t,{featureChoices:y})},style:_t,children:[l.jsx("option",{value:"",children:"Select"}),LC.map(x=>l.jsx("option",{value:x,children:x},x))]})]}),d.kind==="skill-proficiency"&&l.jsxs("div",{style:{display:"grid",gap:6},children:[l.jsxs("label",{style:{display:"grid",gap:6},children:[l.jsx("span",{children:"Choose up to"}),l.jsx("input",{type:"number",min:1,max:6,value:d.count??2,onChange:x=>{var D;const y=Math.max(1,Math.min(6,parseInt(x.target.value||"1",10))),C=[...t.featureChoices||[]],A={...d};A.count=y,Array.isArray(A.skills)&&A.skills.length>y&&(A.skills=A.skills.slice(0,y)),C[p]=A,(D=t.onChange)==null||D.call(t,{featureChoices:C})},style:{..._t,width:80}})]}),l.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:$C.map(x=>{const y=Array.isArray(d.skills)?d.skills:[],C=d.count??2,A=y.includes(x),D=!A&&y.length>=C;return l.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,border:"1px solid #cbd5e1",padding:"4px 8px",borderRadius:8,background:D?"#f1f5f9":"#fff",color:D?"#94a3b8":"#0f172a"},children:[l.jsx("input",{type:"checkbox",checked:A,disabled:D,onChange:R=>{var J;const P=[...t.featureChoices||[]],F={...d},G=Array.isArray(F.skills)?F.skills.slice():[];if(R.target.checked)!G.includes(x)&&G.length<C&&G.push(x);else{const B=G.indexOf(x);B>=0&&G.splice(B,1)}F.skills=G,P[p]=F,(J=t.onChange)==null||J.call(t,{featureChoices:P})}}),l.jsx("span",{style:{fontSize:12},children:x})]},x)})})]}),d.kind==="other"&&l.jsxs("label",{style:{display:"grid",gap:6},children:[l.jsx("span",{children:"Details"}),l.jsx("input",{value:d.text||"",onChange:x=>{var C;const y=[...t.featureChoices||[]];y[p]={...d,text:x.target.value},(C=t.onChange)==null||C.call(t,{featureChoices:y})},placeholder:"Describe the choice",style:_t})]})]},d.id))})]}),t.type==="subclass"&&l.jsxs("div",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Subclass"}),l.jsx("input",{value:t.subclass||"",onChange:d=>{var p;return(p=t.onChange)==null?void 0:p.call(t,{subclass:d.target.value})},placeholder:"Champion / Battle Master / Arcane Trickster ",style:_t})]})]})]}),(t.onApply||t.onChange,null),t.onAddChild?l.jsx("div",{style:{position:"absolute",right:-10,top:"50%",transform:"translateY(-50%)",zIndex:9},children:l.jsxs("details",{className:"nodrag nopan",style:{position:"relative"},children:[l.jsx("summary",{role:"button",style:{listStyle:"none",width:24,height:24,borderRadius:999,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",color:"#0f172a",lineHeight:"22px",textAlign:"center",boxShadow:"0 1px 2px rgba(0,0,0,0.06)"},onPointerDown:d=>{d.stopPropagation()},onMouseDown:d=>{d.stopPropagation()},onClick:d=>{d.stopPropagation()},title:"Add and connect a new step",children:"+"}),l.jsx("div",{style:{position:"absolute",left:28,top:"50%",transform:"translateY(-50%)",display:"flex",gap:8,background:"white",border:"1px solid #e2e8f0",borderRadius:999,padding:"4px 8px",boxShadow:"0 6px 20px rgba(0,0,0,0.08)"},onClick:d=>d.stopPropagation(),children:["class","feat","asi","bundle","subclass","note"].map(d=>l.jsx("button",{className:"nodrag nopan",style:{...Ze,padding:"4px 8px"},onClick:p=>{var y;p.preventDefault(),p.stopPropagation(),(y=t.onAddChild)==null||y.call(t,d);const x=p.currentTarget.closest("details");x&&x.hasAttribute("open")&&x.removeAttribute("open")},onPointerDown:p=>{p.stopPropagation()},onMouseDown:p=>{p.stopPropagation()},children:d},d))})]})}):null,l.jsx(yt,{type:"source",position:ke.Right})]})}function Ls(e,t){return e&&t?`+1 ${e} / +1 ${t}`:e&&!t?`+2 ${e}`:!e&&t?`+2 ${t}`:""}function FC({id:e,data:t}){const{deleteElements:n}=_n(),r=k.useCallback(c=>{c.stopPropagation(),c.preventDefault(),n({nodes:[{id:e}]})},[n,e]),i=()=>{var c;return(c=t.onChange)==null?void 0:c.call(t,{collapsed:!t.collapsed})},[s,o]=k.useState(null),a=t!=null&&t._active?"0 0 0 2px rgba(14,165,233,0.35), 0 6px 20px rgba(14,165,233,0.25)":"0 1px 2px rgba(0,0,0,0.06)";return l.jsxs("div",{style:{position:"relative",boxShadow:a},children:[l.jsxs("details",{className:"nodrag nopan",style:{position:"absolute",top:4,right:4,zIndex:10},children:[l.jsx("summary",{role:"button",style:{listStyle:"none",width:24,height:24,borderRadius:999,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",color:"#0f172a",lineHeight:"22px",textAlign:"center",boxShadow:"0 1px 2px rgba(0,0,0,0.06)"},onPointerDown:c=>{c.stopPropagation()},onMouseDown:c=>{c.stopPropagation()},onClick:c=>{c.stopPropagation()},title:"Node actions",children:""}),l.jsxs("div",{style:{position:"absolute",right:0,top:28,display:"grid",gap:6,background:"white",border:"1px solid #e2e8f0",borderRadius:8,padding:8,boxShadow:"0 8px 24px rgba(0,0,0,0.12)"},onClick:c=>c.stopPropagation(),children:[l.jsx("button",{className:"nodrag nopan",style:Ze,onClick:c=>{c.preventDefault(),r(c);const u=c.currentTarget.closest("details");u&&u.removeAttribute("open")},children:"Delete"}),l.jsx("button",{className:"nodrag nopan",style:Ze,onClick:c=>{c.preventDefault(),i();const u=c.currentTarget.closest("details");u&&u.removeAttribute("open")},children:t.collapsed?"Show":"Hide"}),t.onClone?l.jsx("button",{className:"nodrag nopan",style:Ze,onClick:c=>{var f;c.preventDefault(),(f=t.onClone)==null||f.call(t);const u=c.currentTarget.closest("details");u&&u.removeAttribute("open")},children:"Duplicate Branch"}):null,t.onApply?l.jsx("button",{className:"nodrag nopan",style:Ze,onClick:c=>{var f;c.preventDefault(),(f=t.onApply)==null||f.call(t);const u=c.currentTarget.closest("details");u&&u.removeAttribute("open")},children:"Apply to Builder"}):null]})]}),l.jsxs(Yy,{title:"Character Start",children:[l.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[t.race?l.jsx("span",{style:$s,children:t.race}):null,t.background?l.jsx("span",{style:$s,children:t.background}):null,t.other?l.jsx("span",{style:$s,children:t.other}):null]})}),!t.collapsed&&l.jsxs(l.Fragment,{children:[l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Race"}),l.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:l.jsx("span",{onDragOver:c=>{c.preventDefault(),o("race")},onDragLeave:()=>o(null),onDrop:c=>{var f;o(null);const u=c.dataTransfer.getData(Kr);if(u)try{const h=JSON.parse(u);h.type==="race"&&Uy.includes(h.value)&&((f=t.onChange)==null||f.call(t,{race:h.value}))}catch{}},style:{display:"inline-flex",alignItems:"center",minWidth:120,padding:"6px 10px",borderRadius:8,border:`2px dashed ${s==="race"?"#0ea5e9":"#cbd5e1"}`,background:s==="race"?"#e0f2fe":"#f8fafc",color:"#0f172a",fontSize:12,gap:6},children:t.race?l.jsx("span",{style:{padding:"2px 6px",borderRadius:999,background:"#e2e8f0",fontSize:12},children:t.race}):l.jsx("span",{style:{color:"#64748b"},children:"drop race here"})})})]}),l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Background"}),l.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:l.jsx("span",{onDragOver:c=>{c.preventDefault(),o("background")},onDragLeave:()=>o(null),onDrop:c=>{var f;o(null);const u=c.dataTransfer.getData(Kr);if(u)try{const h=JSON.parse(u);h.type==="background"&&Vy.includes(h.value)&&((f=t.onChange)==null||f.call(t,{background:h.value}))}catch{}},style:{display:"inline-flex",alignItems:"center",minWidth:120,padding:"6px 10px",borderRadius:8,border:`2px dashed ${s==="background"?"#0ea5e9":"#cbd5e1"}`,background:s==="background"?"#e0f2fe":"#f8fafc",color:"#0f172a",fontSize:12,gap:6},children:t.background?l.jsx("span",{style:{padding:"2px 6px",borderRadius:999,background:"#e2e8f0",fontSize:12},children:t.background}):l.jsx("span",{style:{color:"#64748b"},children:"drop background here"})})})]}),l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Other Option"}),l.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:l.jsx("span",{onDragOver:c=>{c.preventDefault(),o("other")},onDragLeave:()=>o(null),onDrop:c=>{var f;o(null);const u=c.dataTransfer.getData(Kr);if(u)try{const h=JSON.parse(u);h&&(h.type==="text"||h.type==="other")&&typeof h.value=="string"&&((f=t.onChange)==null||f.call(t,{other:h.value}))}catch{}},style:{display:"inline-flex",alignItems:"center",minWidth:120,padding:"6px 10px",borderRadius:8,border:`2px dashed ${s==="other"?"#0ea5e9":"#cbd5e1"}`,background:s==="other"?"#e0f2fe":"#f8fafc",color:"#0f172a",fontSize:12,gap:6},children:t.other?l.jsx("span",{style:{padding:"2px 6px",borderRadius:999,background:"#e2e8f0",fontSize:12},children:t.other}):l.jsx("span",{style:{color:"#64748b"},children:"drop text here"})})})]})]})]}),t.onAddChild?l.jsx("div",{style:{position:"absolute",right:-10,top:"50%",transform:"translateY(-50%)",zIndex:9},children:l.jsxs("details",{className:"nodrag nopan",style:{position:"relative"},children:[l.jsx("summary",{role:"button",style:{listStyle:"none",width:24,height:24,borderRadius:999,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",color:"#0f172a",lineHeight:"22px",textAlign:"center",boxShadow:"0 1px 2px rgba(0,0,0,0.06)"},onPointerDown:c=>{c.stopPropagation()},onMouseDown:c=>{c.stopPropagation()},onClick:c=>{c.stopPropagation()},title:"Add and connect a new step",children:"+"}),l.jsx("div",{style:{position:"absolute",left:28,top:"50%",transform:"translateY(-50%)",display:"flex",gap:8,background:"white",border:"1px solid #e2e8f0",borderRadius:999,padding:"4px 8px",boxShadow:"0 6px 20px rgba(0,0,0,0.08)"},onClick:c=>c.stopPropagation(),children:["class","feat","asi","bundle","note"].map(c=>l.jsx("button",{className:"nodrag nopan",style:{...Ze,padding:"4px 8px"},onClick:u=>{var h;u.preventDefault(),u.stopPropagation(),(h=t.onAddChild)==null||h.call(t,c);const f=u.currentTarget.closest("details");f&&f.hasAttribute("open")&&f.removeAttribute("open")},onPointerDown:u=>{u.stopPropagation()},onMouseDown:u=>{u.stopPropagation()},children:c},c))})]})}):null,l.jsx(yt,{type:"source",position:ke.Right})]})}const HC={root:FC,progressStep:BC};function Ir(e,t,n){var h,g,m,S,w,N,d,p,x,y,C,A,D,R,P,F,G,J;const r=new Map(e.map(B=>[B.id,B])),i=[];let s=n,o=0;for(;s&&o<256;){o+=1;const B=t.filter(E=>E.source===s);if(!B.length)break;const v=(g=(h=B.map(E=>({e:E,n:r.get(E.target)})).filter(E=>!!E.n).sort((E,L)=>{var _,b;return(((_=E.n.position)==null?void 0:_.y)||0)-(((b=L.n.position)==null?void 0:b.y)||0)})[0])==null?void 0:h.n)==null?void 0:g.id;if(!v)break;const j=r.get(v);if(!j)break;j.type==="progressStep"&&i.push(j),s=v}if(!i.length){const B=new Set,v=[n];for(;v.length;){const j=v.pop();B.has(j)||(B.add(j),t.filter(E=>E.source===j).forEach(E=>v.push(E.target)))}i.push(...e.filter(j=>j.type==="progressStep"&&B.has(j.id))),i.sort((j,E)=>{var L,_,b,M;return(((L=j.data)==null?void 0:L.level)||0)-(((_=E.data)==null?void 0:_.level)||0)||(((b=j.position)==null?void 0:b.y)||0)-(((M=E.position)==null?void 0:M.y)||0)})}const a=r.get(n),c=new Map;for(const B of i){const v=Number(((m=B.data)==null?void 0:m.level)||0);if(!v)continue;const j=c.get(v)||{level:v,feats:[],featureChoices:[]};(S=B.data)!=null&&S.className&&(j.className=B.data.className);const E=[...Array.isArray((w=B.data)==null?void 0:w.feats)?B.data.feats.filter(L=>!!L):[],...(N=B.data)!=null&&N.featName?[B.data.featName]:[]];if(E.length&&(j.feats=[...j.feats,...E]),(d=B.data)!=null&&d.asi&&(j.asi=B.data.asi),(p=B.data)!=null&&p.ability1&&(j.ability1=B.data.ability1),(x=B.data)!=null&&x.ability2&&(j.ability2=B.data.ability2),Array.isArray((y=B.data)==null?void 0:y.featureChoices)&&B.data.featureChoices.length&&(j.featureChoices=[...j.featureChoices||[],...B.data.featureChoices]),((C=B.data)==null?void 0:C.type)==="class"){const L=t.filter(_=>_.target===B.id&&(_==null?void 0:_.targetHandle)==="attach");for(const _ of L){const b=r.get(_.source);if(!(!b||b.type!=="progressStep"))if(((A=b.data)==null?void 0:A.type)==="bundle"&&Array.isArray((D=b.data)==null?void 0:D.featureChoices))j.featureChoices=[...j.featureChoices||[],...b.data.featureChoices];else if(((R=b.data)==null?void 0:R.type)==="asi"){const M=b.data.asi||Ls(b.data.ability1,b.data.ability2);!j.asi&&M&&(j.asi=M),!j.ability1&&b.data.ability1&&(j.ability1=b.data.ability1),!j.ability2&&b.data.ability2&&(j.ability2=b.data.ability2)}else((P=b.data)==null?void 0:P.type)==="subclass"&&(j.subclass||(j.subclass=b.data.subclass||""))}if(Array.isArray(j.featureChoices)){const _=new Set;j.featureChoices=j.featureChoices.filter(b=>{const M=b&&typeof b=="object"&&b.id?String(b.id):JSON.stringify(b);return _.has(M)?!1:(_.add(M),!0)})}}typeof((F=B.data)==null?void 0:F.notes)=="string"&&B.data.notes&&!j.notes&&(j.notes=B.data.notes),c.set(v,j)}const u=Array.from(c.values()).sort((B,v)=>B.level-v.level);return{race:(G=a==null?void 0:a.data)==null?void 0:G.race,background:(J=a==null?void 0:a.data)==null?void 0:J.background,levels:u}}function Ko(e,t,n){var g,m,S,w,N,d,p,x,y,C,A,D,R,P,F,G,J,B,v,j;const r=new Map(e.map(E=>[E.id,E]));let i=n,s=0,o;for(;i&&s<256;){s+=1;const E=t.filter(b=>b.target===i);if(!E.length)break;const L=(m=(g=E.map(b=>({e:b,n:r.get(b.source)})).filter(b=>!!b.n).sort((b,M)=>{var W,H;return(((W=b.n.position)==null?void 0:W.y)||0)-(((H=M.n.position)==null?void 0:H.y)||0)})[0])==null?void 0:g.n)==null?void 0:m.id;if(!L)break;const _=r.get(L);if(!_)break;if(_.type==="root"){o=_.id;break}i=_.id}const a=o?r.get(o):void 0,c=[];for(i=n,s=0;i&&s<256;){s+=1;const E=r.get(i);E&&E.type==="progressStep"&&c.push(E);const L=t.filter(b=>b.source===i);if(!L.length)break;const _=(w=(S=L.map(b=>({e:b,n:r.get(b.target)})).filter(b=>!!b.n).sort((b,M)=>{var W,H;return(((W=b.n.position)==null?void 0:W.y)||0)-(((H=M.n.position)==null?void 0:H.y)||0)})[0])==null?void 0:S.n)==null?void 0:w.id;if(!_)break;i=_}const u=new Map;for(const E of c){const L=Number(((N=E.data)==null?void 0:N.level)||0);if(!L)continue;const _=u.get(L)||{level:L,feats:[],featureChoices:[]};(d=E.data)!=null&&d.className&&(_.className=E.data.className);const b=[...Array.isArray((p=E.data)==null?void 0:p.feats)?E.data.feats.filter(M=>!!M):[],...(x=E.data)!=null&&x.featName?[E.data.featName]:[]];if(b.length&&(_.feats=[..._.feats,...b]),(y=E.data)!=null&&y.asi&&(_.asi=E.data.asi),(C=E.data)!=null&&C.ability1&&(_.ability1=E.data.ability1),(A=E.data)!=null&&A.ability2&&(_.ability2=E.data.ability2),Array.isArray((D=E.data)==null?void 0:D.featureChoices)&&E.data.featureChoices.length&&(_.featureChoices=[..._.featureChoices||[],...E.data.featureChoices]),((R=E.data)==null?void 0:R.type)==="class"){const M=t.filter(W=>W.target===E.id&&(W==null?void 0:W.targetHandle)==="attach");for(const W of M){const H=r.get(W.source);if(!(!H||H.type!=="progressStep"))if(((P=H.data)==null?void 0:P.type)==="bundle"&&Array.isArray((F=H.data)==null?void 0:F.featureChoices))_.featureChoices=[..._.featureChoices||[],...H.data.featureChoices];else if(((G=H.data)==null?void 0:G.type)==="asi"){const re=H.data.asi||Ls(H.data.ability1,H.data.ability2);!_.asi&&re&&(_.asi=re),!_.ability1&&H.data.ability1&&(_.ability1=H.data.ability1),!_.ability2&&H.data.ability2&&(_.ability2=H.data.ability2)}else((J=H.data)==null?void 0:J.type)==="subclass"&&(_.subclass||(_.subclass=H.data.subclass||""))}if(Array.isArray(_.featureChoices)){const W=new Set;_.featureChoices=_.featureChoices.filter(H=>{const re=H&&typeof H=="object"&&H.id?String(H.id):JSON.stringify(H);return W.has(re)?!1:(W.add(re),!0)})}}typeof((B=E.data)==null?void 0:B.notes)=="string"&&E.data.notes&&!_.notes&&(_.notes=E.data.notes),u.set(L,_)}const f=Array.from(u.values()).sort((E,L)=>E.level-L.level);return{race:(v=a==null?void 0:a.data)==null?void 0:v.race,background:(j=a==null?void 0:a.data)==null?void 0:j.background,levels:f}}function WC(e){const t=V.useMemo(()=>e.nodes.filter(s=>s.type==="root"),[e.nodes]),[n,r]=V.useState(()=>{var s;return(s=t[0])==null?void 0:s.id});V.useEffect(()=>{var s;!n&&((s=t[0])!=null&&s.id)&&r(t[0].id)},[t,n]);const i=k.useCallback(()=>n?Ir(e.nodes,e.edges,n):null,[e.nodes,e.edges,n]);return l.jsxs("div",{style:{padding:12,display:"grid",gap:10},children:[l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Select Root"}),l.jsx("select",{value:n||"",onChange:s=>r(s.target.value||void 0),style:_t,children:t.map(s=>{var o,a;return l.jsxs("option",{value:s.id,children:[((o=s.data)==null?void 0:o.race)||"Race","  ",((a=s.data)==null?void 0:a.background)||"Background"," (",s.id.slice(0,6),")"]},s.id)})})]}),l.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[l.jsx("button",{disabled:!n,onClick:()=>n&&e.onClone(n),style:Ze,children:"Duplicate Branch"}),l.jsx("button",{onClick:()=>{var s;return(s=e.onCreateRoot)==null?void 0:s.call(e)},style:Ze,children:"+ New Root"}),l.jsx("button",{disabled:!n,onClick:()=>{const s=i();s&&e.onApplyPlan&&e.onApplyPlan(s)},style:Ze,children:"Apply to Builder"})]})]})}function UC(e){var Se,Ve,Qe,me,st;const[t,n,r]=Py([]),[i,s,o]=Ty([]),[a,c]=k.useState(void 0),u=k.useRef(!1),f=k.useRef(!1),h="progressionPlanner.v1",g=k.useMemo(()=>{var I;return`${h}:${((I=e.character)==null?void 0:I.name)||"default"}`},[(Se=e.character)==null?void 0:Se.name]),m="progressionPlanner.reseedDismissed.v1",S=k.useMemo(()=>{var I;return`${m}:${((I=e.character)==null?void 0:I.name)||"default"}`},[(Ve=e.character)==null?void 0:Ve.name]),w="progressionPlanner.activeRoot.v1",N=k.useMemo(()=>{var I;return`${w}:${((I=e.character)==null?void 0:I.name)||"default"}`},[(Qe=e.character)==null?void 0:Qe.name]),d="progressionPlanner.activePlan.v1",p=k.useMemo(()=>{var I;return`${d}:${((I=e.character)==null?void 0:I.name)||"default"}`},[(me=e.character)==null?void 0:me.name]),x=k.useCallback((I,Y,U)=>{const O=new Map(I.map(q=>[q.id,q])),ee=new Set;if(U&&O.has(U)){const q=[U];for(;q.length;){const fe=q.pop();ee.has(fe)||(ee.add(fe),Y.filter(Z=>Z.source===fe).forEach(Z=>q.push(Z.target)))}}return{active:ee}},[]),y=k.useCallback(I=>{n(Y=>{const{active:U}=x(Y,i,I);return Y.map(O=>({...O,data:{...O.data,_active:U.has(O.id)}}))})},[i,n,x]),C=k.useCallback((I,Y)=>{var Le,Oe;if(!I)return null;const U=(Y==null?void 0:Y.totalLevel)??I.classes.reduce((je,Ke)=>je+(Ke.level||0),0),O={};let ee=1;if(I.classes.forEach(je=>{for(let Ke=0;Ke<(je.level||0);Ke+=1){const Xe=je.klass.name,nt=Yn.includes(Xe)?Xe:"Fighter";O[ee]=nt,ee+=1}}),Object.keys(O).length===0&&U>0)for(let je=1;je<=U;je++)O[je]="Fighter";const q=[4,8,12,16,19],fe=I.feats||[],Z=`root-${crypto.randomUUID().slice(0,6)}`,de=[{id:Z,type:"root",position:{x:40,y:120},data:{race:(Le=I.race)==null?void 0:Le.name,background:(Oe=I.background)==null?void 0:Oe.name,collapsed:!0}}],Ue=[];let te=Z,Ce=0;for(let je=1;je<=Math.max(1,U||1);je+=1){const Ke=`step-${crypto.randomUUID().slice(0,6)}`,Xe={level:je,type:"class",className:O[je]||"Fighter",collapsed:!0},nt={id:Ke,type:"progressStep",position:{x:360,y:80+Ce*120},data:Xe};if(de.push(nt),Ue.push({id:`e-${crypto.randomUUID().slice(0,6)}`,source:te,target:Ke}),te=Ke,Ce+=1,q.includes(je)){const T=`step-${crypto.randomUUID().slice(0,6)}`,X=[];if(fe.length){const De=fe.shift();De&&X.push(De)}const pe={level:je,type:"asi",asi:"",ability1:null,ability2:null,feats:X,collapsed:!0},ue={id:T,type:"progressStep",position:{x:360,y:80+Ce*120},data:pe};de.push(ue),Ue.push({id:`e-${crypto.randomUUID().slice(0,6)}`,source:te,target:T}),te=T,Ce+=1}}return{nodes:de,edges:Ue}},[]),A=k.useMemo(()=>{var O,ee,q;const I=e.character;if(!I)return null;const Y=((O=e.derived)==null?void 0:O.totalLevel)??I.classes.reduce((fe,Z)=>fe+(Z.level||0),0),U=[];if(I.classes.forEach(fe=>{var de;const Z=((de=fe.klass)==null?void 0:de.name)||"",ae=fe.level||0;for(let Ue=0;Ue<ae;Ue+=1)U.push(Z)}),U.length===0&&Y>0)for(let fe=0;fe<Y;fe+=1)U.push("Fighter");return JSON.stringify({race:((ee=I.race)==null?void 0:ee.name)||"",background:((q=I.background)==null?void 0:q.name)||"",classes:U})},[e.character,e.derived]),D=k.useMemo(()=>{var O,ee,q,fe;const I=new Map(t.map(Z=>[Z.id,Z])),Y=t.filter(Z=>Z.type==="root"),U=[];for(const Z of Y){const ae=[];let de=Z.id,Ue=0;for(;de&&Ue<256;){Ue+=1;const Ce=i.filter(je=>je.source===de);if(!Ce.length)break;const Le=(ee=(O=Ce.map(je=>({e:je,n:I.get(je.target)})).filter(je=>!!je.n).sort((je,Ke)=>{var Xe,nt;return(((Xe=je.n.position)==null?void 0:Xe.y)||0)-(((nt=Ke.n.position)==null?void 0:nt.y)||0)})[0])==null?void 0:O.n)==null?void 0:ee.id;if(!Le)break;const Oe=I.get(Le);if(!Oe)break;Oe.type==="progressStep"&&ae.push(Oe),de=Le}if(!ae.length){const Ce=new Set,Le=[Z.id];for(;Le.length;){const Oe=Le.pop();Ce.has(Oe)||(Ce.add(Oe),i.filter(je=>je.source===Oe).forEach(je=>Le.push(je.target)))}ae.push(...t.filter(Oe=>Oe.type==="progressStep"&&Ce.has(Oe.id))),ae.sort((Oe,je)=>{var Ke,Xe,nt,kt;return(((Ke=Oe.data)==null?void 0:Ke.level)||0)-(((Xe=je.data)==null?void 0:Xe.level)||0)||(((nt=Oe.position)==null?void 0:nt.y)||0)-(((kt=je.position)==null?void 0:kt.y)||0)})}const te=ae.slice().sort((Ce,Le)=>{var Oe,je,Ke,Xe;return(((Oe=Ce.data)==null?void 0:Oe.level)||0)-(((je=Le.data)==null?void 0:je.level)||0)||(((Ke=Ce.position)==null?void 0:Ke.y)||0)-(((Xe=Le.position)==null?void 0:Xe.y)||0)}).map(Ce=>{var Le;return((Le=Ce.data)==null?void 0:Le.className)||""});U.push(JSON.stringify({race:((q=Z.data)==null?void 0:q.race)||"",background:((fe=Z.data)==null?void 0:fe.background)||"",classes:te}))}return U},[t,i]),[R,P]=k.useState(!1);V.useEffect(()=>{if(!A){P(!1);return}const I=localStorage.getItem(S),Y=D.includes(A);P(!Y&&I!==A)},[A,D,S]);const F=k.useCallback(()=>{A&&localStorage.setItem(S,A),P(!1)},[A,S]);V.useEffect(()=>{var Y;if(u.current)return;try{const U=localStorage.getItem(g),O=localStorage.getItem(N)||void 0;if(U){const ee=JSON.parse(U);if(ee&&Array.isArray(ee.nodes)&&Array.isArray(ee.edges)){const q=ee.nodes.map(fe=>{const Z={...fe.data};return Z.onChange=ae=>we(fe.id,ae),Z.onDelete=ae=>z(ae),fe.type==="root"&&(Z.onClone=()=>Q(fe.id)),Z.onAddChild=ae=>le(fe.id,ae),{...fe,data:Z}});n(q),s(ee.edges),u.current=!0,f.current=!0,c(O),y(O);return}}}catch{}const I=C(e.character,e.derived);if(I){const U=I.nodes.map(ee=>{const q={...ee.data};return q.onChange=fe=>we(ee.id,fe),q.onDelete=fe=>z(fe),ee.type==="root"&&(q.onClone=()=>Q(ee.id)),q.onAddChild=fe=>le(ee.id,fe),{...ee,data:q}});n(U),s(I.edges),u.current=!0;const O=(Y=U.find(ee=>ee.type==="root"))==null?void 0:Y.id;O&&(c(O),localStorage.setItem(N,O),y(O))}else{const U=`root-${crypto.randomUUID().slice(0,6)}`,O=`step-${crypto.randomUUID().slice(0,6)}`,ee=[{id:U,type:"root",position:{x:40,y:160},data:{race:"",background:"",collapsed:!0}},{id:O,type:"progressStep",position:{x:360,y:120},data:{level:1,type:"class",className:"Fighter",collapsed:!0}}];ee.forEach(q=>{const fe={...q.data};fe.onChange=Z=>we(q.id,Z),fe.onDelete=Z=>z(Z),q.type==="root"&&(fe.onClone=()=>Q(q.id)),fe.onAddChild=Z=>le(q.id,Z),q.data=fe}),n(ee),s([{id:`e-${crypto.randomUUID().slice(0,6)}`,source:U,target:O}]),u.current=!0,c(U),localStorage.setItem(N,U),y(U)}},[e.character,e.derived]),V.useEffect(()=>{if(u.current)try{const Y={nodes:t.map(U=>{const O={...U.data};return O&&(delete O.onChange,delete O.onDelete,delete O.onClone,delete O.onApply,delete O.onAddChild,delete O._active),{id:U.id,type:U.type,position:U.position,data:O}}),edges:i};localStorage.setItem(g,JSON.stringify(Y))}catch{}},[t,i,g]),V.useEffect(()=>{y(a)},[a,t.length,i.length,y]),V.useEffect(()=>{var I;if(u.current)try{const Y=t.filter(q=>q.type==="root"),U=a||((I=Y[0])==null?void 0:I.id);if(!U){localStorage.removeItem(p);return}const ee={plan:Ir(t,i,U),ts:Date.now()};localStorage.setItem(p,JSON.stringify(ee))}catch{}},[t,i,a,p]);const[G,J]=k.useState([]),[B,v]=k.useState(""),j=k.useCallback(I=>{const Y=`sb-${crypto.randomUUID().slice(0,6)}`,U=I==="class"?{id:Y,kind:I,level:1,className:"Fighter"}:I==="feat"?{id:Y,kind:I,level:1,featName:""}:I==="asi"?{id:Y,kind:I,level:4,ability1:null,ability2:null}:{id:Y,kind:"note",level:1,text:""};J(O=>[...O,U])},[]),E=k.useCallback((I,Y)=>{J(U=>U.map(O=>O.id===I?{...O,...Y}:O))},[]),L=k.useCallback(I=>J(Y=>Y.filter(U=>U.id!==I)),[]),_=k.useCallback((I,Y)=>{J(U=>{const O=U.findIndex(Z=>Z.id===I);if(O<0)return U;const ee=Math.max(0,Math.min(U.length-1,O+Y));if(ee===O)return U;const q=U.slice(),[fe]=q.splice(O,1);return q.splice(ee,0,fe),q})},[]),b=k.useRef({past:[],future:[],suppress:!1,lastTs:0}),M=k.useCallback(()=>{if(b.current.suppress)return;const I=Date.now();if(I-b.current.lastTs<50)return;b.current.lastTs=I;const Y=JSON.parse(JSON.stringify(t)),U=JSON.parse(JSON.stringify(i));b.current.past.push({nodes:Y,edges:U}),b.current.future=[]},[t,i]),W=k.useCallback(()=>{const{past:I,future:Y}=b.current;if(I.length===0)return;const U={nodes:JSON.parse(JSON.stringify(t)),edges:JSON.parse(JSON.stringify(i))},O=I.pop();Y.push(U),b.current.suppress=!0,n(O.nodes),s(O.edges),b.current.suppress=!1},[t,i,n,s]),H=k.useCallback(()=>{const{past:I,future:Y}=b.current;if(Y.length===0)return;const U={nodes:JSON.parse(JSON.stringify(t)),edges:JSON.parse(JSON.stringify(i))},O=Y.pop();I.push(U),b.current.suppress=!0,n(O.nodes),s(O.edges),b.current.suppress=!1},[t,i,n,s]);V.useEffect(()=>{const I=Y=>{const U=Y.ctrlKey||Y.metaKey,O=Y.key.toLowerCase();U&&O==="z"&&!Y.shiftKey?(Y.preventDefault(),W()):(U&&O==="y"||U&&O==="z"&&Y.shiftKey)&&(Y.preventDefault(),H())};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[W,H]);const re=k.useCallback(I=>{M(),r(I)},[M,r]),oe=k.useCallback(I=>{M(),o(I)},[M,o]),ge=k.useCallback(I=>{M(),s(Y=>Dd(I,Y))},[M,s]),we=k.useCallback((I,Y)=>{M(),n(U=>U.map(O=>O.id===I?{...O,data:{...O.data,...Y}}:O))},[M,n]),z=k.useCallback(I=>{M(),n(Y=>Y.filter(U=>U.id!==I)),s(Y=>Y.filter(U=>U.source!==I&&U.target!==I))},[n,s]),ie=k.useCallback(()=>{const I=new Set(t.map(te=>te.id)),Y={};t.forEach(te=>{Y[te.id]=0}),i.forEach(te=>{I.has(te.target)&&(Y[te.target]=(Y[te.target]||0)+1)});const U={};t.forEach(te=>{U[te.id]=(Y[te.id],0)});for(let te=0;te<t.length;te+=1){let Ce=!1;for(const Le of i){const Oe=(U[Le.source]??0)+1;(U[Le.target]??0)<Oe&&(U[Le.target]=Oe,Ce=!0)}if(!Ce)break}const O={};t.forEach(te=>{const Ce=U[te.id]??0;O[Ce]||(O[Ce]=[]),O[Ce].push(te)});const ee=te=>{var Oe,je;const Ce=te.height||((Oe=te.measured)==null?void 0:Oe.height);if(typeof Ce=="number"&&Ce>0)return Ce;const Le=!!((je=te.data)!=null&&je.collapsed);return te.type==="root"?Le?120:240:Le?140:560},q=360,fe=24,Z=40,ae=60,de={};Object.keys(O).map(te=>parseInt(te,10)).sort((te,Ce)=>te-Ce).forEach((te,Ce)=>{const Le=O[te];Le.sort((je,Ke)=>{var kt,T;const Xe=typeof((kt=je.data)==null?void 0:kt.level)=="number"?je.data.level:Number.MAX_SAFE_INTEGER,nt=typeof((T=Ke.data)==null?void 0:T.level)=="number"?Ke.data.level:Number.MAX_SAFE_INTEGER;return Xe!==nt?Xe-nt:je.type!==Ke.type?String(je.type).localeCompare(String(Ke.type)):String(je.id).localeCompare(String(Ke.id))});let Oe=ae;Le.forEach(je=>{de[je.id]={x:Z+Ce*q,y:Oe},Oe+=ee(je)+fe})}),M(),n(te=>te.map(Ce=>({...Ce,position:de[Ce.id]?de[Ce.id]:Ce.position})))},[t,i,n,M]),le=k.useCallback((I,Y)=>{var Xe,nt,kt,T,X,pe,ue,De,Re,Pe,Ie,et,Be;const U=new Map(t.map($=>[$.id,$])),O=U.get(I);if(!O)return;let ee=I,q=0,fe;for(;ee&&q<256;){q+=1;const $=U.get(ee);$&&$.type==="progressStep"&&(fe=$);const se=i.filter(K=>K.source===ee);if(!se.length)break;const ye=(nt=(Xe=se.map(K=>({e:K,n:U.get(K.target)})).filter(K=>!!K.n).sort((K,ce)=>{var xe,$e;return(((xe=K.n.position)==null?void 0:xe.y)||0)-((($e=ce.n.position)==null?void 0:$e.y)||0)})[0])==null?void 0:Xe.n)==null?void 0:nt.id;if(!ye)break;ee=ye}let Z=1,ae="Fighter";if(fe)Z=Math.min(20,(Number((kt=fe.data)==null?void 0:kt.level)||0)+1),ae=(T=fe.data)!=null&&T.className&&Yn.includes(fe.data.className)?fe.data.className:"Fighter";else if(O.type==="progressStep")Z=Math.min(20,(Number((X=O.data)==null?void 0:X.level)||0)+1),ae=(pe=O.data)!=null&&pe.className&&Yn.includes(O.data.className)?O.data.className:"Fighter";else{const $=(Pe=(Re=(De=(ue=e.character)==null?void 0:ue.classes)==null?void 0:De[0])==null?void 0:Re.klass)==null?void 0:Pe.name;ae=$&&Yn.includes($)?$:"Fighter",Z=1}const de=`step-${crypto.randomUUID().slice(0,6)}`,Ue=O.position||{x:0,y:0},te=i.filter($=>$.source===I).length,Ce={x:(Ue.x||0)+320,y:(Ue.y||0)+te*140},Le=Y||"class",Oe={level:Z,type:Le,collapsed:!1};let je=Oe;Le==="class"?je={...Oe,className:ae,type:Le}:Le==="feat"?je={...Oe,featName:"",feats:[]}:Le==="asi"?je={...Oe,asi:"",ability1:null,ability2:null}:Le==="bundle"?je={...Oe,featureChoices:[]}:Le==="subclass"?je={...Oe,type:"subclass",subclass:""}:Le==="note"&&(je={...Oe,notes:""}),M(),n($=>{const se={id:de,type:"progressStep",position:Ce,data:{...je}};return se.data.onChange=ye=>we(de,ye),se.data.onDelete=ye=>z(ye),se.data.onAddChild=ye=>le(de,ye),[...$,se]});const Ke=((Ie=U.get(I))==null?void 0:Ie.type)==="progressStep"&&((Be=(et=U.get(I))==null?void 0:et.data)==null?void 0:Be.type)==="class";s(Ke&&(Le==="bundle"||Le==="asi"||Le==="subclass")?$=>[...$,{id:`e-${crypto.randomUUID().slice(0,6)}`,source:de,sourceHandle:"top",target:I,targetHandle:"attach"}]:$=>[...$,{id:`e-${crypto.randomUUID().slice(0,6)}`,source:I,target:de}]),setTimeout(()=>{try{ie()}catch{}},0)},[t,i,e.character,n,s,M,we,z,ie]),he=k.useCallback(()=>{M(),n(I=>I.map(Y=>({...Y,data:{...Y.data,collapsed:!0}})))},[M,n]),Te=k.useCallback(()=>{M(),n(I=>I.map(Y=>({...Y,data:{...Y.data,collapsed:!1}})))},[M,n]),Q=k.useCallback(I=>{const Y=new Map(t.map(ae=>[ae.id,ae]));if(!Y.get(I)||Y.get(I).type!=="root")return;const U=new Set,O=[I];for(;O.length;){const ae=O.pop();if(U.has(ae))continue;U.add(ae),i.filter(Ue=>Ue.source===ae).map(Ue=>Ue.target).forEach(Ue=>O.push(Ue))}const ee=new Map,q=420,fe=[];Array.from(U).forEach(ae=>{var te,Ce;const de=Y.get(ae),Ue=`${de.type}-${crypto.randomUUID().slice(0,6)}`;ee.set(ae,Ue),fe.push({id:Ue,type:de.type,position:{x:(((te=de.position)==null?void 0:te.x)||0)+q,y:((Ce=de.position)==null?void 0:Ce.y)||0},data:{...de.data}})});const Z=i.filter(ae=>U.has(ae.source)&&U.has(ae.target)).map((ae,de)=>({id:`clone-${crypto.randomUUID().slice(0,6)}-${de}`,source:ee.get(ae.source),target:ee.get(ae.target)}));M(),n(ae=>[...ae,...fe]),s(ae=>[...ae,...Z])},[t,i,n,s,M]);V.useEffect(()=>{n(I=>I.map(Y=>{const U={...Y.data};return U.onChange||(U.onChange=O=>we(Y.id,O)),U.onDelete||(U.onDelete=O=>z(O)),Y.type==="root"&&!U.onClone&&(U.onClone=()=>Q(Y.id)),Y.type==="root"&&!U.onApply&&(U.onApply=()=>{const O=a||Y.id,ee=Ir(I,i,O);ee&&e.onApplyPlan&&e.onApplyPlan(ee)}),Y.type==="progressStep"&&!U.onApply&&(U.onApply=()=>{const O=Ko(I,i,Y.id);O&&e.onApplyPlan&&e.onApplyPlan(O)}),U.onAddChild=O=>le(Y.id,O),Y.type==="progressStep"&&(U.onCloneFromSelf=()=>{var Z,ae;let O=Y.id,ee=0;const q=new Map(I.map(de=>[de.id,de]));let fe;for(;O&&ee<256;){ee+=1;const de=i.filter(Ce=>Ce.target===O);if(!de.length)break;const Ue=(ae=(Z=de.map(Ce=>({e:Ce,nn:q.get(Ce.source)})).filter(Ce=>!!Ce.nn).sort((Ce,Le)=>{var Oe,je;return(((Oe=Ce.nn.position)==null?void 0:Oe.y)||0)-(((je=Le.nn.position)==null?void 0:je.y)||0)})[0])==null?void 0:Z.nn)==null?void 0:ae.id;if(!Ue)break;const te=q.get(Ue);if(!te)break;if(te.type==="root"){fe=te.id;break}O=te.id}fe&&Q(fe)}),{...Y,data:U}}))},[we,Q,i,e.onApplyPlan,le,n]);const Ae=k.useCallback(()=>{if(!G.length)return;M();const I=40+Math.random()*40,Y=`root-${crypto.randomUUID().slice(0,6)}`,U={id:Y,type:"root",position:{x:40,y:I+40},data:{race:"",background:""}};U.data.onChange=Z=>we(Y,Z),U.data.onDelete=Z=>z(Z),U.data.onClone=()=>Q(Y),U.data.onApply=()=>{const Z=Ir(t,i,Y);Z&&e.onApplyPlan&&e.onApplyPlan(Z)},U.data.onAddChild=Z=>le(Y,Z);let O=Y,ee=0;const q=[U],fe=[];G.sort((Z,ae)=>Z.level-ae.level).forEach(Z=>{const ae=`sbnode-${crypto.randomUUID().slice(0,6)}`,de=Z.kind==="class"?{level:Z.level,type:"class",className:Z.className||"Fighter"}:Z.kind==="feat"?{level:Z.level,type:"feat",featName:Z.featName||""}:Z.kind==="asi"?{level:Z.level,type:"asi",asi:[Z.ability1,Z.ability2].filter(Boolean).join(" / ")||""}:{level:Z.level,type:"note",notes:Z.text||""},Ue={id:ae,type:"progressStep",position:{x:360,y:I+ee*160},data:{...de}};Ue.data.onChange=te=>we(ae,te),Ue.data.onDelete=te=>z(te),Ue.data.onApply=()=>{const te=Ko(t,i,ae);te&&e.onApplyPlan&&e.onApplyPlan(te)},Ue.data.onAddChild=te=>le(ae,te),q.push(Ue),fe.push({id:`e-${crypto.randomUUID().slice(0,6)}`,source:O,target:ae}),O=ae,ee+=1}),n(Z=>[...Z,...q]),s(Z=>[...Z,...fe])},[G,n,s,M,we,z,Q]),ve=I=>{const Y=`${I}-${crypto.randomUUID().slice(0,6)}`,U=40+Math.random()*720,O={id:Y,type:I,position:{x:I==="root"?40:360,y:U},data:{}};I==="progressStep"&&Object.assign(O.data,{level:1,type:"class",className:"Fighter",collapsed:!1}),I==="root"&&Object.assign(O.data,{race:"",background:"",collapsed:!1}),O.data.onChange=ee=>we(Y,ee),O.data.onDelete=ee=>z(ee),O.data.onAddChild=ee=>le(Y,ee),I==="root"&&(O.data.onClone=()=>Q(Y),O.data.onApply=()=>{const ee=Ir(t,i,Y);ee&&e.onApplyPlan&&e.onApplyPlan(ee)}),M(),n(ee=>[...ee,O])};return l.jsxs("div",{className:"w-full",style:{display:"grid",gridTemplateColumns:"1fr 360px",gap:16,height:"calc(100vh - 100px)"},children:[l.jsxs("div",{style:{height:"100%",border:"1px solid #e2e8f0",borderRadius:12,overflow:"hidden",background:"white",position:"relative"},children:[l.jsx("style",{children:".react-flow__edge.edge-active path { stroke: #0ea5e9 !important; stroke-width: 2.5px; }"}),(()=>{const I=new Map(t.map(U=>{var O;return[U.id,!!((O=U.data)!=null&&O._active)]})),Y=i.map(U=>I.get(U.source)&&I.get(U.target)?{...U,className:"edge-active"}:U);return l.jsxs(Pd,{nodes:t,edges:Y,onNodesChange:re,onEdgesChange:oe,onConnect:ge,nodeTypes:HC,fitView:!0,children:[l.jsx(Hy,{}),l.jsx(Ly,{pannable:!0,zoomable:!0}),l.jsx(By,{showInteractive:!1})]})})(),R?l.jsx("div",{style:{position:"absolute",left:12,right:12,bottom:12,display:"flex",justifyContent:"center",pointerEvents:"none"},children:l.jsxs("div",{style:{pointerEvents:"auto",maxWidth:640,width:"100%",background:"white",border:"1px solid #e2e8f0",borderRadius:12,boxShadow:"0 6px 20px rgba(0,0,0,0.08)",padding:12,display:"grid",gap:8},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsx("div",{style:{fontWeight:600},children:"No branch matches the current Builder"}),l.jsx("button",{onClick:F,style:{...Ze,padding:"4px 8px"},title:"Dismiss",children:""})]}),l.jsx("div",{style:{fontSize:13,color:"#475569"},children:"You can reseed the planner from the Character Builder to create a matching branch."}),l.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[l.jsx("button",{onClick:F,style:Ze,children:"Not now"}),l.jsx("button",{onClick:()=>{var U;const I=C(e.character,e.derived);if(!I)return;M(),n(I.nodes.map(O=>{const ee={...O.data,onChange:q=>we(O.id,q),onDelete:q=>z(q)};return O.type==="root"&&(ee.onClone=()=>Q(O.id),ee.onApply=()=>{const q=Ir(I.nodes,I.edges,O.id);q&&e.onApplyPlan&&e.onApplyPlan(q)}),O.type==="progressStep"&&(ee.onApply=()=>{const q=Ko(I.nodes,I.edges,O.id);q&&e.onApplyPlan&&e.onApplyPlan(q)}),ee.onAddChild=q=>le(O.id,q),{...O,data:ee}})),s(I.edges);const Y=(U=I.nodes.find(O=>O.type==="root"))==null?void 0:U.id;Y&&(c(Y),localStorage.setItem(N,Y),y(Y)),F()},style:{...Ze,background:"#0ea5e9",borderColor:"#0284c7",color:"white"},children:"Reseed from Builder"})]})]})}):null]}),l.jsxs("div",{style:{display:"grid",gap:12,overflowY:"auto",overflowX:"hidden",paddingRight:12,minWidth:0},children:[l.jsxs("section",{style:Yo,children:[l.jsxs("div",{style:{padding:12,borderBottom:"1px solid #e2e8f0",fontWeight:600,display:"flex",justifyContent:"space-between"},children:[l.jsx("span",{children:"History"}),e.character?l.jsxs("span",{style:{fontSize:12,color:"#64748b"},children:[e.character.name,"  Lv ",((st=e.derived)==null?void 0:st.totalLevel)??e.character.classes.reduce((I,Y)=>I+(Y.level||0),0)]}):null]}),l.jsxs("div",{style:{padding:12,display:"flex",gap:8,flexWrap:"wrap",paddingRight:16},children:[l.jsx("button",{onClick:W,style:Ze,children:" Undo"}),l.jsx("button",{onClick:H,style:Ze,children:" Redo"}),l.jsx("button",{onClick:ie,style:Ze,title:"Auto-arrange nodes",children:"Auto Arrange"}),l.jsx("button",{onClick:Te,style:Ze,title:"Expand all nodes",children:"Expand All"}),l.jsx("button",{onClick:he,style:Ze,title:"Collapse all nodes",children:"Collapse All"}),l.jsx("button",{onClick:()=>{var U;const I=C(e.character,e.derived);if(!I)return;M(),n(I.nodes.map(O=>{const ee={...O.data,onChange:q=>we(O.id,q),onDelete:q=>z(q)};return O.type==="root"&&(ee.onClone=()=>Q(O.id),ee.onApply=()=>{const q=Ir(I.nodes,I.edges,O.id);q&&e.onApplyPlan&&e.onApplyPlan(q)}),O.type==="progressStep"&&(ee.onApply=()=>{const q=Ko(I.nodes,I.edges,O.id);q&&e.onApplyPlan&&e.onApplyPlan(q)}),ee.onAddChild=q=>le(O.id,q),{...O,data:ee}})),s(I.edges);const Y=(U=I.nodes.find(O=>O.type==="root"))==null?void 0:U.id;Y&&(c(Y),localStorage.setItem(N,Y),y(Y))},style:Ze,title:"Regenerate using current Builder",children:"Reseed from Builder"})]})]}),l.jsxs("section",{style:Yo,children:[l.jsx("div",{style:{padding:12,borderBottom:"1px solid #e2e8f0",fontWeight:600},children:"Branch Actions"}),l.jsx(WC,{nodes:t,edges:i,onClone:Q,onApplyPlan:e.onApplyPlan,onCreateRoot:()=>{ve("root"),setTimeout(()=>{try{ie()}catch{}},0)}}),l.jsxs("div",{style:{padding:12,display:"grid",gap:8},children:[l.jsxs("label",{style:{display:"grid",gap:6,fontSize:12,color:"#475569"},children:[l.jsx("span",{children:"Active Branch"}),l.jsxs("select",{value:a||"",onChange:I=>{const Y=I.target.value||void 0;c(Y),Y&&localStorage.setItem(N,Y),y(Y)},style:_t,children:[l.jsx("option",{value:"",children:"(none)"}),t.filter(I=>I.type==="root").map(I=>{var Y,U;return l.jsxs("option",{value:I.id,children:[((Y=I.data)==null?void 0:Y.race)||"Race","  ",((U=I.data)==null?void 0:U.background)||"Background"," (",I.id.slice(0,6),")"]},I.id)})]})]}),l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"The active branch is highlighted and drives the Apply to Builder."})]})]}),l.jsxs("section",{style:Yo,children:[l.jsx("div",{style:{padding:12,borderBottom:"1px solid #e2e8f0",fontWeight:600},children:"Add Nodes"}),l.jsxs("div",{style:{padding:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[l.jsx("button",{onClick:()=>ve("root"),style:Ze,children:"+ Root"}),l.jsx("button",{onClick:()=>ve("progressStep"),style:Ze,children:"+ Step"})]}),l.jsx("div",{style:{padding:"0 12px 12px",fontSize:12,color:"#64748b"},children:"Use Root to set Race and Background, then connect Steps to build branches. Clone a Root to fork a new branch with the same history."})]}),l.jsxs("section",{style:Yo,children:[l.jsx("div",{style:{padding:12,borderBottom:"1px solid #e2e8f0",fontWeight:600},children:"Scratch Blocks (beta)"}),l.jsxs("div",{style:{padding:12,display:"grid",gap:12},children:[l.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[l.jsx(Go,{label:"Class Block",color:Es.class,draggableData:{kind:"class"}}),l.jsx(Go,{label:"Feat Block",color:Es.feat,draggableData:{kind:"feat"}}),l.jsx(Go,{label:"ASI Block",color:Es.asi,draggableData:{kind:"asi"}}),l.jsx(Go,{label:"Note Block",color:Es.note,draggableData:{kind:"note"}}),l.jsx("span",{style:{fontSize:12,color:"#64748b",alignSelf:"center"},children:"or click:"}),l.jsx("button",{onClick:()=>j("class"),style:Ze,children:"+ Class"}),l.jsx("button",{onClick:()=>j("feat"),style:Ze,children:"+ Feat"}),l.jsx("button",{onClick:()=>j("asi"),style:Ze,children:"+ ASI"}),l.jsx("button",{onClick:()=>j("note"),style:Ze,children:"+ Note"})]}),l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[l.jsx("input",{value:B,onChange:I=>v(I.target.value),placeholder:"Filter tokens (e.g., fighter, str, elf)",style:{..._t,maxWidth:320}}),B?l.jsx("button",{style:{...Ze,padding:"6px 10px"},onClick:()=>v(""),children:"Clear"}):null]}),(()=>{const I=B.trim().toLowerCase(),Y=de=>I?de.toLowerCase().includes(I):!0,U=Yn.filter(de=>Y(de)),O=Yl.filter(de=>Y(de)),ee=Uy.filter(de=>Y(de)),q=Vy.filter(de=>Y(de)),Z=["Variant Rule","Alignment","Deity"].filter(de=>Y(de)),ae=I==="";return l.jsxs("div",{style:{display:"grid",gap:10},children:[ae||U.length?l.jsxs("details",{open:!0,children:[l.jsx("summary",{style:{...An,cursor:"pointer"},children:"Classes"}),l.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",paddingTop:6},children:[U.map(de=>l.jsx(ms,{label:de,type:"class",value:de},de)),U.length?null:l.jsx("span",{style:An,children:"No matches"})]})]}):null,ae||O.length?l.jsxs("details",{open:!0,children:[l.jsx("summary",{style:{...An,cursor:"pointer"},children:"Abilities"}),l.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",paddingTop:6},children:[O.map(de=>l.jsx(ms,{label:de,type:"ability",value:de},de)),O.length?null:l.jsx("span",{style:An,children:"No matches"})]})]}):null,ae||ee.length?l.jsxs("details",{open:!0,children:[l.jsx("summary",{style:{...An,cursor:"pointer"},children:"Races"}),l.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",paddingTop:6},children:[ee.map(de=>l.jsx(ms,{label:de,type:"race",value:de},de)),ee.length?null:l.jsx("span",{style:An,children:"No matches"})]})]}):null,ae||q.length?l.jsxs("details",{open:!0,children:[l.jsx("summary",{style:{...An,cursor:"pointer"},children:"Backgrounds"}),l.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",paddingTop:6},children:[q.map(de=>l.jsx(ms,{label:de,type:"background",value:de},de)),q.length?null:l.jsx("span",{style:An,children:"No matches"})]})]}):null,ae||Z.length?l.jsxs("details",{children:[l.jsx("summary",{style:{...An,cursor:"pointer"},children:"Other"}),l.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",paddingTop:6},children:[Z.map(de=>l.jsx(ms,{label:de,type:"text",value:de},de)),Z.length?null:l.jsx("span",{style:An,children:"No matches"})]})]}):null]})})()]}),l.jsx("div",{onDragOver:I=>I.preventDefault(),onDrop:I=>{const Y=I.dataTransfer.getData(Gy);if(Y)try{const U=JSON.parse(Y);U!=null&&U.kind&&j(U.kind)}catch{}},style:{padding:12,borderTop:"1px dashed #e2e8f0",display:"grid",gap:10},children:G.length===0?l.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Drag blocks here or use the buttons above to build a plan. You can drop tokens (classes, abilities) into matching holes on blocks."}):G.map(I=>l.jsx(OC,{blk:I,onChange:Y=>E(I.id,Y),onRemove:()=>L(I.id),onMoveUp:()=>_(I.id,-1),onMoveDown:()=>_(I.id,1)},I.id))}),l.jsxs("div",{style:{padding:12,display:"flex",gap:8},children:[l.jsx("button",{onClick:Ae,style:Ze,children:"Generate Branch from Blocks"}),G.length?l.jsxs("span",{style:{alignSelf:"center",fontSize:12,color:"#64748b"},children:[G.length," block(s)"]}):null]})]})]})]})}function VC(){return Math.random().toString(36).slice(2,9)}function YC(){var x;const[e,t]=k.useState([]),[n,r]=k.useState(1),[i,s]=k.useState(0),[o,a]=k.useState(""),[c,u]=k.useState(""),[f,h]=k.useState(""),g=k.useMemo(()=>[...e].sort((y,C)=>C.initiative-y.initiative),[e]),m=(x=g[i])==null?void 0:x.id,S=()=>{if(!o||c===""||f==="")return;const y={id:VC(),name:o.trim(),maxHp:Number(c),hp:Number(c),initiative:Number(f)},C=[...e,y];t(C);const A=[...C].sort((R,P)=>P.initiative-R.initiative),D=Math.max(0,A.findIndex(R=>R.id===m));s(D===-1?0:D),a(""),u(""),h("")},w=y=>{const C=g.findIndex(D=>D.id===y),A=e.filter(D=>D.id!==y);if(t(A),A.length===0)s(0),r(1);else if(C!==-1){const D=[...A].sort((P,F)=>F.initiative-P.initiative),R=Math.min(Math.max(0,i-(C<=i?1:0)),D.length-1);s(R)}},N=()=>{if(g.length===0)return;const y=(i+1)%g.length;s(y),y===0&&r(C=>C+1)},d=(y,C)=>{t(A=>A.map(D=>D.id===y?{...D,hp:Math.max(0,Math.min(D.maxHp,D.hp+C))}:D))},p=()=>{r(1),s(0),t(y=>y.map(C=>({...C,hp:C.maxHp})))};return l.jsxs("div",{style:{maxWidth:1200,margin:"0 auto"},children:[l.jsx("h2",{style:{marginTop:0},children:"Combat Tracker"}),l.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:16},children:[l.jsxs("div",{children:[l.jsx("label",{style:cc,children:"Name"}),l.jsx("input",{value:o,onChange:y=>a(y.target.value),placeholder:"Goblin A / Cleric",style:uc})]}),l.jsxs("div",{children:[l.jsx("label",{style:cc,children:"Max HP"}),l.jsx("input",{value:c,onChange:y=>u(y.target.value===""?"":Number(y.target.value)),type:"number",min:0,style:uc})]}),l.jsxs("div",{children:[l.jsx("label",{style:cc,children:"Initiative"}),l.jsx("input",{value:f,onChange:y=>h(y.target.value===""?"":Number(y.target.value)),type:"number",style:uc})]}),l.jsx("button",{onClick:S,style:KC,children:"Add"}),l.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[l.jsxs("div",{style:{padding:"6px 10px",border:"1px solid #cbd5e1",borderRadius:8,background:"white"},children:["Round: ",l.jsx("b",{children:n})]}),l.jsx("button",{onClick:N,style:Gl,children:"Next Turn "}),l.jsx("button",{onClick:p,style:Gl,children:"Reset"})]})]}),g.length===0?l.jsx("div",{style:{padding:16,border:"1px dashed #cbd5e1",borderRadius:8,color:"#475569"},children:"Add combatants with their max HP and initiative. Use Next Turn to advance the round."}):l.jsx("div",{style:{display:"grid",gap:8},children:g.map((y,C)=>{const A=C===i,D=y.hp<=0;return l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr repeat(4, auto)",alignItems:"center",gap:8,padding:10,border:"1px solid #e2e8f0",borderRadius:8,background:A?"#ecfeff":"white",opacity:D?.7:1},children:[l.jsx("div",{title:"Initiative",style:{width:40,textAlign:"center",fontWeight:700},children:y.initiative}),l.jsxs("div",{children:[l.jsx("div",{style:{fontWeight:600},children:y.name}),l.jsx(GC,{hp:y.hp,maxHp:y.maxHp})]}),l.jsxs("div",{style:{display:"flex",gap:6},children:[l.jsx("button",{onClick:()=>d(y.id,-1),style:zr,children:"-1"}),l.jsx("button",{onClick:()=>d(y.id,-5),style:zr,children:"-5"}),l.jsx("button",{onClick:()=>d(y.id,-10),style:zr,children:"-10"})]}),l.jsxs("div",{style:{display:"flex",gap:6},children:[l.jsx("button",{onClick:()=>d(y.id,1),style:zr,children:"+1"}),l.jsx("button",{onClick:()=>d(y.id,5),style:zr,children:"+5"}),l.jsx("button",{onClick:()=>d(y.id,10),style:zr,children:"+10"})]}),l.jsxs("div",{style:{color:"#0f172a",minWidth:80,textAlign:"right"},children:[y.hp," / ",y.maxHp]}),l.jsx("button",{onClick:()=>w(y.id),style:{...zr,color:"#ef4444",borderColor:"#fecaca"},children:"Remove"})]},y.id)})})]})}function GC({hp:e,maxHp:t}){const n=Math.max(0,Math.min(100,e/Math.max(1,t)*100)),r=e<=0?"#64748b":n<25?"#ef4444":n<60?"#f59e0b":"#22c55e";return l.jsx("div",{style:{height:10,background:"#f1f5f9",borderRadius:999,overflow:"hidden",border:"1px solid #e2e8f0",marginTop:6},children:l.jsx("div",{style:{width:n+"%",height:"100%",background:r}})})}const cc={display:"block",fontSize:12,color:"#334155",marginBottom:4},uc={padding:"8px 10px",border:"1px solid #cbd5e1",borderRadius:8,minWidth:160},Gl={padding:"8px 12px",borderRadius:8,border:"1px solid #cbd5e1",background:"white",cursor:"pointer"},KC={...Gl,background:"#0ea5e9",color:"white",borderColor:"#38bdf8"},zr={...Gl,padding:"6px 10px"};function XC(){return Math.floor(Math.random()*20)+1}function QC(e,t,n){const r=Array(e.count).fill(e.hp),i=Array(t.count).fill(t.hp),s=(c,u)=>{let f=0;for(let h=0;h<1;h++){const g=XC();(g===20||g!==1&&g+c>=u)&&f++}return f};for(let c=1;c<=n;c++){for(let h=0;h<r.length;h++){if(r[h]<=0)continue;let m=s(e.attackBonus,t.ac)*e.damageAvg;for(let S=0;S<i.length&&m>0;S++){if(i[S]<=0)continue;const w=i[S];i[S]=Math.max(0,i[S]-m),m=Math.max(0,m-w)}}for(let h=0;h<i.length;h++){if(i[h]<=0)continue;let m=s(t.attackBonus,e.ac)*t.damageAvg;for(let S=0;S<r.length&&m>0;S++){if(r[S]<=0)continue;const w=r[S];r[S]=Math.max(0,r[S]-m),m=Math.max(0,m-w)}}const u=r.some(h=>h>0),f=i.some(h=>h>0);if(!u||!f)break}const o=r.filter(c=>c>0).length,a=i.filter(c=>c>0).length;return{aliveA:o,aliveB:a}}function JC(){const[e,t]=k.useState({name:"Party",count:4,attackBonus:6,damageAvg:8,ac:16,hp:24}),[n,r]=k.useState({name:"Enemies",count:4,attackBonus:4,damageAvg:6,ac:14,hp:18}),[i,s]=k.useState(5),[o,a]=k.useState(2e3),c=k.useMemo(()=>()=>{let f=0,h=0,g=0,m=0;for(let w=0;w<o;w++){const N=QC(e,n,i);g+=N.aliveA,m+=N.aliveB,N.aliveA>0&&N.aliveB===0?f++:N.aliveB>0&&N.aliveA===0?h++:N.aliveA>N.aliveB?f++:N.aliveB>N.aliveA&&h++}return{trials:o,rounds:i,winRateA:f/o,winRateB:h/o,avgUnitsAliveA:g/o,avgUnitsAliveB:m/o}},[e,n,i,o]),u=k.useMemo(()=>c(),[c]);return l.jsxs("div",{style:{maxWidth:1200,margin:"0 auto"},children:[l.jsx("h2",{style:{marginTop:0},children:"Encounter Simulator"}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[l.jsx(Wh,{title:"Side A",side:e,onChange:t}),l.jsx(Wh,{title:"Side B",side:n,onChange:r})]}),l.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end",marginBottom:16},children:[l.jsxs("div",{children:[l.jsx("label",{style:Uh,children:"Rounds"}),l.jsx("input",{type:"number",min:1,value:i,onChange:f=>s(Number(f.target.value)),style:fr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Uh,children:"Trials"}),l.jsx("input",{type:"number",min:100,step:100,value:o,onChange:f=>a(Number(f.target.value)),style:fr})]}),l.jsxs("div",{style:{marginLeft:"auto",padding:"8px 12px",border:"1px solid #cbd5e1",borderRadius:8,background:"white"},children:["Computed across ",u.trials.toLocaleString()," trials / ",u.rounds," rounds"]})]}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[l.jsx(Xo,{title:`${e.name} Win Rate`,value:(u.winRateA*100).toFixed(1)+"%",accent:"#22c55e"}),l.jsx(Xo,{title:`${n.name} Win Rate`,value:(u.winRateB*100).toFixed(1)+"%",accent:"#ef4444"}),l.jsx(Xo,{title:`${e.name} Avg Units Alive`,value:u.avgUnitsAliveA.toFixed(2)}),l.jsx(Xo,{title:`${n.name} Avg Units Alive`,value:u.avgUnitsAliveB.toFixed(2)})]})]})}function Wh({title:e,side:t,onChange:n}){return l.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:12},children:[l.jsx("div",{style:{fontWeight:700,marginBottom:8},children:e}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:8},children:[l.jsx(pi,{label:"Name",children:l.jsx("input",{value:t.name,onChange:r=>n({...t,name:r.target.value}),style:fr})}),l.jsx(pi,{label:"Count",children:l.jsx("input",{type:"number",min:1,value:t.count,onChange:r=>n({...t,count:Number(r.target.value)}),style:fr})}),l.jsx(pi,{label:"Attack Bonus",children:l.jsx("input",{type:"number",value:t.attackBonus,onChange:r=>n({...t,attackBonus:Number(r.target.value)}),style:fr})}),l.jsx(pi,{label:"Avg Damage on Hit",children:l.jsx("input",{type:"number",min:0,value:t.damageAvg,onChange:r=>n({...t,damageAvg:Number(r.target.value)}),style:fr})}),l.jsx(pi,{label:"AC",children:l.jsx("input",{type:"number",min:0,value:t.ac,onChange:r=>n({...t,ac:Number(r.target.value)}),style:fr})}),l.jsx(pi,{label:"HP per Unit",children:l.jsx("input",{type:"number",min:1,value:t.hp,onChange:r=>n({...t,hp:Number(r.target.value)}),style:fr})})]})]})}function pi({label:e,children:t}){return l.jsxs("label",{children:[l.jsx("div",{style:Ky,children:e}),t]})}function Xo({title:e,value:t,accent:n}){return l.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:12},children:[l.jsx("div",{style:{fontSize:12,color:"#334155"},children:e}),l.jsx("div",{style:{fontSize:22,fontWeight:800,color:n??"#0f172a"},children:t})]})}const Ky={display:"block",fontSize:12,color:"#334155",marginBottom:4},Uh=Ky,fr={padding:"8px 10px",border:"1px solid #cbd5e1",borderRadius:8,width:"100%"};function ZC(){const[e,t]=k.useState("builder"),[n,r]=k.useState(void 0),[i,s]=k.useState(void 0),[o,a]=k.useState(void 0),c=f=>{a({...f,_ts:Date.now()}),t("builder")},u=k.useMemo(()=>`progressionPlanner.activePlan.v1:${(n==null?void 0:n.name)||"default"}`,[n==null?void 0:n.name]);return k.useEffect(()=>{if(e==="builder")try{const f=localStorage.getItem(u);if(!f)return;const h=JSON.parse(f);h&&h.plan&&a({...h.plan||{},_ts:Date.now(),_origin:"planner-passive"})}catch{}},[e,u]),l.jsxs("div",{children:[l.jsx("header",{style:{position:"sticky",top:0,zIndex:30,backdropFilter:"saturate(1.2) blur(6px)",background:"rgba(248,250,252,0.8)",borderBottom:"1px solid #e2e8f0"},children:l.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:"16px 20px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsx("h1",{style:{margin:0,fontSize:20,letterSpacing:.2,fontWeight:700},children:"TTRPG Character Creator (5e)"}),l.jsxs("nav",{style:{display:"flex",gap:8},children:[l.jsx("button",{onClick:()=>t("builder"),style:ys(e==="builder"),children:"Character Builder"}),l.jsx("button",{onClick:()=>t("planner"),style:ys(e==="planner"),children:"Progression Planner"}),l.jsx("button",{onClick:()=>t("optimizer"),style:ys(e==="optimizer"),children:"DPR Graph Optimizer"}),l.jsx("button",{onClick:()=>t("combat"),style:ys(e==="combat"),children:"Combat Tracker"}),l.jsx("button",{onClick:()=>t("sim"),style:ys(e==="sim"),children:"Encounter Simulator"})]})]})}),l.jsx("main",{style:{padding:"16px 20px"},children:e==="builder"?l.jsx("div",{style:{maxWidth:1200,margin:"0 auto"},children:l.jsx(c1,{importPlan:o,onCharacterChange:(f,h)=>{r(f),s(h)}})}):e==="planner"?l.jsx(UC,{character:n,derived:i,onApplyPlan:c}):e==="optimizer"?l.jsx(IC,{character:n,derived:i}):e==="combat"?l.jsx(YC,{}):l.jsx(JC,{})})]})}function ys(e){return{padding:"10px 14px",borderRadius:8,border:"1px solid #cbd5e1",background:e?"#0ea5e9":"white",color:e?"white":"#0f172a",cursor:"pointer"}}const qC=im(document.getElementById("root"));qC.render(l.jsx(V.StrictMode,{children:l.jsx(ZC,{})}));
