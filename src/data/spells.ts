import type { Spell, SpellMeta, MagicSchool, DamageType, AbilityKey } from './types'

export const SPELLS: Spell[] = [
  // Cantrips (Level 0)
  { id: 'vicious-mockery', name: 'Vicious Mockery', level: 0, classes: ['bard'], text: 'Insult a creature; it takes psychic damage and has disadvantage on next attack.' },
  { id: 'prestidigitation', name: 'Prestidigitation', level: 0, classes: ['bard', 'wizard'], text: 'Minor magical tricks and sensory effects.' },
  { id: 'mage-hand', name: 'Mage Hand', level: 0, classes: ['bard', 'wizard'], text: 'Create a spectral hand to manipulate objects.' },
  { id: 'friends', name: 'Friends', level: 0, classes: ['bard'], text: 'Gain advantage on CHA checks directed at one creature.' },
  // Druid cantrips
  { id: 'produce-flame', name: 'Produce Flame', level: 0, classes: ['druid'], text: 'Conjure a flame in your hand; shed light and can hurl for fire damage.' },
  { id: 'shillelagh', name: 'Shillelagh', level: 0, classes: ['druid'], text: 'Imbue a club or quarterstaff; use WIS for attack/damage.' },
  { id: 'thorn-whip', name: 'Thorn Whip', level: 0, classes: ['druid'], text: 'Create a vine whip; pull a creature closer on a hit.' },
  { id: 'guidance', name: 'Guidance', level: 0, classes: ['cleric'], text: 'Add 1d4 to one ability check.' },
  { id: 'sacred-flame', name: 'Sacred Flame', level: 0, classes: ['cleric'], text: 'Radiant fire descends on a creature; DEX save for no damage.' },
  { id: 'thaumaturgy', name: 'Thaumaturgy', level: 0, classes: ['cleric'], text: 'Manifest minor wonders to show divine power.' },
  { id: 'spare-the-dying', name: 'Spare the Dying', level: 0, classes: ['cleric'], text: 'Stabilize a creature at 0 HP.' },
  { id: 'fire-bolt', name: 'Fire Bolt', level: 0, classes: ['wizard'], text: 'Ranged spell attack for fire damage.' },
  { id: 'ray-of-frost', name: 'Ray of Frost', level: 0, classes: ['wizard'], text: 'Ray of cold that slows the target.' },
  // Warlock cantrip
  { id: 'eldritch-blast', name: 'Eldritch Blast', level: 0, classes: ['warlock'], text: 'Ranged spell attack dealing force damage.' },
  // Additional cantrips (expanded demo)
  { id: 'minor-illusion', name: 'Minor Illusion', level: 0, classes: ['bard', 'wizard'], text: 'Create a sound or image to distract or conceal.' },
  { id: 'light', name: 'Light', level: 0, classes: ['cleric', 'wizard'], text: 'Object sheds bright light; dispels magical darkness in small areas rarely.' },
  { id: 'resistance', name: 'Resistance', level: 0, classes: ['cleric', 'druid'], text: 'Touch grants +1d4 to one saving throw before the spell ends.' },
  { id: 'druidcraft', name: 'Druidcraft', level: 0, classes: ['druid'], text: 'Whisper of nature: predict weather, create small sensory effects.' },
  { id: 'acid-splash', name: 'Acid Splash', level: 0, classes: ['wizard'], text: 'Hurl a bubble of acid that corrodes one or two nearby targets.' },
  { id: 'shocking-grasp', name: 'Shocking Grasp', level: 0, classes: ['wizard'], text: 'Lightning springs from your hand; target can’t take reactions briefly.' },
  { id: 'chill-touch', name: 'Chill Touch', level: 0, classes: ['wizard'], text: 'Skeletal hand deals necrotic damage; hampers healing.' },
  // Level 1
  { id: 'healing-word', name: 'Healing Word', level: 1, classes: ['bard', 'cleric'], text: 'Bonus action healing at range.' },
  { id: 'tashas-hideous-laughter', name: "Tasha's Hideous Laughter", level: 1, classes: ['bard'], text: 'A creature falls prone with laughter; WIS save ends.' },
  { id: 'dissonant-whispers', name: 'Dissonant Whispers', level: 1, classes: ['bard'], text: 'Psychic damage; target may flee immediately.' },
  { id: 'faerie-fire', name: 'Faerie Fire', level: 1, classes: ['bard'], text: 'Outline creatures; attacks against them have advantage.' },
  { id: 'heroism', name: 'Heroism', level: 1, classes: ['bard', 'paladin'], text: 'A willing creature is imbued with bravery and temporary vigor.' },
  { id: 'charm-person', name: 'Charm Person', level: 1, classes: ['bard', 'wizard'], text: 'Attempt to charm a humanoid.' },
  { id: 'cure-wounds', name: 'Cure Wounds', level: 1, classes: ['cleric'], text: 'Touch-based healing.' },
  { id: 'bless', name: 'Bless', level: 1, classes: ['cleric'], text: 'Add 1d4 to allies’ attack rolls and saves.' },
  { id: 'guiding-bolt', name: 'Guiding Bolt', level: 1, classes: ['cleric'], text: 'Radiant damage and advantage for next attack against target.' },
  { id: 'sanctuary', name: 'Sanctuary', level: 1, classes: ['cleric'], text: 'Ward a creature against attack; attackers must make a save.' },
  { id: 'command', name: 'Command', level: 1, classes: ['cleric'], text: 'Speak a one-word command; target must obey on a failed save.' },
  { id: 'inflict-wounds', name: 'Inflict Wounds', level: 1, classes: ['cleric'], text: 'Melee spell attack dealing strong necrotic damage.' },
  // Druid level 1
  { id: 'entangle', name: 'Entangle', level: 1, classes: ['druid'], text: 'Grasping weeds restrain creatures in a 20‑foot square.' },
  { id: 'goodberry', name: 'Goodberry', level: 1, classes: ['druid'], text: 'Create ten berries that heal when eaten.' },
  { id: 'fog-cloud', name: 'Fog Cloud', level: 1, classes: ['druid', 'ranger', 'wizard'], text: 'Create a 20‑foot‑radius sphere of fog that heavily obscures.' },
  { id: 'speak-with-animals', name: 'Speak with Animals', level: 1, classes: ['druid', 'ranger'], text: 'You gain the ability to comprehend and verbally communicate with beasts.' },
  // Ranger level 1
  { id: 'hunters-mark', name: "Hunter's Mark", level: 1, classes: ['ranger'], text: 'Mark a target to deal extra damage and track it more easily.' },
  { id: 'ensnaring-strike', name: 'Ensnaring Strike', level: 1, classes: ['ranger'], text: 'Vines spring forth to restrain the target on a hit.' },
  { id: 'hail-of-thorns', name: 'Hail of Thorns', level: 1, classes: ['ranger'], text: 'Your ranged attack sprouts thorns that burst in a small radius.' },
  // Paladin level 1
  { id: 'compelled-duel', name: 'Compelled Duel', level: 1, classes: ['paladin'], text: 'Compel a creature to duel you; disadvantage to attack others.' },
  { id: 'divine-favor', name: 'Divine Favor', level: 1, classes: ['paladin'], text: 'Your weapon attacks deal +1d4 radiant damage.' },
  { id: 'shield-of-faith', name: 'Shield of Faith', level: 1, classes: ['paladin'], text: 'A shimmering field grants +2 AC for duration.' },
  { id: 'wrathful-smite', name: 'Wrathful Smite', level: 1, classes: ['paladin'], text: 'Empower your strike with fear‑inducing psychic energy.' },
  { id: 'searing-smite', name: 'Searing Smite', level: 1, classes: ['paladin'], text: 'Your weapon flares with white‑hot intensity on a hit.' },
  { id: 'thunderous-smite', name: 'Thunderous Smite', level: 1, classes: ['paladin'], text: 'Your strike rings with thunder; may push and knock prone.' },
  { id: 'magic-missile', name: 'Magic Missile', level: 1, classes: ['wizard'], text: 'Automatically hits with force darts.' },
  { id: 'shield-spell', name: 'Shield', level: 1, classes: ['wizard'], text: '+5 AC as a reaction until your next turn.' },
  { id: 'mage-armor', name: 'Mage Armor', level: 1, classes: ['wizard'], text: 'Protective magical force; set AC when unarmored.' },
  { id: 'sleep', name: 'Sleep', level: 1, classes: ['wizard'], text: 'Magically send creatures into slumber.' },
  { id: 'burning-hands', name: 'Burning Hands', level: 1, classes: ['wizard', 'sorcerer'], text: 'A fan of flames erupts from your hands.' },
  { id: 'detect-magic', name: 'Detect Magic', level: 1, classes: ['wizard', 'cleric', 'druid', 'bard'], text: 'Sense the presence of magic within 30 feet.' },
  { id: 'feather-fall', name: 'Feather Fall', level: 1, classes: ['wizard', 'bard', 'sorcerer'], text: 'Choose falling creatures to slow their descent.' },
  { id: 'grease', name: 'Grease', level: 1, classes: ['wizard'], text: 'Slick grease makes an area difficult and creatures may fall prone.' },
  { id: 'identify', name: 'Identify', level: 1, classes: ['wizard', 'bard'], text: 'Determine properties of a magic item or effect.' },
  // Warlock level 1
  { id: 'hex', name: 'Hex', level: 1, classes: ['warlock'], text: 'Curse a creature; deal extra damage and disadvantage on checks.' },
  { id: 'armor-of-agathys', name: 'Armor of Agathys', level: 1, classes: ['warlock'], text: 'Gain temporary HP and deal cold damage to attackers.' },
  { id: 'hellish-rebuke', name: 'Hellish Rebuke', level: 1, classes: ['warlock'], text: 'Reactive burst of hellish flames against your attacker.' },
  // Level 2
  { id: 'aid', name: 'Aid', level: 2, classes: ['cleric', 'paladin'], text: 'Bolster allies with increased hit point maximum and healing.' },
  { id: 'spiritual-weapon', name: 'Spiritual Weapon', level: 2, classes: ['cleric'], text: 'Summon a floating weapon to strike as a bonus action.' },
  { id: 'prayer-of-healing', name: 'Prayer of Healing', level: 2, classes: ['cleric'], text: 'After a short prayer, multiple allies regain hit points.' },
  { id: 'lesser-restoration', name: 'Lesser Restoration', level: 2, classes: ['cleric', 'druid', 'paladin'], text: 'End one disease or a condition afflicting a creature.' },
  { id: 'pass-without-trace', name: 'Pass without Trace', level: 2, classes: ['druid', 'ranger'], text: 'Veil your group in shadows; +10 to Stealth checks.' },
  { id: 'moonbeam', name: 'Moonbeam', level: 2, classes: ['druid'], text: 'Pale light damages and reveals shapeshifters.' },
  { id: 'misty-step', name: 'Misty Step', level: 2, classes: ['bard', 'sorcerer', 'warlock', 'wizard'], text: 'Briefly surrounded by silvery mist, you teleport a short distance.' },
  { id: 'mirror-image', name: 'Mirror Image', level: 2, classes: ['sorcerer', 'wizard'], text: 'Create illusory duplicates to confuse attackers.' },
  { id: 'invisibility', name: 'Invisibility', level: 2, classes: ['bard', 'sorcerer', 'wizard'], text: 'Target becomes invisible until it attacks or you lose focus.' },
  { id: 'scorching-ray', name: 'Scorching Ray', level: 2, classes: ['sorcerer', 'wizard'], text: 'Project multiple fiery rays at targets within range.' },
  { id: 'hold-person', name: 'Hold Person', level: 2, classes: ['bard', 'cleric', 'sorcerer', 'warlock', 'wizard'], text: 'Paralyze a humanoid that fails a WIS save.' },
  { id: 'darkness', name: 'Darkness', level: 2, classes: ['warlock', 'sorcerer', 'wizard'], text: 'Magical darkness spreads from a point you choose.' },
  { id: 'branding-smite', name: 'Branding Smite', level: 2, classes: ['paladin'], text: 'Your weapon gleams; a struck foe sheds revealing light.' },
  { id: 'magic-weapon', name: 'Magic Weapon', level: 2, classes: ['paladin', 'wizard'], text: 'Imbue a weapon with a +1 bonus to attack and damage rolls.' },
  { id: 'hail-of-thorns-2', name: 'Spike Growth', level: 2, classes: ['druid', 'ranger'], text: 'Area sprouts spikes; movement deals piercing damage.' },
  // Level 3
  { id: 'revivify', name: 'Revivify', level: 3, classes: ['cleric', 'paladin'], text: 'Return a creature to life if it died within the last minute.' },
  { id: 'spirit-guardians', name: 'Spirit Guardians', level: 3, classes: ['cleric'], text: 'Summon spirits that slow foes and deal radiant or necrotic damage.' },
  { id: 'call-lightning', name: 'Call Lightning', level: 3, classes: ['druid'], text: 'Create a storm cloud; call down bolts of lightning.' },
  { id: 'conjure-animals', name: 'Conjure Animals', level: 3, classes: ['druid', 'ranger'], text: 'Summon fey spirits that take beast forms to fight for you.' },
  { id: 'blinding-smite', name: 'Blinding Smite', level: 3, classes: ['paladin'], text: 'Your strike flashes with radiant light that can blind a foe.' },
  { id: 'fireball', name: 'Fireball', level: 3, classes: ['sorcerer', 'wizard'], text: 'A bright streak blossoms into a roaring fire explosion.' },
  { id: 'counterspell', name: 'Counterspell', level: 3, classes: ['sorcerer', 'warlock', 'wizard'], text: 'Interrupt another creature’s spellcasting.' },
  { id: 'dispel-magic', name: 'Dispel Magic', level: 3, classes: ['bard', 'cleric', 'druid', 'sorcerer', 'warlock', 'wizard'], text: 'End spells on creatures or objects within range.' },
  { id: 'hypnotic-pattern', name: 'Hypnotic Pattern', level: 3, classes: ['bard', 'sorcerer', 'warlock', 'wizard'], text: 'A weaving pattern charms and incapacitates those who see it.' },
  { id: 'haste', name: 'Haste', level: 3, classes: ['sorcerer', 'wizard'], text: 'Target moves faster and gains an extra action briefly.' },
]

export const SPELL_META: Record<string, SpellMeta> = {
  // Cantrips
  'vicious-mockery': { school: 'enchantment', damageTypes: ['psychic'], save: 'wis' },
  'prestidigitation': { school: 'transmutation', save: 'none' },
  'mage-hand': { school: 'conjuration', save: 'none' },
  'friends': { school: 'enchantment', save: 'none' },
  'produce-flame': { school: 'conjuration', damageTypes: ['fire'], save: 'none' },
  'shillelagh': { school: 'transmutation', save: 'none' },
  'thorn-whip': { school: 'transmutation', damageTypes: ['piercing'], save: 'none' },
  'guidance': { school: 'divination', save: 'none' },
  'sacred-flame': { school: 'evocation', damageTypes: ['radiant'], save: 'dex' },
  'thaumaturgy': { school: 'transmutation', save: 'none' },
  'spare-the-dying': { school: 'necromancy', save: 'none' },
  'fire-bolt': { school: 'evocation', damageTypes: ['fire'], save: 'none' },
  'ray-of-frost': { school: 'evocation', damageTypes: ['cold'], save: 'none' },
  'eldritch-blast': { school: 'evocation', damageTypes: ['force'], save: 'none' },
  'minor-illusion': { school: 'illusion', save: 'none' },
  'light': { school: 'evocation', save: 'none' },
  'resistance': { school: 'abjuration', save: 'none' },
  'druidcraft': { school: 'transmutation', save: 'none' },
  'acid-splash': { school: 'conjuration', damageTypes: ['acid'], save: 'dex' },
  'shocking-grasp': { school: 'evocation', damageTypes: ['lightning'], save: 'none' },
  'chill-touch': { school: 'necromancy', damageTypes: ['necrotic'], save: 'none' },
  // Level 1
  'healing-word': { school: 'evocation', save: 'none' },
  "tashas-hideous-laughter": { school: 'enchantment', save: 'wis' },
  'dissonant-whispers': { school: 'enchantment', damageTypes: ['psychic'], save: 'wis' },
  'faerie-fire': { school: 'evocation', save: 'dex' },
  'heroism': { school: 'enchantment', save: 'none' },
  'charm-person': { school: 'enchantment', save: 'wis' },
  'cure-wounds': { school: 'evocation', save: 'none' },
  'bless': { school: 'enchantment', save: 'none' },
  'guiding-bolt': { school: 'evocation', damageTypes: ['radiant'], save: 'none' },
  'sanctuary': { school: 'abjuration', save: 'wis' },
  'command': { school: 'enchantment', save: 'wis' },
  'inflict-wounds': { school: 'necromancy', damageTypes: ['necrotic'], save: 'none' },
  'entangle': { school: 'conjuration', save: 'str' },
  'goodberry': { school: 'transmutation', save: 'none' },
  'fog-cloud': { school: 'conjuration', save: 'none' },
  'speak-with-animals': { school: 'divination', save: 'none' },
  'hunters-mark': { school: 'divination', save: 'none' },
  'ensnaring-strike': { school: 'conjuration', damageTypes: ['piercing'], save: 'str' },
  'hail-of-thorns': { school: 'conjuration', damageTypes: ['piercing'], save: 'dex' },
  'compelled-duel': { school: 'enchantment', save: 'wis' },
  'divine-favor': { school: 'evocation', damageTypes: ['radiant'], save: 'none' },
  'shield-of-faith': { school: 'abjuration', save: 'none' },
  'wrathful-smite': { school: 'evocation', damageTypes: ['psychic'], save: 'wis' },
  'searing-smite': { school: 'evocation', damageTypes: ['fire'], save: 'con' },
  'thunderous-smite': { school: 'evocation', damageTypes: ['thunder'], save: 'str' },
  'magic-missile': { school: 'evocation', damageTypes: ['force'], save: 'none' },
  'shield-spell': { school: 'abjuration', save: 'none' },
  'mage-armor': { school: 'abjuration', save: 'none' },
  'sleep': { school: 'enchantment', save: 'none' },
  'burning-hands': { school: 'evocation', damageTypes: ['fire'], save: 'dex' },
  'detect-magic': { school: 'divination', save: 'none' },
  'feather-fall': { school: 'transmutation', save: 'none' },
  'grease': { school: 'conjuration', save: 'dex' },
  'identify': { school: 'divination', save: 'none' },
  'hex': { school: 'enchantment', save: 'none' },
  'armor-of-agathys': { school: 'abjuration', damageTypes: ['cold'], save: 'none' },
  'hellish-rebuke': { school: 'evocation', damageTypes: ['fire'], save: 'dex' },
  // Level 2
  'aid': { school: 'abjuration', save: 'none' },
  'spiritual-weapon': { school: 'evocation', damageTypes: ['force'], save: 'none' },
  'prayer-of-healing': { school: 'evocation', save: 'none' },
  'lesser-restoration': { school: 'abjuration', save: 'none' },
  'pass-without-trace': { school: 'abjuration', save: 'none' },
  'moonbeam': { school: 'evocation', damageTypes: ['radiant'], save: 'con' },
  'misty-step': { school: 'conjuration', save: 'none' },
  'mirror-image': { school: 'illusion', save: 'none' },
  'invisibility': { school: 'illusion', save: 'none' },
  'scorching-ray': { school: 'evocation', damageTypes: ['fire'], save: 'none' },
  'hold-person': { school: 'enchantment', save: 'wis' },
  'darkness': { school: 'evocation', save: 'none' },
  'branding-smite': { school: 'evocation', damageTypes: ['radiant'], save: 'con' },
  'magic-weapon': { school: 'transmutation', save: 'none' },
  'hail-of-thorns-2': { school: 'transmutation', damageTypes: ['piercing'], save: 'none' },
  // Level 3
  'revivify': { school: 'necromancy', save: 'none' },
  'spirit-guardians': { school: 'conjuration', damageTypes: ['radiant','necrotic'], save: 'wis' },
  'call-lightning': { school: 'conjuration', damageTypes: ['lightning'], save: 'dex' },
  'conjure-animals': { school: 'conjuration', save: 'none' },
  'blinding-smite': { school: 'evocation', damageTypes: ['radiant'], save: 'con' },
  'fireball': { school: 'evocation', damageTypes: ['fire'], save: 'dex' },
  'counterspell': { school: 'abjuration', save: 'none' },
  'dispel-magic': { school: 'abjuration', save: 'none' },
  'hypnotic-pattern': { school: 'illusion', save: 'wis' },
  'haste': { school: 'transmutation', save: 'none' },
}

export const ALL_SPELL_SCHOOLS: MagicSchool[] = Array.from(new Set(Object.values(SPELL_META).map(m => m.school).filter(Boolean))) as MagicSchool[]
export const ALL_DAMAGE_TYPES: DamageType[] = Array.from(new Set(Object.values(SPELL_META).flatMap(m => m.damageTypes || []))) as DamageType[]
export const ALL_SAVE_ABILITIES: AbilityKey[] = Array.from(new Set(Object.values(SPELL_META).map(m => m.save).filter((s): s is AbilityKey => !!s && s !== 'none')))
